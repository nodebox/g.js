(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.g = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function (process){
!function(){function n(n){var e=!1;return function(){if(e)throw new Error("Callback was already called.");e=!0,n.apply(t,arguments)}}var t,e,r={};t=this,null!=t&&(e=t.async),r.noConflict=function(){return t.async=e,r};var u=function(n,t){if(n.forEach)return n.forEach(t);for(var e=0;e<n.length;e+=1)t(n[e],e,n)},i=function(n,t){if(n.map)return n.map(t);var e=[];return u(n,function(n,r,u){e.push(t(n,r,u))}),e},c=function(n,t,e){return n.reduce?n.reduce(t,e):(u(n,function(n,r,u){e=t(e,n,r,u)}),e)},o=function(n){if(Object.keys)return Object.keys(n);var t=[];for(var e in n)n.hasOwnProperty(e)&&t.push(e);return t};"undefined"!=typeof process&&process.nextTick?(r.nextTick=process.nextTick,"undefined"!=typeof setImmediate?r.setImmediate=function(n){setImmediate(n)}:r.setImmediate=r.nextTick):"function"==typeof setImmediate?(r.nextTick=function(n){setImmediate(n)},r.setImmediate=r.nextTick):(r.nextTick=function(n){setTimeout(n,0)},r.setImmediate=r.nextTick),r.each=function(t,e,r){if(r=r||function(){},!t.length)return r();var i=0;u(t,function(u){e(u,n(function(n){n?(r(n),r=function(){}):(i+=1,i>=t.length&&r(null))}))})},r.forEach=r.each,r.eachSeries=function(n,t,e){if(e=e||function(){},!n.length)return e();var r=0,u=function(){t(n[r],function(t){t?(e(t),e=function(){}):(r+=1,r>=n.length?e(null):u())})};u()},r.forEachSeries=r.eachSeries,r.eachLimit=function(n,t,e,r){var u=a(t);u.apply(null,[n,e,r])},r.forEachLimit=r.eachLimit;var a=function(n){return function(t,e,r){if(r=r||function(){},!t.length||0>=n)return r();var u=0,i=0,c=0;!function o(){if(u>=t.length)return r();for(;n>c&&i<t.length;)i+=1,c+=1,e(t[i-1],function(n){n?(r(n),r=function(){}):(u+=1,c-=1,u>=t.length?r():o())})}()}},l=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.each].concat(t))}},f=function(n,t){return function(){var e=Array.prototype.slice.call(arguments);return t.apply(null,[a(n)].concat(e))}},s=function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(null,[r.eachSeries].concat(t))}},p=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e,r){u[n.index]=r,t(e)})},function(n){r(n,u)})};r.map=l(p),r.mapSeries=s(p),r.mapLimit=function(n,t,e,r){return m(t)(n,e,r)};var m=function(n){return f(n,p)};r.reduce=function(n,t,e,u){r.eachSeries(n,function(n,r){e(t,n,function(n,e){t=e,r(n)})},function(n){u(n,t)})},r.inject=r.reduce,r.foldl=r.reduce,r.reduceRight=function(n,t,e,u){var c=i(n,function(n){return n}).reverse();r.reduce(c,t,e,u)},r.foldr=r.reduceRight;var y=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e&&u.push(n),t()})},function(n){r(i(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.filter=l(y),r.filterSeries=s(y),r.select=r.filter,r.selectSeries=r.filterSeries;var v=function(n,t,e,r){var u=[];t=i(t,function(n,t){return{index:t,value:n}}),n(t,function(n,t){e(n.value,function(e){e||u.push(n),t()})},function(n){r(i(u.sort(function(n,t){return n.index-t.index}),function(n){return n.value}))})};r.reject=l(v),r.rejectSeries=s(v);var h=function(n,t,e,r){n(t,function(n,t){e(n,function(e){e?(r(n),r=function(){}):t()})},function(n){r()})};r.detect=l(h),r.detectSeries=s(h),r.some=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n&&(e(!0),e=function(){}),r()})},function(n){e(!1)})},r.any=r.some,r.every=function(n,t,e){r.each(n,function(n,r){t(n,function(n){n||(e(!1),e=function(){}),r()})},function(n){e(!0)})},r.all=r.every,r.sortBy=function(n,t,e){r.map(n,function(n,e){t(n,function(t,r){t?e(t):e(null,{value:n,criteria:r})})},function(n,t){if(n)return e(n);var r=function(n,t){var e=n.criteria,r=t.criteria;return r>e?-1:e>r?1:0};e(null,i(t.sort(r),function(n){return n.value}))})},r.auto=function(n,t){t=t||function(){};var e=o(n);if(!e.length)return t(null);var i={},a=[],l=function(n){a.unshift(n)},f=function(n){for(var t=0;t<a.length;t+=1)if(a[t]===n)return void a.splice(t,1)},s=function(){u(a.slice(0),function(n){n()})};l(function(){o(i).length===e.length&&(t(null,i),t=function(){})}),u(e,function(e){var a=n[e]instanceof Function?[n[e]]:n[e],p=function(n){var c=Array.prototype.slice.call(arguments,1);if(c.length<=1&&(c=c[0]),n){var a={};u(o(i),function(n){a[n]=i[n]}),a[e]=c,t(n,a),t=function(){}}else i[e]=c,r.setImmediate(s)},m=a.slice(0,Math.abs(a.length-1))||[],y=function(){return c(m,function(n,t){return n&&i.hasOwnProperty(t)},!0)&&!i.hasOwnProperty(e)};if(y())a[a.length-1](p,i);else{var v=function(){y()&&(f(v),a[a.length-1](p,i))};l(v)}})},r.waterfall=function(n,t){if(t=t||function(){},n.constructor!==Array){var e=new Error("First argument to waterfall must be an array of functions");return t(e)}if(!n.length)return t();var u=function(n){return function(e){if(e)t.apply(null,arguments),t=function(){};else{var i=Array.prototype.slice.call(arguments,1),c=n.next();c?i.push(u(c)):i.push(t),r.setImmediate(function(){n.apply(null,i)})}}};u(r.iterator(n))()};var d=function(n,t,e){if(e=e||function(){},t.constructor===Array)n.map(t,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},e);else{var r={};n.each(o(t),function(n,e){t[n](function(t){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),r[n]=u,e(t)})},function(n){e(n,r)})}};r.parallel=function(n,t){d({map:r.map,each:r.each},n,t)},r.parallelLimit=function(n,t,e){d({map:m(t),each:a(t)},n,e)},r.series=function(n,t){if(t=t||function(){},n.constructor===Array)r.mapSeries(n,function(n,t){n&&n(function(n){var e=Array.prototype.slice.call(arguments,1);e.length<=1&&(e=e[0]),t.call(null,n,e)})},t);else{var e={};r.eachSeries(o(n),function(t,r){n[t](function(n){var u=Array.prototype.slice.call(arguments,1);u.length<=1&&(u=u[0]),e[t]=u,r(n)})},function(n){t(n,e)})}},r.iterator=function(n){var t=function(e){var r=function(){return n.length&&n[e].apply(null,arguments),r.next()};return r.next=function(){return e<n.length-1?t(e+1):null},r};return t(0)},r.apply=function(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t.concat(Array.prototype.slice.call(arguments)))}};var g=function(n,t,e,r){var u=[];n(t,function(n,t){e(n,function(n,e){u=u.concat(e||[]),t(n)})},function(n){r(n,u)})};r.concat=l(g),r.concatSeries=s(g),r.whilst=function(n,t,e){n()?t(function(u){return u?e(u):void r.whilst(n,t,e)}):e()},r.doWhilst=function(n,t,e){n(function(u){return u?e(u):void(t()?r.doWhilst(n,t,e):e())})},r.until=function(n,t,e){n()?e():t(function(u){return u?e(u):void r.until(n,t,e)})},r.doUntil=function(n,t,e){n(function(u){return u?e(u):void(t()?e():r.doUntil(n,t,e))})},r.queue=function(t,e){function i(n,t,i,c){t.constructor!==Array&&(t=[t]),u(t,function(t){var u={data:t,callback:"function"==typeof c?c:null};i?n.tasks.unshift(u):n.tasks.push(u),n.saturated&&n.tasks.length===e&&n.saturated(),r.setImmediate(n.process)})}void 0===e&&(e=1);var c=0,o={tasks:[],concurrency:e,saturated:null,empty:null,drain:null,push:function(n,t){i(o,n,!1,t)},unshift:function(n,t){i(o,n,!0,t)},process:function(){if(c<o.concurrency&&o.tasks.length){var e=o.tasks.shift();o.empty&&0===o.tasks.length&&o.empty(),c+=1;var r=function(){c-=1,e.callback&&e.callback.apply(e,arguments),o.drain&&o.tasks.length+c===0&&o.drain(),o.process()},u=n(r);t(e.data,u)}},length:function(){return o.tasks.length},running:function(){return c}};return o},r.cargo=function(n,t){var e=!1,c=[],o={tasks:c,payload:t,saturated:null,empty:null,drain:null,push:function(n,e){n.constructor!==Array&&(n=[n]),u(n,function(n){c.push({data:n,callback:"function"==typeof e?e:null}),o.saturated&&c.length===t&&o.saturated()}),r.setImmediate(o.process)},process:function a(){if(!e){if(0===c.length)return void(o.drain&&o.drain());var r="number"==typeof t?c.splice(0,t):c.splice(0),l=i(r,function(n){return n.data});o.empty&&o.empty(),e=!0,n(l,function(){e=!1;var n=arguments;u(r,function(t){t.callback&&t.callback.apply(null,n)}),a()})}},length:function(){return c.length},running:function(){return e}};return o};var k=function(n){return function(t){var e=Array.prototype.slice.call(arguments,1);t.apply(null,e.concat([function(t){var e=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(t?console.error&&console.error(t):console[n]&&u(e,function(t){console[n](t)}))}]))}};r.log=k("log"),r.dir=k("dir"),r.memoize=function(n,t){var e={},r={};t=t||function(n){return n};var u=function(){var u=Array.prototype.slice.call(arguments),i=u.pop(),c=t.apply(null,u);c in e?i.apply(null,e[c]):c in r?r[c].push(i):(r[c]=[i],n.apply(null,u.concat([function(){e[c]=arguments;var n=r[c];delete r[c];for(var t=0,u=n.length;u>t;t++)n[t].apply(null,arguments)}])))};return u.memo=e,u.unmemoized=n,u},r.unmemoize=function(n){return function(){return(n.unmemoized||n).apply(null,arguments)}},r.times=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.map(u,t,e)},r.timesSeries=function(n,t,e){for(var u=[],i=0;n>i;i++)u.push(i);return r.mapSeries(u,t,e)},r.compose=function(){var n=Array.prototype.reverse.call(arguments);return function(){var t=this,e=Array.prototype.slice.call(arguments),u=e.pop();r.reduce(n,e,function(n,e,r){e.apply(t,n.concat([function(){var n=arguments[0],t=Array.prototype.slice.call(arguments,1);r(n,t)}]))},function(n,e){u.apply(t,[n].concat(e))})}};var A=function(n,t){var e=function(){var e=this,r=Array.prototype.slice.call(arguments),u=r.pop();return n(t,function(n,t){n.apply(e,r.concat([t]))},u)};if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return e.apply(this,r)}return e};r.applyEach=l(A),r.applyEachSeries=s(A),r.forever=function(n,t){function e(r){if(r){if(t)return t(r);throw r}n(e)}e()},"undefined"!=typeof define&&define.amd?define([],function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:t.async=r}();


}).call(this,require('_process'))
},{"_process":2}],2:[function(require,module,exports){
function drainQueue(){if(!draining){draining=!0;for(var e,o=queue.length;o;){e=queue,queue=[];for(var r=-1;++r<o;)e[r]();o=queue.length}draining=!1}}function noop(){}var process=module.exports={},queue=[],draining=!1;process.nextTick=function(e){queue.push(e),draining||setTimeout(drainQueue,0)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(e){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(e){throw new Error("process.chdir is not supported")},process.umask=function(){return 0};


},{}],3:[function(require,module,exports){
"use strict";function BigInteger(t,e,i){ClipperLib.biginteger_used=1,null!=t&&("number"==typeof t&&"undefined"==typeof e?this.fromInt(t):"number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function nbi(){return new BigInteger(null)}function am1(t,e,i,r,n,p){for(;--p>=0;){var o=e*this[t++]+i[r]+n;n=Math.floor(o/67108864),i[r++]=67108863&o}return n}function am2(t,e,i,r,n,p){for(var o=32767&e,l=e>>15;--p>=0;){var s=32767&this[t],u=this[t++]>>15,h=l*s+u*o;s=o*s+((32767&h)<<15)+i[r]+(1073741823&n),n=(s>>>30)+(h>>>15)+l*u+(n>>>30),i[r++]=1073741823&s}return n}function am3(t,e,i,r,n,p){for(var o=16383&e,l=e>>14;--p>=0;){var s=16383&this[t],u=this[t++]>>14,h=l*s+u*o;s=o*s+((16383&h)<<14)+i[r]+n,n=(s>>28)+(h>>14)+l*u,i[r++]=268435455&s}return n}function int2char(t){return BI_RM.charAt(t)}function intAt(t,e){var i=BI_RC[t.charCodeAt(e)];return null==i?-1:i}function bnpCopyTo(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function nbv(t){var e=nbi();return e.fromInt(t),e}function bnpFromString(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var r=t.length,n=!1,p=0;--r>=0;){var o=8==i?255&t[r]:intAt(t,r);0>o?"-"==t.charAt(r)&&(n=!0):(n=!1,0==p?this[this.t++]=o:p+i>this.DB?(this[this.t-1]|=(o&(1<<this.DB-p)-1)<<p,this[this.t++]=o>>this.DB-p):this[this.t-1]|=o<<p,p+=i,p>=this.DB&&(p-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,p>0&&(this[this.t-1]|=(1<<this.DB-p)-1<<p)),this.clamp(),n&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,r=(1<<e)-1,n=!1,p="",o=this.t,l=this.DB-o*this.DB%e;if(o-- >0)for(l<this.DB&&(i=this[o]>>l)>0&&(n=!0,p=int2char(i));o>=0;)e>l?(i=(this[o]&(1<<l)-1)<<e-l,i|=this[--o]>>(l+=this.DB-e)):(i=this[o]>>(l-=e)&r,0>=l&&(l+=this.DB,--o)),i>0&&(n=!0),n&&(p+=int2char(i));return n?p:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(e=i-t.t,0!=e)return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0}function nbits(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s}function bnpDRShiftTo(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s}function bnpLShiftTo(t,e){var i,r=t%this.DB,n=this.DB-r,p=(1<<n)-1,o=Math.floor(t/this.DB),l=this.s<<r&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>n|l,l=(this[i]&p)<<r;for(i=o-1;i>=0;--i)e[i]=0;e[o]=l,e.t=this.t+o+1,e.s=this.s,e.clamp()}function bnpRShiftTo(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)return void(e.t=0);var r=t%this.DB,n=this.DB-r,p=(1<<r)-1;e[0]=this[i]>>r;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&p)<<n,e[o-i]=this[o]>>r;r>0&&(e[this.t-i-1]|=(this.s&p)<<n),e.t=this.t-i,e.clamp()}function bnpSubTo(t,e){for(var i=0,r=0,n=Math.min(t.t,this.t);n>i;)r+=this[i]-t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r-=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r-=t[i],e[i++]=r&this.DM,r>>=this.DB;r-=t.s}e.s=0>r?-1:0,-1>r?e[i++]=this.DV+r:r>0&&(e[i++]=r),e.t=i,e.clamp()}function bnpMultiplyTo(t,e){var i=this.abs(),r=t.abs(),n=i.t;for(e.t=n+r.t;--n>=0;)e[n]=0;for(n=0;n<r.t;++n)e[n+i.t]=i.am(0,r[n],e,n,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(e,e)}function bnpSquareTo(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var r=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,r,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,e,i){var r=t.abs();if(!(r.t<=0)){var n=this.abs();if(n.t<r.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=nbi());var p=nbi(),o=this.s,l=t.s,s=this.DB-nbits(r[r.t-1]);s>0?(r.lShiftTo(s,p),n.lShiftTo(s,i)):(r.copyTo(p),n.copyTo(i));var u=p.t,h=p[u-1];if(0!=h){var a=h*(1<<this.F1)+(u>1?p[u-2]>>this.F2:0),C=this.FV/a,f=(1<<this.F1)/a,d=1<<this.F2,L=i.t,P=L-u,b=null==e?nbi():e;for(p.dlShiftTo(P,b),i.compareTo(b)>=0&&(i[i.t++]=1,i.subTo(b,i)),BigInteger.ONE.dlShiftTo(u,b),b.subTo(p,p);p.t<u;)p[p.t++]=0;for(;--P>=0;){var m=i[--L]==h?this.DM:Math.floor(i[L]*C+(i[L-1]+d)*f);if((i[L]+=p.am(0,m,i,P,0,u))<m)for(p.dlShiftTo(P,b),i.subTo(b,i);i[L]<--m;)i.subTo(b,i)}null!=e&&(i.drShiftTo(u,e),o!=l&&BigInteger.ZERO.subTo(e,e)),i.t=u,i.clamp(),s>0&&i.rShiftTo(s,i),0>o&&BigInteger.ZERO.subTo(i,i)}}}function bnMod(t){var e=nbi();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(BigInteger.ZERO)>0&&t.subTo(e,e),e}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function cSqrTo(t,e){t.squareTo(e),this.reduce(e)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return e=e*(2-(15&t)*e)&15,e=e*(2-(255&t)*e)&255,e=e*(2-((65535&t)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var e=nbi();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(BigInteger.ZERO)>0&&this.m.subTo(e,e),e}function montRevert(t){var e=nbi();return t.copyTo(e),this.reduce(e),e}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],r=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(i=e+this.m.t,t[i]+=this.m.am(0,r,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,e){t.squareTo(e),this.reduce(e)}function montMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,e){if(t>4294967295||1>t)return BigInteger.ONE;var i=nbi(),r=nbi(),n=e.convert(this),p=nbits(t)-1;for(n.copyTo(i);--p>=0;)if(e.sqrTo(i,r),(t&1<<p)>0)e.mulTo(r,n,i);else{var o=i;i=r,r=o}return e.revert(i)}function bnModPowInt(t,e){var i;return i=256>t||e.isEven()?new Classic(e):new Montgomery(e),this.exp(t,i)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),r=nbv(i),n=nbi(),p=nbi(),o="";for(this.divRemTo(r,n,p);n.signum()>0;)o=(i+p.intValue()).toString(t).substr(1)+o,n.divRemTo(r,n,p);return p.intValue().toString(t)+o}function bnpFromRadix(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),r=Math.pow(e,i),n=!1,p=0,o=0,l=0;l<t.length;++l){var s=intAt(t,l);0>s?"-"==t.charAt(l)&&0==this.signum()&&(n=!0):(o=e*o+s,++p>=i&&(this.dMultiply(r),this.dAddOffset(o,0),p=0,o=0))}p>0&&(this.dMultiply(Math.pow(e,p)),this.dAddOffset(o,0)),n&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,e,i){if("number"==typeof e)if(2>t)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var r=new Array,n=7&t;r.length=(t>>3)+1,e.nextBytes(r),n>0?r[0]&=(1<<n)-1:r[0]=0,this.fromString(r,256)}}function bnToByteArray(){var t=this.t,e=new Array;e[0]=this.s;var i,r=this.DB-t*this.DB%8,n=0;if(t-- >0)for(r<this.DB&&(i=this[t]>>r)!=(this.s&this.DM)>>r&&(e[n++]=i|this.s<<this.DB-r);t>=0;)8>r?(i=(this[t]&(1<<r)-1)<<8-r,i|=this[--t]>>(r+=this.DB-8)):(i=this[t]>>(r-=8)&255,0>=r&&(r+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==n&&(128&this.s)!=(128&i)&&++n,(n>0||i!=this.s)&&(e[n++]=i);return e}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,e,i){var r,n,p=Math.min(t.t,this.t);for(r=0;p>r;++r)i[r]=e(this[r],t[r]);if(t.t<this.t){for(n=t.s&this.DM,r=p;r<this.t;++r)i[r]=e(this[r],n);i.t=this.t}else{for(n=this.s&this.DM,r=p;r<t.t;++r)i[r]=e(n,t[r]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()}function op_and(t,e){return t&e}function bnAnd(t){var e=nbi();return this.bitwiseTo(t,op_and,e),e}function op_or(t,e){return t|e}function bnOr(t){var e=nbi();return this.bitwiseTo(t,op_or,e),e}function op_xor(t,e){return t^e}function bnXor(t){var e=nbi();return this.bitwiseTo(t,op_xor,e),e}function op_andnot(t,e){return t&~e}function bnAndNot(t){var e=nbi();return this.bitwiseTo(t,op_andnot,e),e}function bnNot(){for(var t=nbi(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var e=nbi();return 0>t?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function bnShiftRight(t){var e=nbi();return 0>t?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function lbit(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function bnBitCount(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=cbit(this[i]^e);return t}function bnTestBit(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)}function bnpChangeBit(t,e){var i=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,e){for(var i=0,r=0,n=Math.min(t.t,this.t);n>i;)r+=this[i]+t[i],e[i++]=r&this.DM,r>>=this.DB;if(t.t<this.t){for(r+=t.s;i<this.t;)r+=this[i],e[i++]=r&this.DM,r>>=this.DB;r+=this.s}else{for(r+=this.s;i<t.t;)r+=t[i],e[i++]=r&this.DM,r>>=this.DB;r+=t.s}e.s=0>r?-1:0,r>0?e[i++]=r:-1>r&&(e[i++]=this.DV+r),e.t=i,e.clamp()}function bnAdd(t){var e=nbi();return this.addTo(t,e),e}function bnSubtract(t){var e=nbi();return this.subTo(t,e),e}function bnMultiply(t){var e=nbi();return this.multiplyTo(t,e),e}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var e=nbi();return this.divRemTo(t,e,null),e}function bnRemainder(t){var e=nbi();return this.divRemTo(t,null,e),e}function bnDivideAndRemainder(t){var e=nbi(),i=nbi();return this.divRemTo(t,e,i),new Array(e,i)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,e,i){t.multiplyTo(e,i)}function nSqrTo(t,e){t.squareTo(e)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,e,i){var r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;var n;for(n=i.t-this.t;n>r;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(n=Math.min(t.t,e);n>r;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()}function bnpMultiplyUpperTo(t,e,i){--e;var r=i.t=this.t+t.t-e;for(i.s=0;--r>=0;)i[r]=0;for(r=Math.max(e-this.t,0);r<t.t;++r)i[this.t+r-e]=this.am(e-r,t[r],i,0,0,this.t+r-e);i.clamp(),i.drShiftTo(1,i)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=nbi();return t.copyTo(e),this.reduce(e),e}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,e){t.squareTo(e),this.reduce(e)}function barrettMulTo(t,e,i){t.multiplyTo(e,i),this.reduce(i)}function bnModPow(t,e){var i,r,n=t.bitLength(),p=nbv(1);if(0>=n)return p;i=18>n?1:48>n?3:144>n?4:768>n?5:6,r=8>n?new Classic(e):e.isEven()?new Barrett(e):new Montgomery(e);var o=new Array,l=3,s=i-1,u=(1<<i)-1;if(o[1]=r.convert(this),i>1){var h=nbi();for(r.sqrTo(o[1],h);u>=l;)o[l]=nbi(),r.mulTo(h,o[l-2],o[l]),l+=2}var a,C,f=t.t-1,d=!0,L=nbi();for(n=nbits(t[f])-1;f>=0;){for(n>=s?a=t[f]>>n-s&u:(a=(t[f]&(1<<n+1)-1)<<s-n,f>0&&(a|=t[f-1]>>this.DB+n-s)),l=i;0==(1&a);)a>>=1,--l;if((n-=l)<0&&(n+=this.DB,--f),d)o[a].copyTo(p),d=!1;else{for(;l>1;)r.sqrTo(p,L),r.sqrTo(L,p),l-=2;l>0?r.sqrTo(p,L):(C=p,p=L,L=C),r.mulTo(L,o[a],p)}for(;f>=0&&0==(t[f]&1<<n);)r.sqrTo(p,L),C=p,p=L,L=C,--n<0&&(n=this.DB-1,--f)}return r.revert(p)}function bnGCD(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var r=e;e=i,i=r}var n=e.getLowestSetBit(),p=i.getLowestSetBit();if(0>p)return e;for(p>n&&(p=n),p>0&&(e.rShiftTo(p,e),i.rShiftTo(p,i));e.signum()>0;)(n=e.getLowestSetBit())>0&&e.rShiftTo(n,e),(n=i.getLowestSetBit())>0&&i.rShiftTo(n,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return p>0&&i.lShiftTo(p,i),i}function bnpModInt(t){if(0>=t)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var r=this.t-1;r>=0;--r)i=(e*i+this[r])%t;return i}function bnModInverse(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return BigInteger.ZERO;for(var i=t.clone(),r=this.clone(),n=nbv(1),p=nbv(0),o=nbv(0),l=nbv(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(n.isEven()&&p.isEven()||(n.addTo(this,n),p.subTo(t,p)),n.rShiftTo(1,n)):p.isEven()||p.subTo(t,p),p.rShiftTo(1,p);for(;r.isEven();)r.rShiftTo(1,r),e?(o.isEven()&&l.isEven()||(o.addTo(this,o),l.subTo(t,l)),o.rShiftTo(1,o)):l.isEven()||l.subTo(t,l),l.rShiftTo(1,l);i.compareTo(r)>=0?(i.subTo(r,i),e&&n.subTo(o,n),p.subTo(l,p)):(r.subTo(i,r),e&&o.subTo(n,o),l.subTo(p,l))}return 0!=r.compareTo(BigInteger.ONE)?BigInteger.ZERO:l.compareTo(t)>=0?l.subtract(t):l.signum()<0?(l.addTo(t,l),l.signum()<0?l.add(t):l):l}function bnIsProbablePrime(t){var e,i=this.abs();if(1==i.t&&i[0]<=lowprimes[lowprimes.length-1]){for(e=0;e<lowprimes.length;++e)if(i[0]==lowprimes[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<lowprimes.length;){for(var r=lowprimes[e],n=e+1;n<lowprimes.length&&lplim>r;)r*=lowprimes[n++];for(r=i.modInt(r);n>e;)if(r%lowprimes[e++]==0)return!1}return i.millerRabin(t)}function bnpMillerRabin(t){var e=this.subtract(BigInteger.ONE),i=e.getLowestSetBit();if(0>=i)return!1;var r=e.shiftRight(i);t=t+1>>1,t>lowprimes.length&&(t=lowprimes.length);for(var n=nbi(),p=0;t>p;++p){n.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var o=n.modPow(r,this);if(0!=o.compareTo(BigInteger.ONE)&&0!=o.compareTo(e)){for(var l=1;l++<i&&0!=o.compareTo(e);)if(o=o.modPowInt(2,this),0==o.compareTo(BigInteger.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0}var use_int32=!1,use_xyz=!1,use_lines=!0,use_deprecated=!1,ClipperLib={},isNode=!1;"undefined"!=typeof module&&module.exports?(module.exports=ClipperLib,isNode=!0):"undefined"!=typeof document?window.ClipperLib=ClipperLib:self.ClipperLib=ClipperLib;var navigator_appName;if(isNode){var nav="chrome";navigator_appName="Netscape"}else{var nav=navigator.userAgent.toString().toLowerCase();navigator_appName=navigator.appName}var browser={};-1!=nav.indexOf("chrome")&&-1==nav.indexOf("chromium")?browser.chrome=1:browser.chrome=0,-1!=nav.indexOf("chromium")?browser.chromium=1:browser.chromium=0,-1!=nav.indexOf("safari")&&-1==nav.indexOf("chrome")&&-1==nav.indexOf("chromium")?browser.safari=1:browser.safari=0,-1!=nav.indexOf("firefox")?browser.firefox=1:browser.firefox=0,-1!=nav.indexOf("firefox/17")?browser.firefox17=1:browser.firefox17=0,-1!=nav.indexOf("firefox/15")?browser.firefox15=1:browser.firefox15=0,-1!=nav.indexOf("firefox/3")?browser.firefox3=1:browser.firefox3=0,-1!=nav.indexOf("opera")?browser.opera=1:browser.opera=0,-1!=nav.indexOf("msie 10")?browser.msie10=1:browser.msie10=0,-1!=nav.indexOf("msie 9")?browser.msie9=1:browser.msie9=0,-1!=nav.indexOf("msie 8")?browser.msie8=1:browser.msie8=0,-1!=nav.indexOf("msie 7")?browser.msie7=1:browser.msie7=0,-1!=nav.indexOf("msie ")?browser.msie=1:browser.msie=0,ClipperLib.biginteger_used=null;var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator_appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator_appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare;var Int128=BigInteger;if(Int128.prototype.IsNegative=function(){return-1==this.compareTo(Int128.ZERO)?!0:!1},Int128.op_Equality=function(t,e){return 0==t.compareTo(e)?!0:!1},Int128.op_Inequality=function(t,e){return 0!=t.compareTo(e)?!0:!1},Int128.op_GreaterThan=function(t,e){return t.compareTo(e)>0?!0:!1},Int128.op_LessThan=function(t,e){return t.compareTo(e)<0?!0:!1},Int128.op_Addition=function(t,e){return new Int128(t).add(new Int128(e))},Int128.op_Subtraction=function(t,e){return new Int128(t).subtract(new Int128(e))},Int128.Int128Mul=function(t,e){return new Int128(t).multiply(new Int128(e))},Int128.op_Division=function(t,e){return t.divide(e)},Int128.prototype.ToDouble=function(){return parseFloat(this.toString())},"undefined"==typeof Inherit)var Inherit=function(t,e){var i;if("undefined"==typeof Object.getOwnPropertyNames){for(i in e.prototype)("undefined"==typeof t.prototype[i]||t.prototype[i]==Object.prototype[i])&&(t.prototype[i]=e.prototype[i]);for(i in e)"undefined"==typeof t[i]&&(t[i]=e[i]);t.$baseCtor=e}else{for(var r=Object.getOwnPropertyNames(e.prototype),n=0;n<r.length;n++)"undefined"==typeof Object.getOwnPropertyDescriptor(t.prototype,r[n])&&Object.defineProperty(t.prototype,r[n],Object.getOwnPropertyDescriptor(e.prototype,r[n]));for(i in e)"undefined"==typeof t[i]&&(t[i]=e[i]);t.$baseCtor=e}};ClipperLib.Path=function(){return[]},ClipperLib.Paths=function(){return[]},ClipperLib.DoublePoint=function(){var t=arguments;this.X=0,this.Y=0,1==t.length?(this.X=t[0].X,this.Y=t[0].Y):2==t.length&&(this.X=t[0],this.Y=t[1])},ClipperLib.DoublePoint0=function(){this.X=0,this.Y=0},ClipperLib.DoublePoint1=function(t){this.X=t.X,this.Y=t.Y},ClipperLib.DoublePoint2=function(t,e){this.X=t,this.Y=e},ClipperLib.PolyNode=function(){this.m_Parent=null,this.m_polygon=new ClipperLib.Path,this.m_Index=0,this.m_jointype=0,this.m_endtype=0,this.m_Childs=[],this.IsOpen=!1},ClipperLib.PolyNode.prototype.IsHoleNode=function(){for(var t=!0,e=this.m_Parent;null!==e;)t=!t,e=e.m_Parent;return t},ClipperLib.PolyNode.prototype.ChildCount=function(){return this.m_Childs.length},ClipperLib.PolyNode.prototype.Contour=function(){return this.m_polygon},ClipperLib.PolyNode.prototype.AddChild=function(t){var e=this.m_Childs.length;this.m_Childs.push(t),t.m_Parent=this,t.m_Index=e},ClipperLib.PolyNode.prototype.GetNext=function(){return this.m_Childs.length>0?this.m_Childs[0]:this.GetNextSiblingUp()},ClipperLib.PolyNode.prototype.GetNextSiblingUp=function(){return null===this.m_Parent?null:this.m_Index==this.m_Parent.m_Childs.length-1?this.m_Parent.GetNextSiblingUp():this.m_Parent.m_Childs[this.m_Index+1]},ClipperLib.PolyNode.prototype.Childs=function(){return this.m_Childs},ClipperLib.PolyNode.prototype.Parent=function(){return this.m_Parent},ClipperLib.PolyNode.prototype.IsHole=function(){return this.IsHoleNode()},ClipperLib.PolyTree=function(){this.m_AllPolys=[],ClipperLib.PolyNode.call(this)},ClipperLib.PolyTree.prototype.Clear=function(){for(var t=0,e=this.m_AllPolys.length;e>t;t++)this.m_AllPolys[t]=null;this.m_AllPolys.length=0,this.m_Childs.length=0},ClipperLib.PolyTree.prototype.GetFirst=function(){return this.m_Childs.length>0?this.m_Childs[0]:null},ClipperLib.PolyTree.prototype.Total=function(){return this.m_AllPolys.length},Inherit(ClipperLib.PolyTree,ClipperLib.PolyNode),ClipperLib.Math_Abs_Int64=ClipperLib.Math_Abs_Int32=ClipperLib.Math_Abs_Double=function(t){return Math.abs(t)},ClipperLib.Math_Max_Int32_Int32=function(t,e){return Math.max(t,e)},browser.msie||browser.opera||browser.safari?ClipperLib.Cast_Int32=function(t){return 0|t}:ClipperLib.Cast_Int32=function(t){return~~t},browser.chrome?ClipperLib.Cast_Int64=function(t){return-2147483648>t||t>2147483647?0>t?Math.ceil(t):Math.floor(t):~~t}:browser.firefox&&"function"==typeof Number.toInteger?ClipperLib.Cast_Int64=function(t){return Number.toInteger(t)}:browser.msie7||browser.msie8?ClipperLib.Cast_Int64=function(t){return parseInt(t,10)}:browser.msie?ClipperLib.Cast_Int64=function(t){return-2147483648>t||t>2147483647?0>t?Math.ceil(t):Math.floor(t):0|t}:ClipperLib.Cast_Int64=function(t){return 0>t?Math.ceil(t):Math.floor(t)},ClipperLib.Clear=function(t){t.length=0},ClipperLib.PI=3.141592653589793,ClipperLib.PI2=6.283185307179586,ClipperLib.IntPoint=function(){var t=arguments,e=t.length;if(this.X=0,this.Y=0,use_xyz)if(this.Z=0,3==e)this.X=t[0],this.Y=t[1],this.Z=t[2];else if(2==e)this.X=t[0],this.Y=t[1],this.Z=0;else if(1==e)if(t[0]instanceof ClipperLib.DoublePoint){var i=t[0];this.X=ClipperLib.Clipper.Round(i.X),this.Y=ClipperLib.Clipper.Round(i.Y),this.Z=0}else{var r=t[0];"undefined"==typeof r.Z&&(r.Z=0),this.X=r.X,this.Y=r.Y,this.Z=r.Z}else this.X=0,this.Y=0,this.Z=0;else if(2==e)this.X=t[0],this.Y=t[1];else if(1==e)if(t[0]instanceof ClipperLib.DoublePoint){var i=t[0];this.X=ClipperLib.Clipper.Round(i.X),this.Y=ClipperLib.Clipper.Round(i.Y)}else{var r=t[0];this.X=r.X,this.Y=r.Y}else this.X=0,this.Y=0},ClipperLib.IntPoint.op_Equality=function(t,e){return t.X==e.X&&t.Y==e.Y},ClipperLib.IntPoint.op_Inequality=function(t,e){return t.X!=e.X||t.Y!=e.Y},use_xyz?(ClipperLib.IntPoint0=function(){this.X=0,this.Y=0,this.Z=0},ClipperLib.IntPoint1=function(t){this.X=t.X,this.Y=t.Y,this.Z=t.Z},ClipperLib.IntPoint1dp=function(t){this.X=ClipperLib.Clipper.Round(t.X),this.Y=ClipperLib.Clipper.Round(t.Y),this.Z=0},ClipperLib.IntPoint2=function(t,e){this.X=t,this.Y=e,this.Z=0},ClipperLib.IntPoint3=function(t,e,i){this.X=t,this.Y=e,this.Z=i}):(ClipperLib.IntPoint0=function(){this.X=0,this.Y=0},ClipperLib.IntPoint1=function(t){this.X=t.X,this.Y=t.Y},ClipperLib.IntPoint1dp=function(t){this.X=ClipperLib.Clipper.Round(t.X),this.Y=ClipperLib.Clipper.Round(t.Y)},ClipperLib.IntPoint2=function(t,e){this.X=t,this.Y=e}),ClipperLib.IntRect=function(){var t=arguments,e=t.length;4==e?(this.left=t[0],this.top=t[1],this.right=t[2],this.bottom=t[3]):1==e?(this.left=ir.left,this.top=ir.top,this.right=ir.right,this.bottom=ir.bottom):(this.left=0,this.top=0,this.right=0,this.bottom=0)},ClipperLib.IntRect0=function(){this.left=0,this.top=0,this.right=0,this.bottom=0},ClipperLib.IntRect1=function(t){this.left=t.left,this.top=t.top,this.right=t.right,this.bottom=t.bottom},ClipperLib.IntRect4=function(t,e,i,r){this.left=t,this.top=e,this.right=i,this.bottom=r},ClipperLib.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},ClipperLib.PolyType={ptSubject:0,ptClip:1},ClipperLib.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},ClipperLib.JoinType={jtSquare:0,jtRound:1,jtMiter:2},ClipperLib.EndType={etOpenSquare:0,etOpenRound:1,etOpenButt:2,etClosedLine:3,etClosedPolygon:4},use_deprecated&&(ClipperLib.EndType_={etSquare:0,etRound:1,etButt:2,etClosed:3}),ClipperLib.EdgeSide={esLeft:0,esRight:1},ClipperLib.Direction={dRightToLeft:0,dLeftToRight:1},ClipperLib.TEdge=function(){this.Bot=new ClipperLib.IntPoint,this.Curr=new ClipperLib.IntPoint,this.Top=new ClipperLib.IntPoint,this.Delta=new ClipperLib.IntPoint,this.Dx=0,this.PolyTyp=ClipperLib.PolyType.ptSubject,this.Side=ClipperLib.EdgeSide.esLeft,this.WindDelta=0,this.WindCnt=0,this.WindCnt2=0,this.OutIdx=0,this.Next=null,this.Prev=null,this.NextInLML=null,this.NextInAEL=null,this.PrevInAEL=null,this.NextInSEL=null,this.PrevInSEL=null},ClipperLib.IntersectNode=function(){this.Edge1=null,this.Edge2=null,this.Pt=new ClipperLib.IntPoint},ClipperLib.MyIntersectNodeSort=function(){},ClipperLib.MyIntersectNodeSort.Compare=function(t,e){return e.Pt.Y-t.Pt.Y},ClipperLib.LocalMinima=function(){this.Y=0,this.LeftBound=null,this.RightBound=null,this.Next=null},ClipperLib.Scanbeam=function(){this.Y=0,this.Next=null},ClipperLib.OutRec=function(){this.Idx=0,this.IsHole=!1,this.IsOpen=!1,this.FirstLeft=null,this.Pts=null,this.BottomPt=null,this.PolyNode=null},ClipperLib.OutPt=function(){this.Idx=0,this.Pt=new ClipperLib.IntPoint,this.Next=null,this.Prev=null},ClipperLib.Join=function(){this.OutPt1=null,this.OutPt2=null,this.OffPt=new ClipperLib.IntPoint},ClipperLib.ClipperBase=function(){this.m_MinimaList=null,this.m_CurrentLM=null,this.m_edges=new Array,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1,this.PreserveCollinear=!1,this.m_MinimaList=null,this.m_CurrentLM=null,this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},ClipperLib.ClipperBase.horizontal=-9007199254740992,ClipperLib.ClipperBase.Skip=-2,ClipperLib.ClipperBase.Unassigned=-1,ClipperLib.ClipperBase.tolerance=1e-20,use_int32?(ClipperLib.ClipperBase.loRange=46340,ClipperLib.ClipperBase.hiRange=46340):(ClipperLib.ClipperBase.loRange=47453132,ClipperLib.ClipperBase.hiRange=0xfffffffffffff),ClipperLib.ClipperBase.near_zero=function(t){return t>-ClipperLib.ClipperBase.tolerance&&t<ClipperLib.ClipperBase.tolerance},ClipperLib.ClipperBase.IsHorizontal=function(t){return 0===t.Delta.Y},ClipperLib.ClipperBase.prototype.PointIsVertex=function(t,e){var i=e;do{if(ClipperLib.IntPoint.op_Equality(i.Pt,t))return!0;i=i.Next}while(i!=e);return!1},ClipperLib.ClipperBase.prototype.PointOnLineSegment=function(t,e,i,r){return r?t.X==e.X&&t.Y==e.Y||t.X==i.X&&t.Y==i.Y||t.X>e.X==t.X<i.X&&t.Y>e.Y==t.Y<i.Y&&Int128.op_Equality(Int128.Int128Mul(t.X-e.X,i.Y-e.Y),Int128.Int128Mul(i.X-e.X,t.Y-e.Y)):t.X==e.X&&t.Y==e.Y||t.X==i.X&&t.Y==i.Y||t.X>e.X==t.X<i.X&&t.Y>e.Y==t.Y<i.Y&&(t.X-e.X)*(i.Y-e.Y)==(i.X-e.X)*(t.Y-e.Y)},ClipperLib.ClipperBase.prototype.PointOnPolygon=function(t,e,i){for(var r=e;;){if(this.PointOnLineSegment(t,r.Pt,r.Next.Pt,i))return!0;if(r=r.Next,
r==e)break}return!1},ClipperLib.ClipperBase.prototype.SlopesEqual=ClipperLib.ClipperBase.SlopesEqual=function(){var t,e,i,r,n,p,o,l=arguments,s=l.length;return 3==s?(t=l[0],e=l[1],o=l[2],o?Int128.op_Equality(Int128.Int128Mul(t.Delta.Y,e.Delta.X),Int128.Int128Mul(t.Delta.X,e.Delta.Y)):ClipperLib.Cast_Int64(t.Delta.Y*e.Delta.X)==ClipperLib.Cast_Int64(t.Delta.X*e.Delta.Y)):4==s?(i=l[0],r=l[1],n=l[2],o=l[3],o?Int128.op_Equality(Int128.Int128Mul(i.Y-r.Y,r.X-n.X),Int128.Int128Mul(i.X-r.X,r.Y-n.Y)):ClipperLib.Cast_Int64((i.Y-r.Y)*(r.X-n.X))-ClipperLib.Cast_Int64((i.X-r.X)*(r.Y-n.Y))===0):(i=l[0],r=l[1],n=l[2],p=l[3],o=l[4],o?Int128.op_Equality(Int128.Int128Mul(i.Y-r.Y,n.X-p.X),Int128.Int128Mul(i.X-r.X,n.Y-p.Y)):ClipperLib.Cast_Int64((i.Y-r.Y)*(n.X-p.X))-ClipperLib.Cast_Int64((i.X-r.X)*(n.Y-p.Y))===0)},ClipperLib.ClipperBase.SlopesEqual3=function(t,e,i){return i?Int128.op_Equality(Int128.Int128Mul(t.Delta.Y,e.Delta.X),Int128.Int128Mul(t.Delta.X,e.Delta.Y)):ClipperLib.Cast_Int64(t.Delta.Y*e.Delta.X)==ClipperLib.Cast_Int64(t.Delta.X*e.Delta.Y)},ClipperLib.ClipperBase.SlopesEqual4=function(t,e,i,r){return r?Int128.op_Equality(Int128.Int128Mul(t.Y-e.Y,e.X-i.X),Int128.Int128Mul(t.X-e.X,e.Y-i.Y)):ClipperLib.Cast_Int64((t.Y-e.Y)*(e.X-i.X))-ClipperLib.Cast_Int64((t.X-e.X)*(e.Y-i.Y))===0},ClipperLib.ClipperBase.SlopesEqual5=function(t,e,i,r,n){return n?Int128.op_Equality(Int128.Int128Mul(t.Y-e.Y,i.X-r.X),Int128.Int128Mul(t.X-e.X,i.Y-r.Y)):ClipperLib.Cast_Int64((t.Y-e.Y)*(i.X-r.X))-ClipperLib.Cast_Int64((t.X-e.X)*(i.Y-r.Y))===0},ClipperLib.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var t=0,e=this.m_edges.length;e>t;++t){for(var i=0,r=this.m_edges[t].length;r>i;++i)this.m_edges[t][i]=null;ClipperLib.Clear(this.m_edges[t])}ClipperLib.Clear(this.m_edges),this.m_UseFullRange=!1,this.m_HasOpenPaths=!1},ClipperLib.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!==this.m_MinimaList;){var t=this.m_MinimaList.Next;this.m_MinimaList=null,this.m_MinimaList=t}this.m_CurrentLM=null},ClipperLib.ClipperBase.prototype.RangeTest=function(t,e){e.Value?(t.X>ClipperLib.ClipperBase.hiRange||t.Y>ClipperLib.ClipperBase.hiRange||-t.X>ClipperLib.ClipperBase.hiRange||-t.Y>ClipperLib.ClipperBase.hiRange)&&ClipperLib.Error("Coordinate outside allowed range in RangeTest()."):(t.X>ClipperLib.ClipperBase.loRange||t.Y>ClipperLib.ClipperBase.loRange||-t.X>ClipperLib.ClipperBase.loRange||-t.Y>ClipperLib.ClipperBase.loRange)&&(e.Value=!0,this.RangeTest(t,e))},ClipperLib.ClipperBase.prototype.InitEdge=function(t,e,i,r){t.Next=e,t.Prev=i,t.Curr.X=r.X,t.Curr.Y=r.Y,t.OutIdx=-1},ClipperLib.ClipperBase.prototype.InitEdge2=function(t,e){t.Curr.Y>=t.Next.Curr.Y?(t.Bot.X=t.Curr.X,t.Bot.Y=t.Curr.Y,t.Top.X=t.Next.Curr.X,t.Top.Y=t.Next.Curr.Y):(t.Top.X=t.Curr.X,t.Top.Y=t.Curr.Y,t.Bot.X=t.Next.Curr.X,t.Bot.Y=t.Next.Curr.Y),this.SetDx(t),t.PolyTyp=e},ClipperLib.ClipperBase.prototype.FindNextLocMin=function(t){for(var e;;){for(;ClipperLib.IntPoint.op_Inequality(t.Bot,t.Prev.Bot)||ClipperLib.IntPoint.op_Equality(t.Curr,t.Top);)t=t.Next;if(t.Dx!=ClipperLib.ClipperBase.horizontal&&t.Prev.Dx!=ClipperLib.ClipperBase.horizontal)break;for(;t.Prev.Dx==ClipperLib.ClipperBase.horizontal;)t=t.Prev;for(e=t;t.Dx==ClipperLib.ClipperBase.horizontal;)t=t.Next;if(t.Top.Y!=t.Prev.Bot.Y){e.Prev.Bot.X<t.Bot.X&&(t=e);break}}return t},ClipperLib.ClipperBase.prototype.ProcessBound=function(t,e){var i,r,n=t,p=t;if(t.Dx==ClipperLib.ClipperBase.horizontal&&(r=e?t.Prev.Bot.X:t.Next.Bot.X,t.Bot.X!=r&&this.ReverseHorizontal(t)),p.OutIdx!=ClipperLib.ClipperBase.Skip)if(e){for(;p.Top.Y==p.Next.Bot.Y&&p.Next.OutIdx!=ClipperLib.ClipperBase.Skip;)p=p.Next;if(p.Dx==ClipperLib.ClipperBase.horizontal&&p.Next.OutIdx!=ClipperLib.ClipperBase.Skip){for(i=p;i.Prev.Dx==ClipperLib.ClipperBase.horizontal;)i=i.Prev;i.Prev.Top.X==p.Next.Top.X?e||(p=i.Prev):i.Prev.Top.X>p.Next.Top.X&&(p=i.Prev)}for(;t!=p;)t.NextInLML=t.Next,t.Dx==ClipperLib.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Prev.Top.X&&this.ReverseHorizontal(t),t=t.Next;t.Dx==ClipperLib.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Prev.Top.X&&this.ReverseHorizontal(t),p=p.Next}else{for(;p.Top.Y==p.Prev.Bot.Y&&p.Prev.OutIdx!=ClipperLib.ClipperBase.Skip;)p=p.Prev;if(p.Dx==ClipperLib.ClipperBase.horizontal&&p.Prev.OutIdx!=ClipperLib.ClipperBase.Skip){for(i=p;i.Next.Dx==ClipperLib.ClipperBase.horizontal;)i=i.Next;i.Next.Top.X==p.Prev.Top.X?e||(p=i.Next):i.Next.Top.X>p.Prev.Top.X&&(p=i.Next)}for(;t!=p;)t.NextInLML=t.Prev,t.Dx==ClipperLib.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Next.Top.X&&this.ReverseHorizontal(t),t=t.Prev;t.Dx==ClipperLib.ClipperBase.horizontal&&t!=n&&t.Bot.X!=t.Next.Top.X&&this.ReverseHorizontal(t),p=p.Prev}if(p.OutIdx==ClipperLib.ClipperBase.Skip){if(t=p,e){for(;t.Top.Y==t.Next.Bot.Y;)t=t.Next;for(;t!=p&&t.Dx==ClipperLib.ClipperBase.horizontal;)t=t.Prev}else{for(;t.Top.Y==t.Prev.Bot.Y;)t=t.Prev;for(;t!=p&&t.Dx==ClipperLib.ClipperBase.horizontal;)t=t.Next}if(t==p)p=e?t.Next:t.Prev;else{t=e?p.Next:p.Prev;var o=new ClipperLib.LocalMinima;o.Next=null,o.Y=t.Bot.Y,o.LeftBound=null,o.RightBound=t,o.RightBound.WindDelta=0,p=this.ProcessBound(o.RightBound,e),this.InsertLocalMinima(o)}}return p},ClipperLib.ClipperBase.prototype.AddPath=function(t,e,i){use_lines?i||e!=ClipperLib.PolyType.ptClip||ClipperLib.Error("AddPath: Open paths must be subject."):i||ClipperLib.Error("AddPath: Open paths have been disabled.");var r=t.length-1;if(i)for(;r>0&&ClipperLib.IntPoint.op_Equality(t[r],t[0]);)--r;for(;r>0&&ClipperLib.IntPoint.op_Equality(t[r],t[r-1]);)--r;if(i&&2>r||!i&&1>r)return!1;for(var n=new Array,p=0;r>=p;p++)n.push(new ClipperLib.TEdge);var o=!0;n[1].Curr.X=t[1].X,n[1].Curr.Y=t[1].Y;var l={Value:this.m_UseFullRange};this.RangeTest(t[0],l),this.m_UseFullRange=l.Value,l.Value=this.m_UseFullRange,this.RangeTest(t[r],l),this.m_UseFullRange=l.Value,this.InitEdge(n[0],n[1],n[r],t[0]),this.InitEdge(n[r],n[0],n[r-1],t[r]);for(var p=r-1;p>=1;--p)l.Value=this.m_UseFullRange,this.RangeTest(t[p],l),this.m_UseFullRange=l.Value,this.InitEdge(n[p],n[p+1],n[p-1],t[p]);for(var s=n[0],u=s,h=s;;)if(ClipperLib.IntPoint.op_Equality(u.Curr,u.Next.Curr)){if(u==u.Next)break;u==s&&(s=u.Next),u=this.RemoveEdge(u),h=u}else{if(u.Prev==u.Next)break;if(!i||!ClipperLib.ClipperBase.SlopesEqual(u.Prev.Curr,u.Curr,u.Next.Curr,this.m_UseFullRange)||this.PreserveCollinear&&this.Pt2IsBetweenPt1AndPt3(u.Prev.Curr,u.Curr,u.Next.Curr)){if(u=u.Next,u==h)break}else u==s&&(s=u.Next),u=this.RemoveEdge(u),u=u.Prev,h=u}if(!i&&u==u.Next||i&&u.Prev==u.Next)return!1;i||(this.m_HasOpenPaths=!0,s.Prev.OutIdx=ClipperLib.ClipperBase.Skip);u=s;do this.InitEdge2(u,e),u=u.Next,o&&u.Curr.Y!=s.Curr.Y&&(o=!1);while(u!=s);if(o){if(i)return!1;u.Prev.OutIdx=ClipperLib.ClipperBase.Skip,u.Prev.Bot.X<u.Prev.Top.X&&this.ReverseHorizontal(u.Prev);var a=new ClipperLib.LocalMinima;for(a.Next=null,a.Y=u.Bot.Y,a.LeftBound=null,a.RightBound=u,a.RightBound.Side=ClipperLib.EdgeSide.esRight,a.RightBound.WindDelta=0;u.Next.OutIdx!=ClipperLib.ClipperBase.Skip;)u.NextInLML=u.Next,u.Bot.X!=u.Prev.Top.X&&this.ReverseHorizontal(u),u=u.Next;return this.InsertLocalMinima(a),this.m_edges.push(n),!0}this.m_edges.push(n);for(var C,f=null;u=this.FindNextLocMin(u),u!=f;){null==f&&(f=u);var a=new ClipperLib.LocalMinima;a.Next=null,a.Y=u.Bot.Y,u.Dx<u.Prev.Dx?(a.LeftBound=u.Prev,a.RightBound=u,C=!1):(a.LeftBound=u,a.RightBound=u.Prev,C=!0),a.LeftBound.Side=ClipperLib.EdgeSide.esLeft,a.RightBound.Side=ClipperLib.EdgeSide.esRight,i?a.LeftBound.Next==a.RightBound?a.LeftBound.WindDelta=-1:a.LeftBound.WindDelta=1:a.LeftBound.WindDelta=0,a.RightBound.WindDelta=-a.LeftBound.WindDelta,u=this.ProcessBound(a.LeftBound,C);var d=this.ProcessBound(a.RightBound,!C);a.LeftBound.OutIdx==ClipperLib.ClipperBase.Skip?a.LeftBound=null:a.RightBound.OutIdx==ClipperLib.ClipperBase.Skip&&(a.RightBound=null),this.InsertLocalMinima(a),C||(u=d)}return!0},ClipperLib.ClipperBase.prototype.AddPaths=function(t,e,i){for(var r=!1,n=0,p=t.length;p>n;++n)this.AddPath(t[n],e,i)&&(r=!0);return r},ClipperLib.ClipperBase.prototype.Pt2IsBetweenPt1AndPt3=function(t,e,i){return ClipperLib.IntPoint.op_Equality(t,i)||ClipperLib.IntPoint.op_Equality(t,e)||ClipperLib.IntPoint.op_Equality(i,e)?!1:t.X!=i.X?e.X>t.X==e.X<i.X:e.Y>t.Y==e.Y<i.Y},ClipperLib.ClipperBase.prototype.RemoveEdge=function(t){t.Prev.Next=t.Next,t.Next.Prev=t.Prev;var e=t.Next;return t.Prev=null,e},ClipperLib.ClipperBase.prototype.SetDx=function(t){t.Delta.X=t.Top.X-t.Bot.X,t.Delta.Y=t.Top.Y-t.Bot.Y,0===t.Delta.Y?t.Dx=ClipperLib.ClipperBase.horizontal:t.Dx=t.Delta.X/t.Delta.Y},ClipperLib.ClipperBase.prototype.InsertLocalMinima=function(t){if(null===this.m_MinimaList)this.m_MinimaList=t;else if(t.Y>=this.m_MinimaList.Y)t.Next=this.m_MinimaList,this.m_MinimaList=t;else{for(var e=this.m_MinimaList;null!==e.Next&&t.Y<e.Next.Y;)e=e.Next;t.Next=e.Next,e.Next=t}},ClipperLib.ClipperBase.prototype.PopLocalMinima=function(){null!==this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.Next)},ClipperLib.ClipperBase.prototype.ReverseHorizontal=function(t){var e=t.Top.X;t.Top.X=t.Bot.X,t.Bot.X=e,use_xyz&&(e=t.Top.Z,t.Top.Z=t.Bot.Z,t.Bot.Z=e)},ClipperLib.ClipperBase.prototype.Reset=function(){if(this.m_CurrentLM=this.m_MinimaList,null!=this.m_CurrentLM)for(var t=this.m_MinimaList;null!=t;){var e=t.LeftBound;null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.Side=ClipperLib.EdgeSide.esLeft,e.OutIdx=ClipperLib.ClipperBase.Unassigned),e=t.RightBound,null!=e&&(e.Curr.X=e.Bot.X,e.Curr.Y=e.Bot.Y,e.Side=ClipperLib.EdgeSide.esRight,e.OutIdx=ClipperLib.ClipperBase.Unassigned),t=t.Next}},ClipperLib.Clipper=function(t){"undefined"==typeof t&&(t=0),this.m_PolyOuts=null,this.m_ClipType=ClipperLib.ClipType.ctIntersection,this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=null,this.m_IntersectNodeComparer=null,this.m_ExecuteLocked=!1,this.m_ClipFillType=ClipperLib.PolyFillType.pftEvenOdd,this.m_SubjFillType=ClipperLib.PolyFillType.pftEvenOdd,this.m_Joins=null,this.m_GhostJoins=null,this.m_UsingPolyTree=!1,this.ReverseSolution=!1,this.StrictlySimple=!1,ClipperLib.ClipperBase.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null,this.m_IntersectList=new Array,this.m_IntersectNodeComparer=ClipperLib.MyIntersectNodeSort.Compare,this.m_ExecuteLocked=!1,this.m_UsingPolyTree=!1,this.m_PolyOuts=new Array,this.m_Joins=new Array,this.m_GhostJoins=new Array,this.ReverseSolution=0!==(1&t),this.StrictlySimple=0!==(2&t),this.PreserveCollinear=0!==(4&t),use_xyz&&(this.ZFillFunction=null)},ClipperLib.Clipper.ioReverseSolution=1,ClipperLib.Clipper.ioStrictlySimple=2,ClipperLib.Clipper.ioPreserveCollinear=4,ClipperLib.Clipper.prototype.Clear=function(){0!==this.m_edges.length&&(this.DisposeAllPolyPts(),ClipperLib.ClipperBase.prototype.Clear.call(this))},ClipperLib.Clipper.prototype.DisposeScanbeamList=function(){for(;null!==this.m_Scanbeam;){var t=this.m_Scanbeam.Next;this.m_Scanbeam=null,this.m_Scanbeam=t}},ClipperLib.Clipper.prototype.Reset=function(){ClipperLib.ClipperBase.prototype.Reset.call(this),this.m_Scanbeam=null,this.m_ActiveEdges=null,this.m_SortedEdges=null;for(var t=this.m_MinimaList;null!==t;)this.InsertScanbeam(t.Y),t=t.Next},ClipperLib.Clipper.prototype.InsertScanbeam=function(t){if(null===this.m_Scanbeam)this.m_Scanbeam=new ClipperLib.Scanbeam,this.m_Scanbeam.Next=null,this.m_Scanbeam.Y=t;else if(t>this.m_Scanbeam.Y){var e=new ClipperLib.Scanbeam;e.Y=t,e.Next=this.m_Scanbeam,this.m_Scanbeam=e}else{for(var i=this.m_Scanbeam;null!==i.Next&&t<=i.Next.Y;)i=i.Next;if(t==i.Y)return;var e=new ClipperLib.Scanbeam;e.Y=t,e.Next=i.Next,i.Next=e}},ClipperLib.Clipper.prototype.Execute=function(){var t=arguments,e=t.length,i=t[1]instanceof ClipperLib.PolyTree;if(4==e&&!i){var r=t[0],n=t[1],p=t[2],o=t[3];if(this.m_ExecuteLocked)return!1;this.m_HasOpenPaths&&ClipperLib.Error("Error: PolyTree struct is need for open path clipping."),this.m_ExecuteLocked=!0,ClipperLib.Clear(n),this.m_SubjFillType=p,this.m_ClipFillType=o,this.m_ClipType=r,this.m_UsingPolyTree=!1;try{var l=this.ExecuteInternal();l&&this.BuildResult(n)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return l}if(4==e&&i){var r=t[0],s=t[1],p=t[2],o=t[3];if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,this.m_SubjFillType=p,this.m_ClipFillType=o,this.m_ClipType=r,this.m_UsingPolyTree=!0;try{var l=this.ExecuteInternal();l&&this.BuildResult2(s)}finally{this.DisposeAllPolyPts(),this.m_ExecuteLocked=!1}return l}if(2==e&&!i){var r=t[0],n=t[1];return this.Execute(r,n,ClipperLib.PolyFillType.pftEvenOdd,ClipperLib.PolyFillType.pftEvenOdd)}if(2==e&&i){var r=t[0],s=t[1];return this.Execute(r,s,ClipperLib.PolyFillType.pftEvenOdd,ClipperLib.PolyFillType.pftEvenOdd)}},ClipperLib.Clipper.prototype.FixHoleLinkage=function(t){if(null!==t.FirstLeft&&(t.IsHole==t.FirstLeft.IsHole||null===t.FirstLeft.Pts)){for(var e=t.FirstLeft;null!==e&&(e.IsHole==t.IsHole||null===e.Pts);)e=e.FirstLeft;t.FirstLeft=e}},ClipperLib.Clipper.prototype.ExecuteInternal=function(){try{if(this.Reset(),null===this.m_CurrentLM)return!1;var t=this.PopScanbeam();do{if(this.InsertLocalMinimaIntoAEL(t),ClipperLib.Clear(this.m_GhostJoins),this.ProcessHorizontals(!1),null===this.m_Scanbeam)break;var e=this.PopScanbeam();if(!this.ProcessIntersections(t,e))return!1;this.ProcessEdgesAtTopOfScanbeam(e),t=e}while(null!==this.m_Scanbeam||null!==this.m_CurrentLM);for(var i=0,r=this.m_PolyOuts.length;r>i;i++){var n=this.m_PolyOuts[i];null===n.Pts||n.IsOpen||(n.IsHole^this.ReverseSolution)==this.Area(n)>0&&this.ReversePolyPtLinks(n.Pts)}this.JoinCommonEdges();for(var i=0,r=this.m_PolyOuts.length;r>i;i++){var n=this.m_PolyOuts[i];null===n.Pts||n.IsOpen||this.FixupOutPolygon(n)}return this.StrictlySimple&&this.DoSimplePolygons(),!0}finally{ClipperLib.Clear(this.m_Joins),ClipperLib.Clear(this.m_GhostJoins)}},ClipperLib.Clipper.prototype.PopScanbeam=function(){var t=this.m_Scanbeam.Y,e=this.m_Scanbeam;return this.m_Scanbeam=this.m_Scanbeam.Next,e=null,t},ClipperLib.Clipper.prototype.DisposeAllPolyPts=function(){for(var t=0,e=this.m_PolyOuts.length;e>t;++t)this.DisposeOutRec(t);ClipperLib.Clear(this.m_PolyOuts)},ClipperLib.Clipper.prototype.DisposeOutRec=function(t){var e=this.m_PolyOuts[t];null!==e.Pts&&this.DisposeOutPts(e.Pts),e=null,this.m_PolyOuts[t]=null},ClipperLib.Clipper.prototype.DisposeOutPts=function(t){if(null!==t){var e=null;for(t.Prev.Next=null;null!==t;)e=t,t=t.Next,e=null}},ClipperLib.Clipper.prototype.AddJoin=function(t,e,i){var r=new ClipperLib.Join;r.OutPt1=t,r.OutPt2=e,r.OffPt.X=i.X,r.OffPt.Y=i.Y,this.m_Joins.push(r)},ClipperLib.Clipper.prototype.AddGhostJoin=function(t,e){var i=new ClipperLib.Join;i.OutPt1=t,i.OffPt.X=e.X,i.OffPt.Y=e.Y,this.m_GhostJoins.push(i)},use_xyz&&(ClipperLib.Clipper.prototype.SetZ=function(t,e){t.Z=0,null!==this.ZFillFunction&&(e.OutIdx<0?this.ZFillFunction(e.Bot,e.Top,t):this.ZFillFunction(e.Top,e.Bot,t))}),ClipperLib.Clipper.prototype.InsertLocalMinimaIntoAEL=function(t){for(;null!==this.m_CurrentLM&&this.m_CurrentLM.Y==t;){var e=this.m_CurrentLM.LeftBound,i=this.m_CurrentLM.RightBound;this.PopLocalMinima();var r=null;if(null===e?(this.InsertEdgeIntoAEL(i,null),this.SetWindingCount(i),this.IsContributing(i)&&(r=this.AddOutPt(i,i.Bot))):null==i?(this.InsertEdgeIntoAEL(e,null),this.SetWindingCount(e),this.IsContributing(e)&&(r=this.AddOutPt(e,e.Bot)),this.InsertScanbeam(e.Top.Y)):(this.InsertEdgeIntoAEL(e,null),this.InsertEdgeIntoAEL(i,e),this.SetWindingCount(e),i.WindCnt=e.WindCnt,i.WindCnt2=e.WindCnt2,this.IsContributing(e)&&(r=this.AddLocalMinPoly(e,i,e.Bot)),this.InsertScanbeam(e.Top.Y)),null!=i&&(ClipperLib.ClipperBase.IsHorizontal(i)?this.AddEdgeToSEL(i):this.InsertScanbeam(i.Top.Y)),null!=e&&null!=i){if(null!==r&&ClipperLib.ClipperBase.IsHorizontal(i)&&this.m_GhostJoins.length>0&&0!==i.WindDelta)for(var n=0,p=this.m_GhostJoins.length;p>n;n++){var o=this.m_GhostJoins[n];this.HorzSegmentsOverlap(o.OutPt1.Pt,o.OffPt,i.Bot,i.Top)&&this.AddJoin(o.OutPt1,r,o.OffPt)}if(e.OutIdx>=0&&null!==e.PrevInAEL&&e.PrevInAEL.Curr.X==e.Bot.X&&e.PrevInAEL.OutIdx>=0&&ClipperLib.ClipperBase.SlopesEqual(e.PrevInAEL,e,this.m_UseFullRange)&&0!==e.WindDelta&&0!==e.PrevInAEL.WindDelta){var l=this.AddOutPt(e.PrevInAEL,e.Bot);this.AddJoin(r,l,e.Top)}if(e.NextInAEL!=i){if(i.OutIdx>=0&&i.PrevInAEL.OutIdx>=0&&ClipperLib.ClipperBase.SlopesEqual(i.PrevInAEL,i,this.m_UseFullRange)&&0!==i.WindDelta&&0!==i.PrevInAEL.WindDelta){var l=this.AddOutPt(i.PrevInAEL,i.Bot);this.AddJoin(r,l,i.Top)}var s=e.NextInAEL;if(null!==s)for(;s!=i;)this.IntersectEdges(i,s,e.Curr,!1),s=s.NextInAEL}}}},ClipperLib.Clipper.prototype.InsertEdgeIntoAEL=function(t,e){if(null===this.m_ActiveEdges)t.PrevInAEL=null,t.NextInAEL=null,this.m_ActiveEdges=t;else if(null===e&&this.E2InsertsBeforeE1(this.m_ActiveEdges,t))t.PrevInAEL=null,t.NextInAEL=this.m_ActiveEdges,this.m_ActiveEdges.PrevInAEL=t,this.m_ActiveEdges=t;else{for(null===e&&(e=this.m_ActiveEdges);null!==e.NextInAEL&&!this.E2InsertsBeforeE1(e.NextInAEL,t);)e=e.NextInAEL;t.NextInAEL=e.NextInAEL,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=t),t.PrevInAEL=e,e.NextInAEL=t}},ClipperLib.Clipper.prototype.E2InsertsBeforeE1=function(t,e){return e.Curr.X==t.Curr.X?e.Top.Y>t.Top.Y?e.Top.X<ClipperLib.Clipper.TopX(t,e.Top.Y):t.Top.X>ClipperLib.Clipper.TopX(e,t.Top.Y):e.Curr.X<t.Curr.X},ClipperLib.Clipper.prototype.IsEvenOddFillType=function(t){return t.PolyTyp==ClipperLib.PolyType.ptSubject?this.m_SubjFillType==ClipperLib.PolyFillType.pftEvenOdd:this.m_ClipFillType==ClipperLib.PolyFillType.pftEvenOdd},ClipperLib.Clipper.prototype.IsEvenOddAltFillType=function(t){return t.PolyTyp==ClipperLib.PolyType.ptSubject?this.m_ClipFillType==ClipperLib.PolyFillType.pftEvenOdd:this.m_SubjFillType==ClipperLib.PolyFillType.pftEvenOdd},ClipperLib.Clipper.prototype.IsContributing=function(t){var e,i;switch(t.PolyTyp==ClipperLib.PolyType.ptSubject?(e=this.m_SubjFillType,i=this.m_ClipFillType):(e=this.m_ClipFillType,i=this.m_SubjFillType),e){case ClipperLib.PolyFillType.pftEvenOdd:if(0===t.WindDelta&&1!=t.WindCnt)return!1;break;case ClipperLib.PolyFillType.pftNonZero:if(1!=Math.abs(t.WindCnt))return!1;break;case ClipperLib.PolyFillType.pftPositive:if(1!=t.WindCnt)return!1;break;default:if(-1!=t.WindCnt)return!1}switch(this.m_ClipType){case ClipperLib.ClipType.ctIntersection:switch(i){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case ClipperLib.ClipType.ctUnion:switch(i){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0===t.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}case ClipperLib.ClipType.ctDifference:if(t.PolyTyp==ClipperLib.PolyType.ptSubject)switch(i){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0===t.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}else switch(i){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0!==t.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return t.WindCnt2>0;default:return t.WindCnt2<0}case ClipperLib.ClipType.ctXor:if(0!==t.WindDelta)return!0;switch(i){case ClipperLib.PolyFillType.pftEvenOdd:case ClipperLib.PolyFillType.pftNonZero:return 0===t.WindCnt2;case ClipperLib.PolyFillType.pftPositive:return t.WindCnt2<=0;default:return t.WindCnt2>=0}}return!0},ClipperLib.Clipper.prototype.SetWindingCount=function(t){for(var e=t.PrevInAEL;null!==e&&(e.PolyTyp!=t.PolyTyp||0===e.WindDelta);)e=e.PrevInAEL;if(null===e)t.WindCnt=0===t.WindDelta?1:t.WindDelta,t.WindCnt2=0,e=this.m_ActiveEdges;else if(0===t.WindDelta&&this.m_ClipType!=ClipperLib.ClipType.ctUnion)t.WindCnt=1,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;else if(this.IsEvenOddFillType(t)){if(0===t.WindDelta){for(var i=!0,r=e.PrevInAEL;null!==r;)r.PolyTyp==e.PolyTyp&&0!==r.WindDelta&&(i=!i),r=r.PrevInAEL;t.WindCnt=i?0:1}else t.WindCnt=t.WindDelta;t.WindCnt2=e.WindCnt2,e=e.NextInAEL}else e.WindCnt*e.WindDelta<0?Math.abs(e.WindCnt)>1?e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta:t.WindCnt=0===t.WindDelta?1:t.WindDelta:0===t.WindDelta?t.WindCnt=e.WindCnt<0?e.WindCnt-1:e.WindCnt+1:e.WindDelta*t.WindDelta<0?t.WindCnt=e.WindCnt:t.WindCnt=e.WindCnt+t.WindDelta,t.WindCnt2=e.WindCnt2,e=e.NextInAEL;if(this.IsEvenOddAltFillType(t))for(;e!=t;)0!==e.WindDelta&&(t.WindCnt2=0===t.WindCnt2?1:0),e=e.NextInAEL;else for(;e!=t;)t.WindCnt2+=e.WindDelta,e=e.NextInAEL},ClipperLib.Clipper.prototype.AddEdgeToSEL=function(t){null===this.m_SortedEdges?(this.m_SortedEdges=t,t.PrevInSEL=null,t.NextInSEL=null):(t.NextInSEL=this.m_SortedEdges,t.PrevInSEL=null,this.m_SortedEdges.PrevInSEL=t,this.m_SortedEdges=t)},ClipperLib.Clipper.prototype.CopyAELToSEL=function(){var t=this.m_ActiveEdges;for(this.m_SortedEdges=t;null!==t;)t.PrevInSEL=t.PrevInAEL,t.NextInSEL=t.NextInAEL,t=t.NextInAEL},ClipperLib.Clipper.prototype.SwapPositionsInAEL=function(t,e){if(t.NextInAEL!=t.PrevInAEL&&e.NextInAEL!=e.PrevInAEL){if(t.NextInAEL==e){var i=e.NextInAEL;null!==i&&(i.PrevInAEL=t);var r=t.PrevInAEL;null!==r&&(r.NextInAEL=e),e.PrevInAEL=r,e.NextInAEL=t,t.PrevInAEL=e,t.NextInAEL=i}else if(e.NextInAEL==t){var i=t.NextInAEL;null!==i&&(i.PrevInAEL=e);var r=e.PrevInAEL;null!==r&&(r.NextInAEL=t),t.PrevInAEL=r,t.NextInAEL=e,e.PrevInAEL=t,e.NextInAEL=i}else{var i=t.NextInAEL,r=t.PrevInAEL;t.NextInAEL=e.NextInAEL,null!==t.NextInAEL&&(t.NextInAEL.PrevInAEL=t),t.PrevInAEL=e.PrevInAEL,null!==t.PrevInAEL&&(t.PrevInAEL.NextInAEL=t),e.NextInAEL=i,null!==e.NextInAEL&&(e.NextInAEL.PrevInAEL=e),e.PrevInAEL=r,null!==e.PrevInAEL&&(e.PrevInAEL.NextInAEL=e)}null===t.PrevInAEL?this.m_ActiveEdges=t:null===e.PrevInAEL&&(this.m_ActiveEdges=e)}},ClipperLib.Clipper.prototype.SwapPositionsInSEL=function(t,e){if(!(null===t.NextInSEL&&null===t.PrevInSEL||null===e.NextInSEL&&null===e.PrevInSEL)){if(t.NextInSEL==e){var i=e.NextInSEL;null!==i&&(i.PrevInSEL=t);var r=t.PrevInSEL;null!==r&&(r.NextInSEL=e),e.PrevInSEL=r,e.NextInSEL=t,t.PrevInSEL=e,t.NextInSEL=i}else if(e.NextInSEL==t){var i=t.NextInSEL;null!==i&&(i.PrevInSEL=e);var r=e.PrevInSEL;null!==r&&(r.NextInSEL=t),t.PrevInSEL=r,t.NextInSEL=e,e.PrevInSEL=t,e.NextInSEL=i}else{var i=t.NextInSEL,r=t.PrevInSEL;t.NextInSEL=e.NextInSEL,null!==t.NextInSEL&&(t.NextInSEL.PrevInSEL=t),t.PrevInSEL=e.PrevInSEL,null!==t.PrevInSEL&&(t.PrevInSEL.NextInSEL=t),e.NextInSEL=i,null!==e.NextInSEL&&(e.NextInSEL.PrevInSEL=e),e.PrevInSEL=r,null!==e.PrevInSEL&&(e.PrevInSEL.NextInSEL=e)}null===t.PrevInSEL?this.m_SortedEdges=t:null===e.PrevInSEL&&(this.m_SortedEdges=e)}},ClipperLib.Clipper.prototype.AddLocalMaxPoly=function(t,e,i){this.AddOutPt(t,i),0==e.WindDelta&&this.AddOutPt(e,i),t.OutIdx==e.OutIdx?(t.OutIdx=-1,e.OutIdx=-1):t.OutIdx<e.OutIdx?this.AppendPolygon(t,e):this.AppendPolygon(e,t)},ClipperLib.Clipper.prototype.AddLocalMinPoly=function(t,e,i){var r,n,p;if(ClipperLib.ClipperBase.IsHorizontal(e)||t.Dx>e.Dx?(r=this.AddOutPt(t,i),e.OutIdx=t.OutIdx,t.Side=ClipperLib.EdgeSide.esLeft,e.Side=ClipperLib.EdgeSide.esRight,n=t,p=n.PrevInAEL==e?e.PrevInAEL:n.PrevInAEL):(r=this.AddOutPt(e,i),t.OutIdx=e.OutIdx,t.Side=ClipperLib.EdgeSide.esRight,e.Side=ClipperLib.EdgeSide.esLeft,n=e,p=n.PrevInAEL==t?t.PrevInAEL:n.PrevInAEL),null!==p&&p.OutIdx>=0&&ClipperLib.Clipper.TopX(p,i.Y)==ClipperLib.Clipper.TopX(n,i.Y)&&ClipperLib.ClipperBase.SlopesEqual(n,p,this.m_UseFullRange)&&0!==n.WindDelta&&0!==p.WindDelta){var o=this.AddOutPt(p,i);this.AddJoin(r,o,n.Top)}return r},ClipperLib.Clipper.prototype.CreateOutRec=function(){var t=new ClipperLib.OutRec;return t.Idx=-1,t.IsHole=!1,t.IsOpen=!1,t.FirstLeft=null,t.Pts=null,t.BottomPt=null,t.PolyNode=null,this.m_PolyOuts.push(t),t.Idx=this.m_PolyOuts.length-1,t},ClipperLib.Clipper.prototype.AddOutPt=function(t,e){var i=t.Side==ClipperLib.EdgeSide.esLeft;if(t.OutIdx<0){var r=this.CreateOutRec();r.IsOpen=0===t.WindDelta;var n=new ClipperLib.OutPt;return r.Pts=n,n.Idx=r.Idx,n.Pt.X=e.X,n.Pt.Y=e.Y,n.Next=n,n.Prev=n,r.IsOpen||this.SetHoleState(t,r),use_xyz&&(ClipperLib.IntPoint.op_Equality(e,t.Bot)?(n.Pt.X=t.Bot.X,n.Pt.Y=t.Bot.Y,n.Pt.Z=t.Bot.Z):ClipperLib.IntPoint.op_Equality(e,t.Top)?(n.Pt.X=t.Top.X,n.Pt.Y=t.Top.Y,n.Pt.Z=t.Top.Z):this.SetZ(n.Pt,t)),t.OutIdx=r.Idx,n}var r=this.m_PolyOuts[t.OutIdx],p=r.Pts;if(i&&ClipperLib.IntPoint.op_Equality(e,p.Pt))return p;if(!i&&ClipperLib.IntPoint.op_Equality(e,p.Prev.Pt))return p.Prev;var n=new ClipperLib.OutPt;return n.Idx=r.Idx,n.Pt.X=e.X,n.Pt.Y=e.Y,n.Next=p,n.Prev=p.Prev,n.Prev.Next=n,p.Prev=n,i&&(r.Pts=n),use_xyz&&(ClipperLib.IntPoint.op_Equality(e,t.Bot)?(n.Pt.X=t.Bot.X,n.Pt.Y=t.Bot.Y,n.Pt.Z=t.Bot.Z):ClipperLib.IntPoint.op_Equality(e,t.Top)?(n.Pt.X=t.Top.X,n.Pt.Y=t.Top.Y,n.Pt.Z=t.Top.Z):this.SetZ(n.Pt,t)),n},ClipperLib.Clipper.prototype.SwapPoints=function(t,e){var i=new ClipperLib.IntPoint(t.Value);t.Value.X=e.Value.X,t.Value.Y=e.Value.Y,e.Value.X=i.X,e.Value.Y=i.Y},ClipperLib.Clipper.prototype.HorzSegmentsOverlap=function(t,e,i,r){return t.X>i.X==t.X<r.X?!0:e.X>i.X==e.X<r.X?!0:i.X>t.X==i.X<e.X?!0:r.X>t.X==r.X<e.X?!0:t.X==i.X&&e.X==r.X?!0:t.X==r.X&&e.X==i.X?!0:!1},ClipperLib.Clipper.prototype.InsertPolyPtBetween=function(t,e,i){var r=new ClipperLib.OutPt;return r.Pt.X=i.X,r.Pt.Y=i.Y,e==t.Next?(t.Next=r,e.Prev=r,r.Next=e,r.Prev=t):(e.Next=r,t.Prev=r,r.Next=t,r.Prev=e),r},ClipperLib.Clipper.prototype.SetHoleState=function(t,e){for(var i=!1,r=t.PrevInAEL;null!==r;)r.OutIdx>=0&&0!=r.WindDelta&&(i=!i,null===e.FirstLeft&&(e.FirstLeft=this.m_PolyOuts[r.OutIdx])),r=r.PrevInAEL;i&&(e.IsHole=!0)},ClipperLib.Clipper.prototype.GetDx=function(t,e){return t.Y==e.Y?ClipperLib.ClipperBase.horizontal:(e.X-t.X)/(e.Y-t.Y)},ClipperLib.Clipper.prototype.FirstIsBottomPt=function(t,e){for(var i=t.Prev;ClipperLib.IntPoint.op_Equality(i.Pt,t.Pt)&&i!=t;)i=i.Prev;var r=Math.abs(this.GetDx(t.Pt,i.Pt));for(i=t.Next;ClipperLib.IntPoint.op_Equality(i.Pt,t.Pt)&&i!=t;)i=i.Next;var n=Math.abs(this.GetDx(t.Pt,i.Pt));for(i=e.Prev;ClipperLib.IntPoint.op_Equality(i.Pt,e.Pt)&&i!=e;)i=i.Prev;var p=Math.abs(this.GetDx(e.Pt,i.Pt));for(i=e.Next;ClipperLib.IntPoint.op_Equality(i.Pt,e.Pt)&&i!=e;)i=i.Next;var o=Math.abs(this.GetDx(e.Pt,i.Pt));return r>=p&&r>=o||n>=p&&n>=o},ClipperLib.Clipper.prototype.GetBottomPt=function(t){for(var e=null,i=t.Next;i!=t;)i.Pt.Y>t.Pt.Y?(t=i,e=null):i.Pt.Y==t.Pt.Y&&i.Pt.X<=t.Pt.X&&(i.Pt.X<t.Pt.X?(e=null,t=i):i.Next!=t&&i.Prev!=t&&(e=i)),i=i.Next;if(null!==e)for(;e!=i;)for(this.FirstIsBottomPt(i,e)||(t=e),e=e.Next;ClipperLib.IntPoint.op_Inequality(e.Pt,t.Pt);)e=e.Next;return t},ClipperLib.Clipper.prototype.GetLowermostRec=function(t,e){null===t.BottomPt&&(t.BottomPt=this.GetBottomPt(t.Pts)),null===e.BottomPt&&(e.BottomPt=this.GetBottomPt(e.Pts));var i=t.BottomPt,r=e.BottomPt;return i.Pt.Y>r.Pt.Y?t:i.Pt.Y<r.Pt.Y?e:i.Pt.X<r.Pt.X?t:i.Pt.X>r.Pt.X?e:i.Next==i?e:r.Next==r?t:this.FirstIsBottomPt(i,r)?t:e},ClipperLib.Clipper.prototype.Param1RightOfParam2=function(t,e){do if(t=t.FirstLeft,t==e)return!0;while(null!==t);return!1},ClipperLib.Clipper.prototype.GetOutRec=function(t){for(var e=this.m_PolyOuts[t];e!=this.m_PolyOuts[e.Idx];)e=this.m_PolyOuts[e.Idx];return e},ClipperLib.Clipper.prototype.AppendPolygon=function(t,e){var i,r=this.m_PolyOuts[t.OutIdx],n=this.m_PolyOuts[e.OutIdx];i=this.Param1RightOfParam2(r,n)?n:this.Param1RightOfParam2(n,r)?r:this.GetLowermostRec(r,n);var p,o=r.Pts,l=o.Prev,s=n.Pts,u=s.Prev;t.Side==ClipperLib.EdgeSide.esLeft?(e.Side==ClipperLib.EdgeSide.esLeft?(this.ReversePolyPtLinks(s),s.Next=o,o.Prev=s,l.Next=u,u.Prev=l,r.Pts=u):(u.Next=o,o.Prev=u,s.Prev=l,l.Next=s,r.Pts=s),p=ClipperLib.EdgeSide.esLeft):(e.Side==ClipperLib.EdgeSide.esRight?(this.ReversePolyPtLinks(s),l.Next=u,u.Prev=l,s.Next=o,o.Prev=s):(l.Next=s,s.Prev=l,o.Prev=u,u.Next=o),p=ClipperLib.EdgeSide.esRight),r.BottomPt=null,i==n&&(n.FirstLeft!=r&&(r.FirstLeft=n.FirstLeft),r.IsHole=n.IsHole),n.Pts=null,n.BottomPt=null,n.FirstLeft=r;var h=t.OutIdx,a=e.OutIdx;t.OutIdx=-1,e.OutIdx=-1;for(var C=this.m_ActiveEdges;null!==C;){if(C.OutIdx==a){C.OutIdx=h,C.Side=p;break}C=C.NextInAEL}n.Idx=r.Idx},ClipperLib.Clipper.prototype.ReversePolyPtLinks=function(t){if(null!==t){var e,i;e=t;do i=e.Next,e.Next=e.Prev,e.Prev=i,e=i;while(e!=t)}},ClipperLib.Clipper.SwapSides=function(t,e){var i=t.Side;t.Side=e.Side,e.Side=i},ClipperLib.Clipper.SwapPolyIndexes=function(t,e){var i=t.OutIdx;t.OutIdx=e.OutIdx,e.OutIdx=i},ClipperLib.Clipper.prototype.IntersectEdges=function(t,e,i,r){var n=!r&&null===t.NextInLML&&t.Top.X==i.X&&t.Top.Y==i.Y,p=!r&&null===e.NextInLML&&e.Top.X==i.X&&e.Top.Y==i.Y,o=t.OutIdx>=0,l=e.OutIdx>=0;if(use_lines&&(0===t.WindDelta||0===e.WindDelta))return 0===t.WindDelta&&0===e.WindDelta?(n||p)&&o&&l&&this.AddLocalMaxPoly(t,e,i):t.PolyTyp==e.PolyTyp&&t.WindDelta!=e.WindDelta&&this.m_ClipType==ClipperLib.ClipType.ctUnion?0===t.WindDelta?l&&(this.AddOutPt(t,i),o&&(t.OutIdx=-1)):o&&(this.AddOutPt(e,i),l&&(e.OutIdx=-1)):t.PolyTyp!=e.PolyTyp&&(0!==t.WindDelta||1!=Math.abs(e.WindCnt)||this.m_ClipType==ClipperLib.ClipType.ctUnion&&0!==e.WindCnt2?0!==e.WindDelta||1!=Math.abs(t.WindCnt)||this.m_ClipType==ClipperLib.ClipType.ctUnion&&0!==t.WindCnt2||(this.AddOutPt(e,i),l&&(e.OutIdx=-1)):(this.AddOutPt(t,i),o&&(t.OutIdx=-1))),n&&(t.OutIdx<0?this.DeleteFromAEL(t):ClipperLib.Error("Error intersecting polylines")),void(p&&(e.OutIdx<0?this.DeleteFromAEL(e):ClipperLib.Error("Error intersecting polylines")));if(t.PolyTyp==e.PolyTyp)if(this.IsEvenOddFillType(t)){var s=t.WindCnt;t.WindCnt=e.WindCnt,e.WindCnt=s}else t.WindCnt+e.WindDelta===0?t.WindCnt=-t.WindCnt:t.WindCnt+=e.WindDelta,e.WindCnt-t.WindDelta===0?e.WindCnt=-e.WindCnt:e.WindCnt-=t.WindDelta;else this.IsEvenOddFillType(e)?t.WindCnt2=0===t.WindCnt2?1:0:t.WindCnt2+=e.WindDelta,this.IsEvenOddFillType(t)?e.WindCnt2=0===e.WindCnt2?1:0:e.WindCnt2-=t.WindDelta;var u,h,a,C;t.PolyTyp==ClipperLib.PolyType.ptSubject?(u=this.m_SubjFillType,a=this.m_ClipFillType):(u=this.m_ClipFillType,a=this.m_SubjFillType),e.PolyTyp==ClipperLib.PolyType.ptSubject?(h=this.m_SubjFillType,C=this.m_ClipFillType):(h=this.m_ClipFillType,C=this.m_SubjFillType);var f,d;switch(u){case ClipperLib.PolyFillType.pftPositive:f=t.WindCnt;break;case ClipperLib.PolyFillType.pftNegative:f=-t.WindCnt;break;default:f=Math.abs(t.WindCnt)}switch(h){case ClipperLib.PolyFillType.pftPositive:d=e.WindCnt;break;case ClipperLib.PolyFillType.pftNegative:d=-e.WindCnt;break;default:d=Math.abs(e.WindCnt)}if(o&&l)n||p||0!==f&&1!=f||0!==d&&1!=d||t.PolyTyp!=e.PolyTyp&&this.m_ClipType!=ClipperLib.ClipType.ctXor?this.AddLocalMaxPoly(t,e,i):(this.AddOutPt(t,i),this.AddOutPt(e,i),ClipperLib.Clipper.SwapSides(t,e),ClipperLib.Clipper.SwapPolyIndexes(t,e));else if(o)(0===d||1==d)&&(this.AddOutPt(t,i),ClipperLib.Clipper.SwapSides(t,e),ClipperLib.Clipper.SwapPolyIndexes(t,e));else if(l)(0===f||1==f)&&(this.AddOutPt(e,i),ClipperLib.Clipper.SwapSides(t,e),ClipperLib.Clipper.SwapPolyIndexes(t,e));else if(!(0!==f&&1!=f||0!==d&&1!=d||n||p)){var L,P;switch(a){case ClipperLib.PolyFillType.pftPositive:L=t.WindCnt2;break;case ClipperLib.PolyFillType.pftNegative:L=-t.WindCnt2;break;default:L=Math.abs(t.WindCnt2)}switch(C){case ClipperLib.PolyFillType.pftPositive:P=e.WindCnt2;break;case ClipperLib.PolyFillType.pftNegative:P=-e.WindCnt2;break;default:P=Math.abs(e.WindCnt2)}if(t.PolyTyp!=e.PolyTyp)this.AddLocalMinPoly(t,e,i);else if(1==f&&1==d)switch(this.m_ClipType){case ClipperLib.ClipType.ctIntersection:L>0&&P>0&&this.AddLocalMinPoly(t,e,i);break;case ClipperLib.ClipType.ctUnion:0>=L&&0>=P&&this.AddLocalMinPoly(t,e,i);break;case ClipperLib.ClipType.ctDifference:(t.PolyTyp==ClipperLib.PolyType.ptClip&&L>0&&P>0||t.PolyTyp==ClipperLib.PolyType.ptSubject&&0>=L&&0>=P)&&this.AddLocalMinPoly(t,e,i);break;case ClipperLib.ClipType.ctXor:this.AddLocalMinPoly(t,e,i)}else ClipperLib.Clipper.SwapSides(t,e)}n!=p&&(n&&t.OutIdx>=0||p&&e.OutIdx>=0)&&(ClipperLib.Clipper.SwapSides(t,e),ClipperLib.Clipper.SwapPolyIndexes(t,e)),n&&this.DeleteFromAEL(t),
p&&this.DeleteFromAEL(e)},ClipperLib.Clipper.prototype.DeleteFromAEL=function(t){var e=t.PrevInAEL,i=t.NextInAEL;(null!==e||null!==i||t==this.m_ActiveEdges)&&(null!==e?e.NextInAEL=i:this.m_ActiveEdges=i,null!==i&&(i.PrevInAEL=e),t.NextInAEL=null,t.PrevInAEL=null)},ClipperLib.Clipper.prototype.DeleteFromSEL=function(t){var e=t.PrevInSEL,i=t.NextInSEL;(null!==e||null!==i||t==this.m_SortedEdges)&&(null!==e?e.NextInSEL=i:this.m_SortedEdges=i,null!==i&&(i.PrevInSEL=e),t.NextInSEL=null,t.PrevInSEL=null)},ClipperLib.Clipper.prototype.UpdateEdgeIntoAEL=function(t){null===t.NextInLML&&ClipperLib.Error("UpdateEdgeIntoAEL: invalid call");var e=t.PrevInAEL,i=t.NextInAEL;return t.NextInLML.OutIdx=t.OutIdx,null!==e?e.NextInAEL=t.NextInLML:this.m_ActiveEdges=t.NextInLML,null!==i&&(i.PrevInAEL=t.NextInLML),t.NextInLML.Side=t.Side,t.NextInLML.WindDelta=t.WindDelta,t.NextInLML.WindCnt=t.WindCnt,t.NextInLML.WindCnt2=t.WindCnt2,t=t.NextInLML,t.Curr.X=t.Bot.X,t.Curr.Y=t.Bot.Y,t.PrevInAEL=e,t.NextInAEL=i,ClipperLib.ClipperBase.IsHorizontal(t)||this.InsertScanbeam(t.Top.Y),t},ClipperLib.Clipper.prototype.ProcessHorizontals=function(t){for(var e=this.m_SortedEdges;null!==e;)this.DeleteFromSEL(e),this.ProcessHorizontal(e,t),e=this.m_SortedEdges},ClipperLib.Clipper.prototype.GetHorzDirection=function(t,e){t.Bot.X<t.Top.X?(e.Left=t.Bot.X,e.Right=t.Top.X,e.Dir=ClipperLib.Direction.dLeftToRight):(e.Left=t.Top.X,e.Right=t.Bot.X,e.Dir=ClipperLib.Direction.dRightToLeft)},ClipperLib.Clipper.prototype.PrepareHorzJoins=function(t,e){var i=this.m_PolyOuts[t.OutIdx].Pts;t.Side!=ClipperLib.EdgeSide.esLeft&&(i=i.Prev),e&&(ClipperLib.IntPoint.op_Equality(i.Pt,t.Top)?this.AddGhostJoin(i,t.Bot):this.AddGhostJoin(i,t.Top))},ClipperLib.Clipper.prototype.ProcessHorizontal=function(t,e){var i={Dir:null,Left:null,Right:null};this.GetHorzDirection(t,i);for(var r=i.Dir,n=i.Left,p=i.Right,o=t,l=null;null!==o.NextInLML&&ClipperLib.ClipperBase.IsHorizontal(o.NextInLML);)o=o.NextInLML;for(null===o.NextInLML&&(l=this.GetMaximaPair(o));;){for(var s=t==o,u=this.GetNextInAEL(t,r);null!==u&&!(u.Curr.X==t.Top.X&&null!==t.NextInLML&&u.Dx<t.NextInLML.Dx);){var h=this.GetNextInAEL(u,r);if(r==ClipperLib.Direction.dLeftToRight&&u.Curr.X<=p||r==ClipperLib.Direction.dRightToLeft&&u.Curr.X>=n){if(t.OutIdx>=0&&0!=t.WindDelta&&this.PrepareHorzJoins(t,e),u==l&&s)return r==ClipperLib.Direction.dLeftToRight?this.IntersectEdges(t,u,u.Top,!1):this.IntersectEdges(u,t,u.Top,!1),void(l.OutIdx>=0&&ClipperLib.Error("ProcessHorizontal error"));if(r==ClipperLib.Direction.dLeftToRight){var a=new ClipperLib.IntPoint(u.Curr.X,t.Curr.Y);this.IntersectEdges(t,u,a,!0)}else{var a=new ClipperLib.IntPoint(u.Curr.X,t.Curr.Y);this.IntersectEdges(u,t,a,!0)}this.SwapPositionsInAEL(t,u)}else if(r==ClipperLib.Direction.dLeftToRight&&u.Curr.X>=p||r==ClipperLib.Direction.dRightToLeft&&u.Curr.X<=n)break;u=h}if(t.OutIdx>=0&&0!==t.WindDelta&&this.PrepareHorzJoins(t,e),null===t.NextInLML||!ClipperLib.ClipperBase.IsHorizontal(t.NextInLML))break;t=this.UpdateEdgeIntoAEL(t),t.OutIdx>=0&&this.AddOutPt(t,t.Bot);var i={Dir:r,Left:n,Right:p};this.GetHorzDirection(t,i),r=i.Dir,n=i.Left,p=i.Right}if(null!==t.NextInLML)if(t.OutIdx>=0){var C=this.AddOutPt(t,t.Top);if(t=this.UpdateEdgeIntoAEL(t),0===t.WindDelta)return;var f=t.PrevInAEL,h=t.NextInAEL;if(null!==f&&f.Curr.X==t.Bot.X&&f.Curr.Y==t.Bot.Y&&0!==f.WindDelta&&f.OutIdx>=0&&f.Curr.Y>f.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(t,f,this.m_UseFullRange)){var d=this.AddOutPt(f,t.Bot);this.AddJoin(C,d,t.Top)}else if(null!==h&&h.Curr.X==t.Bot.X&&h.Curr.Y==t.Bot.Y&&0!==h.WindDelta&&h.OutIdx>=0&&h.Curr.Y>h.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(t,h,this.m_UseFullRange)){var d=this.AddOutPt(h,t.Bot);this.AddJoin(C,d,t.Top)}}else t=this.UpdateEdgeIntoAEL(t);else null!==l?l.OutIdx>=0?(r==ClipperLib.Direction.dLeftToRight?this.IntersectEdges(t,l,t.Top,!1):this.IntersectEdges(l,t,t.Top,!1),l.OutIdx>=0&&ClipperLib.Error("ProcessHorizontal error")):(this.DeleteFromAEL(t),this.DeleteFromAEL(l)):(t.OutIdx>=0&&this.AddOutPt(t,t.Top),this.DeleteFromAEL(t))},ClipperLib.Clipper.prototype.GetNextInAEL=function(t,e){return e==ClipperLib.Direction.dLeftToRight?t.NextInAEL:t.PrevInAEL},ClipperLib.Clipper.prototype.IsMinima=function(t){return null!==t&&t.Prev.NextInLML!=t&&t.Next.NextInLML!=t},ClipperLib.Clipper.prototype.IsMaxima=function(t,e){return null!==t&&t.Top.Y==e&&null===t.NextInLML},ClipperLib.Clipper.prototype.IsIntermediate=function(t,e){return t.Top.Y==e&&null!==t.NextInLML},ClipperLib.Clipper.prototype.GetMaximaPair=function(t){var e=null;return ClipperLib.IntPoint.op_Equality(t.Next.Top,t.Top)&&null===t.Next.NextInLML?e=t.Next:ClipperLib.IntPoint.op_Equality(t.Prev.Top,t.Top)&&null===t.Prev.NextInLML&&(e=t.Prev),null===e||-2!=e.OutIdx&&(e.NextInAEL!=e.PrevInAEL||ClipperLib.ClipperBase.IsHorizontal(e))?e:null},ClipperLib.Clipper.prototype.ProcessIntersections=function(t,e){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(t,e),0==this.m_IntersectList.length)return!0;if(1!=this.m_IntersectList.length&&!this.FixupIntersectionOrder())return!1;this.ProcessIntersectList()}catch(i){this.m_SortedEdges=null,this.m_IntersectList.length=0,ClipperLib.Error("ProcessIntersections error")}return this.m_SortedEdges=null,!0},ClipperLib.Clipper.prototype.BuildIntersectList=function(t,e){if(null!==this.m_ActiveEdges){var i=this.m_ActiveEdges;for(this.m_SortedEdges=i;null!==i;)i.PrevInSEL=i.PrevInAEL,i.NextInSEL=i.NextInAEL,i.Curr.X=ClipperLib.Clipper.TopX(i,e),i=i.NextInAEL;for(var r=!0;r&&null!==this.m_SortedEdges;){for(r=!1,i=this.m_SortedEdges;null!==i.NextInSEL;){var n=i.NextInSEL,p=new ClipperLib.IntPoint;if(i.Curr.X>n.Curr.X){!this.IntersectPoint(i,n,p)&&i.Curr.X>n.Curr.X+1&&ClipperLib.Error("Intersection error"),p.Y>t&&(p.Y=t,Math.abs(i.Dx)>Math.abs(n.Dx)?p.X=ClipperLib.Clipper.TopX(n,t):p.X=ClipperLib.Clipper.TopX(i,t));var o=new ClipperLib.IntersectNode;o.Edge1=i,o.Edge2=n,o.Pt.X=p.X,o.Pt.Y=p.Y,this.m_IntersectList.push(o),this.SwapPositionsInSEL(i,n),r=!0}else i=n}if(null===i.PrevInSEL)break;i.PrevInSEL.NextInSEL=null}this.m_SortedEdges=null}},ClipperLib.Clipper.prototype.EdgesAdjacent=function(t){return t.Edge1.NextInSEL==t.Edge2||t.Edge1.PrevInSEL==t.Edge2},ClipperLib.Clipper.IntersectNodeSort=function(t,e){return e.Pt.Y-t.Pt.Y},ClipperLib.Clipper.prototype.FixupIntersectionOrder=function(){this.m_IntersectList.sort(this.m_IntersectNodeComparer),this.CopyAELToSEL();for(var t=this.m_IntersectList.length,e=0;t>e;e++){if(!this.EdgesAdjacent(this.m_IntersectList[e])){for(var i=e+1;t>i&&!this.EdgesAdjacent(this.m_IntersectList[i]);)i++;if(i==t)return!1;var r=this.m_IntersectList[e];this.m_IntersectList[e]=this.m_IntersectList[i],this.m_IntersectList[i]=r}this.SwapPositionsInSEL(this.m_IntersectList[e].Edge1,this.m_IntersectList[e].Edge2)}return!0},ClipperLib.Clipper.prototype.ProcessIntersectList=function(){for(var t=0,e=this.m_IntersectList.length;e>t;t++){var i=this.m_IntersectList[t];this.IntersectEdges(i.Edge1,i.Edge2,i.Pt,!0),this.SwapPositionsInAEL(i.Edge1,i.Edge2)}this.m_IntersectList.length=0};var R1=function(t){return 0>t?Math.ceil(t-.5):Math.round(t)},R2=function(t){return 0>t?Math.ceil(t-.5):Math.floor(t+.5)},R3=function(t){return 0>t?-Math.round(Math.abs(t)):Math.round(t)},R4=function(t){return 0>t?(t-=.5,-2147483648>t?Math.ceil(t):0|t):(t+=.5,t>2147483647?Math.floor(t):0|t)};browser.msie?ClipperLib.Clipper.Round=R1:browser.chromium?ClipperLib.Clipper.Round=R3:browser.safari?ClipperLib.Clipper.Round=R4:ClipperLib.Clipper.Round=R2,ClipperLib.Clipper.TopX=function(t,e){return e==t.Top.Y?t.Top.X:t.Bot.X+ClipperLib.Clipper.Round(t.Dx*(e-t.Bot.Y))},ClipperLib.Clipper.prototype.IntersectPoint=function(t,e,i){i.X=0,i.Y=0;var r,n;if(ClipperLib.ClipperBase.SlopesEqual(t,e,this.m_UseFullRange)||t.Dx==e.Dx)return e.Bot.Y>t.Bot.Y?(i.X=e.Bot.X,i.Y=e.Bot.Y):(i.X=t.Bot.X,i.Y=t.Bot.Y),!1;if(0===t.Delta.X)i.X=t.Bot.X,ClipperLib.ClipperBase.IsHorizontal(e)?i.Y=e.Bot.Y:(n=e.Bot.Y-e.Bot.X/e.Dx,i.Y=ClipperLib.Clipper.Round(i.X/e.Dx+n));else if(0===e.Delta.X)i.X=e.Bot.X,ClipperLib.ClipperBase.IsHorizontal(t)?i.Y=t.Bot.Y:(r=t.Bot.Y-t.Bot.X/t.Dx,i.Y=ClipperLib.Clipper.Round(i.X/t.Dx+r));else{r=t.Bot.X-t.Bot.Y*t.Dx,n=e.Bot.X-e.Bot.Y*e.Dx;var p=(n-r)/(t.Dx-e.Dx);i.Y=ClipperLib.Clipper.Round(p),Math.abs(t.Dx)<Math.abs(e.Dx)?i.X=ClipperLib.Clipper.Round(t.Dx*p+r):i.X=ClipperLib.Clipper.Round(e.Dx*p+n)}if(i.Y<t.Top.Y||i.Y<e.Top.Y){if(t.Top.Y>e.Top.Y)return i.Y=t.Top.Y,i.X=ClipperLib.Clipper.TopX(e,t.Top.Y),i.X<t.Top.X;i.Y=e.Top.Y,Math.abs(t.Dx)<Math.abs(e.Dx)?i.X=ClipperLib.Clipper.TopX(t,i.Y):i.X=ClipperLib.Clipper.TopX(e,i.Y)}return!0},ClipperLib.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(t){for(var e=this.m_ActiveEdges;null!==e;){var i=this.IsMaxima(e,t);if(i){var r=this.GetMaximaPair(e);i=null===r||!ClipperLib.ClipperBase.IsHorizontal(r)}if(i){var n=e.PrevInAEL;this.DoMaxima(e),e=null===n?this.m_ActiveEdges:n.NextInAEL}else{if(this.IsIntermediate(e,t)&&ClipperLib.ClipperBase.IsHorizontal(e.NextInLML)?(e=this.UpdateEdgeIntoAEL(e),e.OutIdx>=0&&this.AddOutPt(e,e.Bot),this.AddEdgeToSEL(e)):(e.Curr.X=ClipperLib.Clipper.TopX(e,t),e.Curr.Y=t),this.StrictlySimple){var n=e.PrevInAEL;if(e.OutIdx>=0&&0!==e.WindDelta&&null!==n&&n.OutIdx>=0&&n.Curr.X==e.Curr.X&&0!==n.WindDelta){var p=this.AddOutPt(n,e.Curr),o=this.AddOutPt(e,e.Curr);this.AddJoin(p,o,e.Curr)}}e=e.NextInAEL}}for(this.ProcessHorizontals(!0),e=this.m_ActiveEdges;null!==e;){if(this.IsIntermediate(e,t)){var p=null;e.OutIdx>=0&&(p=this.AddOutPt(e,e.Top)),e=this.UpdateEdgeIntoAEL(e);var n=e.PrevInAEL,l=e.NextInAEL;if(null!==n&&n.Curr.X==e.Bot.X&&n.Curr.Y==e.Bot.Y&&null!==p&&n.OutIdx>=0&&n.Curr.Y>n.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(e,n,this.m_UseFullRange)&&0!==e.WindDelta&&0!==n.WindDelta){var o=this.AddOutPt(n,e.Bot);this.AddJoin(p,o,e.Top)}else if(null!==l&&l.Curr.X==e.Bot.X&&l.Curr.Y==e.Bot.Y&&null!==p&&l.OutIdx>=0&&l.Curr.Y>l.Top.Y&&ClipperLib.ClipperBase.SlopesEqual(e,l,this.m_UseFullRange)&&0!==e.WindDelta&&0!==l.WindDelta){var o=this.AddOutPt(l,e.Bot);this.AddJoin(p,o,e.Top)}}e=e.NextInAEL}},ClipperLib.Clipper.prototype.DoMaxima=function(t){var e=this.GetMaximaPair(t);if(null===e)return t.OutIdx>=0&&this.AddOutPt(t,t.Top),void this.DeleteFromAEL(t);for(var i=t.NextInAEL,r=!0;null!==i&&i!=e;)this.IntersectEdges(t,i,t.Top,!0),this.SwapPositionsInAEL(t,i),i=t.NextInAEL;-1==t.OutIdx&&-1==e.OutIdx?(this.DeleteFromAEL(t),this.DeleteFromAEL(e)):t.OutIdx>=0&&e.OutIdx>=0?this.IntersectEdges(t,e,t.Top,!1):r&&0===t.WindDelta?(t.OutIdx>=0&&(this.AddOutPt(t,t.Top),t.OutIdx=-1),this.DeleteFromAEL(t),e.OutIdx>=0&&(this.AddOutPt(e,t.Top),e.OutIdx=-1),this.DeleteFromAEL(e)):ClipperLib.Error("DoMaxima error")},ClipperLib.Clipper.ReversePaths=function(t){for(var e=0,i=t.length;i>e;e++)t[e].reverse()},ClipperLib.Clipper.Orientation=function(t){return ClipperLib.Clipper.Area(t)>=0},ClipperLib.Clipper.prototype.PointCount=function(t){if(null===t)return 0;var e=0,i=t;do e++,i=i.Next;while(i!=t);return e},ClipperLib.Clipper.prototype.BuildResult=function(t){ClipperLib.Clear(t);for(var e=0,i=this.m_PolyOuts.length;i>e;e++){var r=this.m_PolyOuts[e];if(null!==r.Pts){var n=r.Pts.Prev,p=this.PointCount(n);if(!(2>p)){for(var o=new Array(p),l=0;p>l;l++)o[l]=n.Pt,n=n.Prev;t.push(o)}}}},ClipperLib.Clipper.prototype.BuildResult2=function(t){t.Clear();for(var e=0,i=this.m_PolyOuts.length;i>e;e++){var r=this.m_PolyOuts[e],n=this.PointCount(r.Pts);if(!(r.IsOpen&&2>n||!r.IsOpen&&3>n)){this.FixHoleLinkage(r);var p=new ClipperLib.PolyNode;t.m_AllPolys.push(p),r.PolyNode=p,p.m_polygon.length=n;for(var o=r.Pts.Prev,l=0;n>l;l++)p.m_polygon[l]=o.Pt,o=o.Prev}}for(var e=0,i=this.m_PolyOuts.length;i>e;e++){var r=this.m_PolyOuts[e];null!==r.PolyNode&&(r.IsOpen?(r.PolyNode.IsOpen=!0,t.AddChild(r.PolyNode)):null!==r.FirstLeft&&null!=r.FirstLeft.PolyNode?r.FirstLeft.PolyNode.AddChild(r.PolyNode):t.AddChild(r.PolyNode))}},ClipperLib.Clipper.prototype.FixupOutPolygon=function(t){var e=null;t.BottomPt=null;for(var i=t.Pts;;){if(i.Prev==i||i.Prev==i.Next)return this.DisposeOutPts(i),void(t.Pts=null);if(ClipperLib.IntPoint.op_Equality(i.Pt,i.Next.Pt)||ClipperLib.IntPoint.op_Equality(i.Pt,i.Prev.Pt)||ClipperLib.ClipperBase.SlopesEqual(i.Prev.Pt,i.Pt,i.Next.Pt,this.m_UseFullRange)&&(!this.PreserveCollinear||!this.Pt2IsBetweenPt1AndPt3(i.Prev.Pt,i.Pt,i.Next.Pt))){e=null;var r=i;i.Prev.Next=i.Next,i.Next.Prev=i.Prev,i=i.Prev,r=null}else{if(i==e)break;null===e&&(e=i),i=i.Next}}t.Pts=i},ClipperLib.Clipper.prototype.DupOutPt=function(t,e){var i=new ClipperLib.OutPt;return i.Pt.X=t.Pt.X,i.Pt.Y=t.Pt.Y,i.Idx=t.Idx,e?(i.Next=t.Next,i.Prev=t,t.Next.Prev=i,t.Next=i):(i.Prev=t.Prev,i.Next=t,t.Prev.Next=i,t.Prev=i),i},ClipperLib.Clipper.prototype.GetOverlap=function(t,e,i,r,n){return e>t?r>i?(n.Left=Math.max(t,i),n.Right=Math.min(e,r)):(n.Left=Math.max(t,r),n.Right=Math.min(e,i)):r>i?(n.Left=Math.max(e,i),n.Right=Math.min(t,r)):(n.Left=Math.max(e,r),n.Right=Math.min(t,i)),n.Left<n.Right},ClipperLib.Clipper.prototype.JoinHorz=function(t,e,i,r,n,p){var o=t.Pt.X>e.Pt.X?ClipperLib.Direction.dRightToLeft:ClipperLib.Direction.dLeftToRight,l=i.Pt.X>r.Pt.X?ClipperLib.Direction.dRightToLeft:ClipperLib.Direction.dLeftToRight;if(o==l)return!1;if(o==ClipperLib.Direction.dLeftToRight){for(;t.Next.Pt.X<=n.X&&t.Next.Pt.X>=t.Pt.X&&t.Next.Pt.Y==n.Y;)t=t.Next;p&&t.Pt.X!=n.X&&(t=t.Next),e=this.DupOutPt(t,!p),ClipperLib.IntPoint.op_Inequality(e.Pt,n)&&(t=e,t.Pt.X=n.X,t.Pt.Y=n.Y,e=this.DupOutPt(t,!p))}else{for(;t.Next.Pt.X>=n.X&&t.Next.Pt.X<=t.Pt.X&&t.Next.Pt.Y==n.Y;)t=t.Next;p||t.Pt.X==n.X||(t=t.Next),e=this.DupOutPt(t,p),ClipperLib.IntPoint.op_Inequality(e.Pt,n)&&(t=e,t.Pt.X=n.X,t.Pt.Y=n.Y,e=this.DupOutPt(t,p))}if(l==ClipperLib.Direction.dLeftToRight){for(;i.Next.Pt.X<=n.X&&i.Next.Pt.X>=i.Pt.X&&i.Next.Pt.Y==n.Y;)i=i.Next;p&&i.Pt.X!=n.X&&(i=i.Next),r=this.DupOutPt(i,!p),ClipperLib.IntPoint.op_Inequality(r.Pt,n)&&(i=r,i.Pt.X=n.X,i.Pt.Y=n.Y,r=this.DupOutPt(i,!p))}else{for(;i.Next.Pt.X>=n.X&&i.Next.Pt.X<=i.Pt.X&&i.Next.Pt.Y==n.Y;)i=i.Next;p||i.Pt.X==n.X||(i=i.Next),r=this.DupOutPt(i,p),ClipperLib.IntPoint.op_Inequality(r.Pt,n)&&(i=r,i.Pt.X=n.X,i.Pt.Y=n.Y,r=this.DupOutPt(i,p))}return o==ClipperLib.Direction.dLeftToRight==p?(t.Prev=i,i.Next=t,e.Next=r,r.Prev=e):(t.Next=i,i.Prev=t,e.Prev=r,r.Next=e),!0},ClipperLib.Clipper.prototype.JoinPoints=function(t,e,i){var r=t.OutPt1,n=new ClipperLib.OutPt,p=t.OutPt2,o=new ClipperLib.OutPt,l=t.OutPt1.Pt.Y==t.OffPt.Y;if(l&&ClipperLib.IntPoint.op_Equality(t.OffPt,t.OutPt1.Pt)&&ClipperLib.IntPoint.op_Equality(t.OffPt,t.OutPt2.Pt)){for(n=t.OutPt1.Next;n!=r&&ClipperLib.IntPoint.op_Equality(n.Pt,t.OffPt);)n=n.Next;var s=n.Pt.Y>t.OffPt.Y;for(o=t.OutPt2.Next;o!=p&&ClipperLib.IntPoint.op_Equality(o.Pt,t.OffPt);)o=o.Next;var u=o.Pt.Y>t.OffPt.Y;return s==u?!1:s?(n=this.DupOutPt(r,!1),o=this.DupOutPt(p,!0),r.Prev=p,p.Next=r,n.Next=o,o.Prev=n,t.OutPt1=r,t.OutPt2=n,!0):(n=this.DupOutPt(r,!0),o=this.DupOutPt(p,!1),r.Next=p,p.Prev=r,n.Prev=o,o.Next=n,t.OutPt1=r,t.OutPt2=n,!0)}if(l){for(n=r;r.Prev.Pt.Y==r.Pt.Y&&r.Prev!=n&&r.Prev!=p;)r=r.Prev;for(;n.Next.Pt.Y==n.Pt.Y&&n.Next!=r&&n.Next!=p;)n=n.Next;if(n.Next==r||n.Next==p)return!1;for(o=p;p.Prev.Pt.Y==p.Pt.Y&&p.Prev!=o&&p.Prev!=n;)p=p.Prev;for(;o.Next.Pt.Y==o.Pt.Y&&o.Next!=p&&o.Next!=r;)o=o.Next;if(o.Next==p||o.Next==r)return!1;var h={Left:null,Right:null};if(!this.GetOverlap(r.Pt.X,n.Pt.X,p.Pt.X,o.Pt.X,h))return!1;var a,C=h.Left,f=h.Right,d=new ClipperLib.IntPoint;return r.Pt.X>=C&&r.Pt.X<=f?(d.X=r.Pt.X,d.Y=r.Pt.Y,a=r.Pt.X>n.Pt.X):p.Pt.X>=C&&p.Pt.X<=f?(d.X=p.Pt.X,d.Y=p.Pt.Y,a=p.Pt.X>o.Pt.X):n.Pt.X>=C&&n.Pt.X<=f?(d.X=n.Pt.X,d.Y=n.Pt.Y,a=n.Pt.X>r.Pt.X):(d.X=o.Pt.X,d.Y=o.Pt.Y,a=o.Pt.X>p.Pt.X),t.OutPt1=r,t.OutPt2=p,this.JoinHorz(r,n,p,o,d,a)}for(n=r.Next;ClipperLib.IntPoint.op_Equality(n.Pt,r.Pt)&&n!=r;)n=n.Next;var L=n.Pt.Y>r.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(r.Pt,n.Pt,t.OffPt,this.m_UseFullRange);if(L){for(n=r.Prev;ClipperLib.IntPoint.op_Equality(n.Pt,r.Pt)&&n!=r;)n=n.Prev;if(n.Pt.Y>r.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(r.Pt,n.Pt,t.OffPt,this.m_UseFullRange))return!1}for(o=p.Next;ClipperLib.IntPoint.op_Equality(o.Pt,p.Pt)&&o!=p;)o=o.Next;var P=o.Pt.Y>p.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(p.Pt,o.Pt,t.OffPt,this.m_UseFullRange);if(P){for(o=p.Prev;ClipperLib.IntPoint.op_Equality(o.Pt,p.Pt)&&o!=p;)o=o.Prev;if(o.Pt.Y>p.Pt.Y||!ClipperLib.ClipperBase.SlopesEqual(p.Pt,o.Pt,t.OffPt,this.m_UseFullRange))return!1}return n==r||o==p||n==o||e==i&&L==P?!1:L?(n=this.DupOutPt(r,!1),o=this.DupOutPt(p,!0),r.Prev=p,p.Next=r,n.Next=o,o.Prev=n,t.OutPt1=r,t.OutPt2=n,!0):(n=this.DupOutPt(r,!0),o=this.DupOutPt(p,!1),r.Next=p,p.Prev=r,n.Prev=o,o.Next=n,t.OutPt1=r,t.OutPt2=n,!0)},ClipperLib.Clipper.GetBounds=function(t){for(var e=0,i=t.length;i>e&&0==t[e].length;)e++;if(e==i)return new ClipperLib.IntRect(0,0,0,0);var r=new ClipperLib.IntRect;for(r.left=t[e][0].X,r.right=r.left,r.top=t[e][0].Y,r.bottom=r.top;i>e;e++)for(var n=0,p=t[e].length;p>n;n++)t[e][n].X<r.left?r.left=t[e][n].X:t[e][n].X>r.right&&(r.right=t[e][n].X),t[e][n].Y<r.top?r.top=t[e][n].Y:t[e][n].Y>r.bottom&&(r.bottom=t[e][n].Y);return r},ClipperLib.Clipper.prototype.GetBounds2=function(t){var e=t,i=new ClipperLib.IntRect;for(i.left=t.Pt.X,i.right=t.Pt.X,i.top=t.Pt.Y,i.bottom=t.Pt.Y,t=t.Next;t!=e;)t.Pt.X<i.left&&(i.left=t.Pt.X),t.Pt.X>i.right&&(i.right=t.Pt.X),t.Pt.Y<i.top&&(i.top=t.Pt.Y),t.Pt.Y>i.bottom&&(i.bottom=t.Pt.Y),t=t.Next;return i},ClipperLib.Clipper.PointInPolygon=function(t,e){var i=0,r=e.length;if(3>r)return 0;for(var n=e[0],p=1;r>=p;++p){var o=p==r?e[0]:e[p];if(o.Y==t.Y&&(o.X==t.X||n.Y==t.Y&&o.X>t.X==n.X<t.X))return-1;if(n.Y<t.Y!=o.Y<t.Y)if(n.X>=t.X)if(o.X>t.X)i=1-i;else{var l=(n.X-t.X)*(o.Y-t.Y)-(o.X-t.X)*(n.Y-t.Y);if(0==l)return-1;l>0==o.Y>n.Y&&(i=1-i)}else if(o.X>t.X){var l=(n.X-t.X)*(o.Y-t.Y)-(o.X-t.X)*(n.Y-t.Y);if(0==l)return-1;l>0==o.Y>n.Y&&(i=1-i)}n=o}return i},ClipperLib.Clipper.prototype.PointInPolygon=function(t,e){for(var i=0,r=e;;){var n=e.Pt.X,p=e.Pt.Y,o=e.Next.Pt.X,l=e.Next.Pt.Y;if(l==t.Y&&(o==t.X||p==t.Y&&o>t.X==n<t.X))return-1;if(p<t.Y!=l<t.Y)if(n>=t.X)if(o>t.X)i=1-i;else{var s=(n-t.X)*(l-t.Y)-(o-t.X)*(p-t.Y);if(0==s)return-1;s>0==l>p&&(i=1-i)}else if(o>t.X){var s=(n-t.X)*(l-t.Y)-(o-t.X)*(p-t.Y);if(0==s)return-1;s>0==l>p&&(i=1-i)}if(e=e.Next,r==e)break}return i},ClipperLib.Clipper.prototype.Poly2ContainsPoly1=function(t,e){var i=t;do{var r=this.PointInPolygon(i.Pt,e);if(r>=0)return 0!=r;i=i.Next}while(i!=t);return!0},ClipperLib.Clipper.prototype.FixupFirstLefts1=function(t,e){for(var i=0,r=this.m_PolyOuts.length;r>i;i++){var n=this.m_PolyOuts[i];null!==n.Pts&&n.FirstLeft==t&&this.Poly2ContainsPoly1(n.Pts,e.Pts)&&(n.FirstLeft=e)}},ClipperLib.Clipper.prototype.FixupFirstLefts2=function(t,e){for(var i=0,r=this.m_PolyOuts,n=r.length,p=r[i];n>i;i++,p=r[i])p.FirstLeft==t&&(p.FirstLeft=e)},ClipperLib.Clipper.ParseFirstLeft=function(t){for(;null!=t&&null==t.Pts;)t=t.FirstLeft;return t},ClipperLib.Clipper.prototype.JoinCommonEdges=function(){for(var t=0,e=this.m_Joins.length;e>t;t++){var i=this.m_Joins[t],r=this.GetOutRec(i.OutPt1.Idx),n=this.GetOutRec(i.OutPt2.Idx);if(null!=r.Pts&&null!=n.Pts){var p;if(p=r==n?r:this.Param1RightOfParam2(r,n)?n:this.Param1RightOfParam2(n,r)?r:this.GetLowermostRec(r,n),this.JoinPoints(i,r,n))if(r==n){if(r.Pts=i.OutPt1,r.BottomPt=null,n=this.CreateOutRec(),n.Pts=i.OutPt2,this.UpdateOutPtIdxs(n),this.m_UsingPolyTree)for(var o=0,l=this.m_PolyOuts.length;l-1>o;o++){var s=this.m_PolyOuts[o];null!=s.Pts&&ClipperLib.Clipper.ParseFirstLeft(s.FirstLeft)==r&&s.IsHole!=r.IsHole&&this.Poly2ContainsPoly1(s.Pts,i.OutPt2)&&(s.FirstLeft=n)}this.Poly2ContainsPoly1(n.Pts,r.Pts)?(n.IsHole=!r.IsHole,n.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(n,r),(n.IsHole^this.ReverseSolution)==this.Area(n)>0&&this.ReversePolyPtLinks(n.Pts)):this.Poly2ContainsPoly1(r.Pts,n.Pts)?(n.IsHole=r.IsHole,r.IsHole=!n.IsHole,n.FirstLeft=r.FirstLeft,r.FirstLeft=n,this.m_UsingPolyTree&&this.FixupFirstLefts2(r,n),(r.IsHole^this.ReverseSolution)==this.Area(r)>0&&this.ReversePolyPtLinks(r.Pts)):(n.IsHole=r.IsHole,n.FirstLeft=r.FirstLeft,this.m_UsingPolyTree&&this.FixupFirstLefts1(r,n))}else n.Pts=null,n.BottomPt=null,n.Idx=r.Idx,r.IsHole=p.IsHole,p==n&&(r.FirstLeft=n.FirstLeft),n.FirstLeft=r,this.m_UsingPolyTree&&this.FixupFirstLefts2(n,r)}}},ClipperLib.Clipper.prototype.UpdateOutPtIdxs=function(t){var e=t.Pts;do e.Idx=t.Idx,e=e.Prev;while(e!=t.Pts)},ClipperLib.Clipper.prototype.DoSimplePolygons=function(){for(var t=0;t<this.m_PolyOuts.length;){var e=this.m_PolyOuts[t++],i=e.Pts;if(null!==i)do{for(var r=i.Next;r!=e.Pts;){if(ClipperLib.IntPoint.op_Equality(i.Pt,r.Pt)&&r.Next!=i&&r.Prev!=i){var n=i.Prev,p=r.Prev;i.Prev=p,p.Next=i,r.Prev=n,n.Next=r,e.Pts=i;var o=this.CreateOutRec();o.Pts=r,this.UpdateOutPtIdxs(o),this.Poly2ContainsPoly1(o.Pts,e.Pts)?(o.IsHole=!e.IsHole,o.FirstLeft=e):this.Poly2ContainsPoly1(e.Pts,o.Pts)?(o.IsHole=e.IsHole,e.IsHole=!o.IsHole,o.FirstLeft=e.FirstLeft,e.FirstLeft=o):(o.IsHole=e.IsHole,o.FirstLeft=e.FirstLeft),r=i}r=r.Next}i=i.Next}while(i!=e.Pts)}},ClipperLib.Clipper.Area=function(t){var e=t.length;if(3>e)return 0;for(var i=0,r=0,n=e-1;e>r;++r)i+=(t[n].X+t[r].X)*(t[n].Y-t[r].Y),n=r;return.5*-i},ClipperLib.Clipper.prototype.Area=function(t){var e=t.Pts;if(null==e)return 0;var i=0;do i+=(e.Prev.Pt.X+e.Pt.X)*(e.Prev.Pt.Y-e.Pt.Y),e=e.Next;while(e!=t.Pts);return.5*i},use_deprecated&&(ClipperLib.Clipper.OffsetPaths=function(t,e,i,r,n){var p=new ClipperLib.Paths,o=new ClipperLib.ClipperOffset(n,n);return o.AddPaths(t,i,r),o.Execute(p,e),p}),ClipperLib.Clipper.SimplifyPolygon=function(t,e){var i=new Array,r=new ClipperLib.Clipper(0);return r.StrictlySimple=!0,r.AddPath(t,ClipperLib.PolyType.ptSubject,!0),r.Execute(ClipperLib.ClipType.ctUnion,i,e,e),i},ClipperLib.Clipper.SimplifyPolygons=function(t,e){"undefined"==typeof e&&(e=ClipperLib.PolyFillType.pftEvenOdd);var i=new Array,r=new ClipperLib.Clipper(0);return r.StrictlySimple=!0,r.AddPaths(t,ClipperLib.PolyType.ptSubject,!0),r.Execute(ClipperLib.ClipType.ctUnion,i,e,e),i},ClipperLib.Clipper.DistanceSqrd=function(t,e){var i=t.X-e.X,r=t.Y-e.Y;return i*i+r*r},ClipperLib.Clipper.DistanceFromLineSqrd=function(t,e,i){var r=e.Y-i.Y,n=i.X-e.X,p=r*e.X+n*e.Y;return p=r*t.X+n*t.Y-p,p*p/(r*r+n*n)},ClipperLib.Clipper.SlopesNearCollinear=function(t,e,i,r){return ClipperLib.Clipper.DistanceFromLineSqrd(e,t,i)<r},ClipperLib.Clipper.PointsAreClose=function(t,e,i){var r=t.X-e.X,n=t.Y-e.Y;return i>=r*r+n*n},ClipperLib.Clipper.ExcludeOp=function(t){var e=t.Prev;return e.Next=t.Next,t.Next.Prev=e,e.Idx=0,e},ClipperLib.Clipper.CleanPolygon=function(t,e){"undefined"==typeof e&&(e=1.415);var i=t.length;if(0==i)return new Array;for(var r=new Array(i),n=0;i>n;++n)r[n]=new ClipperLib.OutPt;for(var n=0;i>n;++n)r[n].Pt=t[n],r[n].Next=r[(n+1)%i],r[n].Next.Prev=r[n],r[n].Idx=0;for(var p=e*e,o=r[0];0==o.Idx&&o.Next!=o.Prev;)ClipperLib.Clipper.PointsAreClose(o.Pt,o.Prev.Pt,p)?(o=ClipperLib.Clipper.ExcludeOp(o),i--):ClipperLib.Clipper.PointsAreClose(o.Prev.Pt,o.Next.Pt,p)?(ClipperLib.Clipper.ExcludeOp(o.Next),o=ClipperLib.Clipper.ExcludeOp(o),i-=2):ClipperLib.Clipper.SlopesNearCollinear(o.Prev.Pt,o.Pt,o.Next.Pt,p)?(o=ClipperLib.Clipper.ExcludeOp(o),i--):(o.Idx=1,o=o.Next);3>i&&(i=0);for(var l=new Array(i),n=0;i>n;++n)l[n]=new ClipperLib.IntPoint(o.Pt),o=o.Next;return r=null,l},ClipperLib.Clipper.CleanPolygons=function(t,e){for(var i=new Array(t.length),r=0,n=t.length;n>r;r++)i[r]=ClipperLib.Clipper.CleanPolygon(t[r],e);return i},ClipperLib.Clipper.Minkowski=function(t,e,i,r){var n=r?1:0,p=t.length,o=e.length,l=new Array;if(i)for(var s=0;o>s;s++){for(var u=new Array(p),h=0,a=t.length,C=t[h];a>h;h++,C=t[h])u[h]=new ClipperLib.IntPoint(e[s].X+C.X,e[s].Y+C.Y);l.push(u)}else for(var s=0;o>s;s++){for(var u=new Array(p),h=0,a=t.length,C=t[h];a>h;h++,C=t[h])u[h]=new ClipperLib.IntPoint(e[s].X-C.X,e[s].Y-C.Y);l.push(u)}for(var f=new Array,s=0;o-1+n>s;s++)for(var h=0;p>h;h++){var d=new Array;d.push(l[s%o][h%p]),d.push(l[(s+1)%o][h%p]),d.push(l[(s+1)%o][(h+1)%p]),d.push(l[s%o][(h+1)%p]),ClipperLib.Clipper.Orientation(d)||d.reverse(),f.push(d)}var L=new ClipperLib.Clipper(0);return L.AddPaths(f,ClipperLib.PolyType.ptSubject,!0),L.Execute(ClipperLib.ClipType.ctUnion,l,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),l},ClipperLib.Clipper.MinkowskiSum=function(){var t=arguments,e=t.length;if(3==e){var i=t[0],r=t[1],n=t[2];return ClipperLib.Clipper.Minkowski(i,r,!0,n)}if(4==e){for(var p,i=t[0],o=t[1],l=t[2],n=t[3],s=new ClipperLib.Clipper,u=0,h=o.length;h>u;++u){var p=ClipperLib.Clipper.Minkowski(i,o[u],!0,n);s.AddPaths(p,ClipperLib.PolyType.ptSubject,!0)}n&&s.AddPaths(o,ClipperLib.PolyType.ptClip,!0);var a=new ClipperLib.Paths;return s.Execute(ClipperLib.ClipType.ctUnion,a,l,l),a}},ClipperLib.Clipper.MinkowskiDiff=function(t,e,i){return ClipperLib.Clipper.Minkowski(t,e,!1,i)},ClipperLib.Clipper.PolyTreeToPaths=function(t){var e=new Array;return ClipperLib.Clipper.AddPolyNodeToPaths(t,ClipperLib.Clipper.NodeType.ntAny,e),e},ClipperLib.Clipper.AddPolyNodeToPaths=function(t,e,i){var r=!0;switch(e){case ClipperLib.Clipper.NodeType.ntOpen:return;case ClipperLib.Clipper.NodeType.ntClosed:r=!t.IsOpen}t.m_polygon.length>0&&r&&i.push(t.m_polygon);for(var n=0,p=t.Childs(),o=p.length,l=p[n];o>n;n++,l=p[n])ClipperLib.Clipper.AddPolyNodeToPaths(l,e,i)},ClipperLib.Clipper.OpenPathsFromPolyTree=function(t){for(var e=new ClipperLib.Paths,i=0,r=t.ChildCount();r>i;i++)t.Childs()[i].IsOpen&&e.push(t.Childs()[i].m_polygon);return e},ClipperLib.Clipper.ClosedPathsFromPolyTree=function(t){var e=new ClipperLib.Paths;return ClipperLib.Clipper.AddPolyNodeToPaths(t,ClipperLib.Clipper.NodeType.ntClosed,e),e},Inherit(ClipperLib.Clipper,ClipperLib.ClipperBase),ClipperLib.Clipper.NodeType={ntAny:0,ntOpen:1,ntClosed:2},ClipperLib.ClipperOffset=function(t,e){"undefined"==typeof t&&(t=2),"undefined"==typeof e&&(e=ClipperLib.ClipperOffset.def_arc_tolerance),this.m_destPolys=new ClipperLib.Paths,this.m_srcPoly=new ClipperLib.Path,this.m_destPoly=new ClipperLib.Path,this.m_normals=new Array,this.m_delta=0,this.m_sinA=0,this.m_sin=0,this.m_cos=0,this.m_miterLim=0,this.m_StepsPerRad=0,this.m_lowest=new ClipperLib.IntPoint,this.m_polyNodes=new ClipperLib.PolyNode,this.MiterLimit=t,this.ArcTolerance=e,this.m_lowest.X=-1},ClipperLib.ClipperOffset.two_pi=6.28318530717959,ClipperLib.ClipperOffset.def_arc_tolerance=.25,ClipperLib.ClipperOffset.prototype.Clear=function(){ClipperLib.Clear(this.m_polyNodes.Childs()),this.m_lowest.X=-1},ClipperLib.ClipperOffset.Round=ClipperLib.Clipper.Round,ClipperLib.ClipperOffset.prototype.AddPath=function(t,e,i){var r=t.length-1;if(!(0>r)){var n=new ClipperLib.PolyNode;if(n.m_jointype=e,n.m_endtype=i,i==ClipperLib.EndType.etClosedLine||i==ClipperLib.EndType.etClosedPolygon)for(;r>0&&ClipperLib.IntPoint.op_Equality(t[0],t[r]);)r--;n.m_polygon.push(t[0]);for(var p=0,o=0,l=1;r>=l;l++)ClipperLib.IntPoint.op_Inequality(n.m_polygon[p],t[l])&&(p++,n.m_polygon.push(t[l]),(t[l].Y>n.m_polygon[o].Y||t[l].Y==n.m_polygon[o].Y&&t[l].X<n.m_polygon[o].X)&&(o=p));if(!(i==ClipperLib.EndType.etClosedPolygon&&2>p||i!=ClipperLib.EndType.etClosedPolygon&&0>p)&&(this.m_polyNodes.AddChild(n),i==ClipperLib.EndType.etClosedPolygon))if(this.m_lowest.X<0)this.m_lowest=new ClipperLib.IntPoint(0,o);else{var s=this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon[this.m_lowest.Y];(n.m_polygon[o].Y>s.Y||n.m_polygon[o].Y==s.Y&&n.m_polygon[o].X<s.X)&&(this.m_lowest=new ClipperLib.IntPoint(this.m_polyNodes.ChildCount()-1,o))}}},ClipperLib.ClipperOffset.prototype.AddPaths=function(t,e,i){for(var r=0,n=t.length;n>r;r++)this.AddPath(t[r],e,i)},ClipperLib.ClipperOffset.prototype.FixOrientations=function(){if(this.m_lowest.X>=0&&!ClipperLib.Clipper.Orientation(this.m_polyNodes.Childs()[this.m_lowest.X].m_polygon))for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];(e.m_endtype==ClipperLib.EndType.etClosedPolygon||e.m_endtype==ClipperLib.EndType.etClosedLine&&ClipperLib.Clipper.Orientation(e.m_polygon))&&e.m_polygon.reverse()}else for(var t=0;t<this.m_polyNodes.ChildCount();t++){var e=this.m_polyNodes.Childs()[t];e.m_endtype!=ClipperLib.EndType.etClosedLine||ClipperLib.Clipper.Orientation(e.m_polygon)||e.m_polygon.reverse()}},ClipperLib.ClipperOffset.GetUnitNormal=function(t,e){var i=e.X-t.X,r=e.Y-t.Y;if(0==i&&0==r)return new ClipperLib.DoublePoint(0,0);var n=1/Math.sqrt(i*i+r*r);return i*=n,r*=n,new ClipperLib.DoublePoint(r,-i)},ClipperLib.ClipperOffset.prototype.DoOffset=function(t){if(this.m_destPolys=new Array,this.m_delta=t,ClipperLib.ClipperBase.near_zero(t))for(var e=0;e<this.m_polyNodes.ChildCount();e++){var i=this.m_polyNodes.Childs()[e];i.m_endtype==ClipperLib.EndType.etClosedPolygon&&this.m_destPolys.push(i.m_polygon)}else{this.MiterLimit>2?this.m_miterLim=2/(this.MiterLimit*this.MiterLimit):this.m_miterLim=.5;var r;r=this.ArcTolerance<=0?ClipperLib.ClipperOffset.def_arc_tolerance:this.ArcTolerance>Math.abs(t)*ClipperLib.ClipperOffset.def_arc_tolerance?Math.abs(t)*ClipperLib.ClipperOffset.def_arc_tolerance:this.ArcTolerance;var n=3.14159265358979/Math.acos(1-r/Math.abs(t));this.m_sin=Math.sin(ClipperLib.ClipperOffset.two_pi/n),this.m_cos=Math.cos(ClipperLib.ClipperOffset.two_pi/n),this.m_StepsPerRad=n/ClipperLib.ClipperOffset.two_pi,0>t&&(this.m_sin=-this.m_sin);for(var e=0;e<this.m_polyNodes.ChildCount();e++){var i=this.m_polyNodes.Childs()[e];this.m_srcPoly=i.m_polygon;var p=this.m_srcPoly.length;if(!(0==p||0>=t&&(3>p||i.m_endtype!=ClipperLib.EndType.etClosedPolygon)))if(this.m_destPoly=new Array,1!=p){this.m_normals.length=0;for(var o=0;p-1>o;o++)this.m_normals.push(ClipperLib.ClipperOffset.GetUnitNormal(this.m_srcPoly[o],this.m_srcPoly[o+1]));if(i.m_endtype==ClipperLib.EndType.etClosedLine||i.m_endtype==ClipperLib.EndType.etClosedPolygon?this.m_normals.push(ClipperLib.ClipperOffset.GetUnitNormal(this.m_srcPoly[p-1],this.m_srcPoly[0])):this.m_normals.push(new ClipperLib.DoublePoint(this.m_normals[p-2])),i.m_endtype==ClipperLib.EndType.etClosedPolygon){for(var l=p-1,o=0;p>o;o++)l=this.OffsetPoint(o,l,i.m_jointype);this.m_destPolys.push(this.m_destPoly)}else if(i.m_endtype==ClipperLib.EndType.etClosedLine){for(var l=p-1,o=0;p>o;o++)l=this.OffsetPoint(o,l,i.m_jointype);this.m_destPolys.push(this.m_destPoly),this.m_destPoly=new Array;for(var s=this.m_normals[p-1],o=p-1;o>0;o--)this.m_normals[o]=new ClipperLib.DoublePoint(-this.m_normals[o-1].X,-this.m_normals[o-1].Y);this.m_normals[0]=new ClipperLib.DoublePoint(-s.X,-s.Y),l=0;for(var o=p-1;o>=0;o--)l=this.OffsetPoint(o,l,i.m_jointype);this.m_destPolys.push(this.m_destPoly)}else{for(var l=0,o=1;p-1>o;++o)l=this.OffsetPoint(o,l,i.m_jointype);var u;if(i.m_endtype==ClipperLib.EndType.etOpenButt){var o=p-1;u=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[o].X+this.m_normals[o].X*t),ClipperLib.ClipperOffset.Round(this.m_srcPoly[o].Y+this.m_normals[o].Y*t)),this.m_destPoly.push(u),u=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[o].X-this.m_normals[o].X*t),ClipperLib.ClipperOffset.Round(this.m_srcPoly[o].Y-this.m_normals[o].Y*t)),this.m_destPoly.push(u)}else{var o=p-1;l=p-2,this.m_sinA=0,this.m_normals[o]=new ClipperLib.DoublePoint(-this.m_normals[o].X,-this.m_normals[o].Y),i.m_endtype==ClipperLib.EndType.etOpenSquare?this.DoSquare(o,l):this.DoRound(o,l)}for(var o=p-1;o>0;o--)this.m_normals[o]=new ClipperLib.DoublePoint(-this.m_normals[o-1].X,-this.m_normals[o-1].Y);this.m_normals[0]=new ClipperLib.DoublePoint(-this.m_normals[1].X,-this.m_normals[1].Y),l=p-1;for(var o=l-1;o>0;--o)l=this.OffsetPoint(o,l,i.m_jointype);i.m_endtype==ClipperLib.EndType.etOpenButt?(u=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X-this.m_normals[0].X*t),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y-this.m_normals[0].Y*t)),this.m_destPoly.push(u),u=new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X+this.m_normals[0].X*t),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y+this.m_normals[0].Y*t)),
this.m_destPoly.push(u)):(l=1,this.m_sinA=0,i.m_endtype==ClipperLib.EndType.etOpenSquare?this.DoSquare(0,1):this.DoRound(0,1)),this.m_destPolys.push(this.m_destPoly)}}else{if(i.m_jointype==ClipperLib.JoinType.jtRound)for(var h=1,a=0,o=1;n>=o;o++){this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X+h*t),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y+a*t)));var C=h;h=h*this.m_cos-this.m_sin*a,a=C*this.m_sin+a*this.m_cos}else for(var h=-1,a=-1,o=0;4>o;++o)this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].X+h*t),ClipperLib.ClipperOffset.Round(this.m_srcPoly[0].Y+a*t))),0>h?h=1:0>a?a=1:h=-1;this.m_destPolys.push(this.m_destPoly)}}}},ClipperLib.ClipperOffset.prototype.Execute=function(){var t=arguments,e=t[0]instanceof ClipperLib.PolyTree;if(e){var i=t[0],r=t[1];i.Clear(),this.FixOrientations(),this.DoOffset(r);var n=new ClipperLib.Clipper(0);if(n.AddPaths(this.m_destPolys,ClipperLib.PolyType.ptSubject,!0),r>0)n.Execute(ClipperLib.ClipType.ctUnion,i,ClipperLib.PolyFillType.pftPositive,ClipperLib.PolyFillType.pftPositive);else{var p=ClipperLib.Clipper.GetBounds(this.m_destPolys),o=new ClipperLib.Path;if(o.push(new ClipperLib.IntPoint(p.left-10,p.bottom+10)),o.push(new ClipperLib.IntPoint(p.right+10,p.bottom+10)),o.push(new ClipperLib.IntPoint(p.right+10,p.top-10)),o.push(new ClipperLib.IntPoint(p.left-10,p.top-10)),n.AddPath(o,ClipperLib.PolyType.ptSubject,!0),n.ReverseSolution=!0,n.Execute(ClipperLib.ClipType.ctUnion,i,ClipperLib.PolyFillType.pftNegative,ClipperLib.PolyFillType.pftNegative),1==i.ChildCount()&&i.Childs()[0].ChildCount()>0){var l=i.Childs()[0];i.Childs()[0]=l.Childs()[0];for(var s=1;s<l.ChildCount();s++)i.AddChild(l.Childs()[s])}else i.Clear()}}else{var i=t[0],r=t[1];ClipperLib.Clear(i),this.FixOrientations(),this.DoOffset(r);var n=new ClipperLib.Clipper(0);if(n.AddPaths(this.m_destPolys,ClipperLib.PolyType.ptSubject,!0),r>0)n.Execute(ClipperLib.ClipType.ctUnion,i,ClipperLib.PolyFillType.pftPositive,ClipperLib.PolyFillType.pftPositive);else{var p=ClipperLib.Clipper.GetBounds(this.m_destPolys),o=new ClipperLib.Path;o.push(new ClipperLib.IntPoint(p.left-10,p.bottom+10)),o.push(new ClipperLib.IntPoint(p.right+10,p.bottom+10)),o.push(new ClipperLib.IntPoint(p.right+10,p.top-10)),o.push(new ClipperLib.IntPoint(p.left-10,p.top-10)),n.AddPath(o,ClipperLib.PolyType.ptSubject,!0),n.ReverseSolution=!0,n.Execute(ClipperLib.ClipType.ctUnion,i,ClipperLib.PolyFillType.pftNegative,ClipperLib.PolyFillType.pftNegative),i.length>0&&i.splice(0,1)}}},ClipperLib.ClipperOffset.prototype.OffsetPoint=function(t,e,i){if(this.m_sinA=this.m_normals[e].X*this.m_normals[t].Y-this.m_normals[t].X*this.m_normals[e].Y,this.m_sinA<5e-5&&this.m_sinA>-5e-5)return e;if(this.m_sinA>1?this.m_sinA=1:this.m_sinA<-1&&(this.m_sinA=-1),this.m_sinA*this.m_delta<0)this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[e].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[e].Y*this.m_delta))),this.m_destPoly.push(new ClipperLib.IntPoint(this.m_srcPoly[t])),this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)));else switch(i){case ClipperLib.JoinType.jtMiter:var r=1+(this.m_normals[t].X*this.m_normals[e].X+this.m_normals[t].Y*this.m_normals[e].Y);r>=this.m_miterLim?this.DoMiter(t,e,r):this.DoSquare(t,e);break;case ClipperLib.JoinType.jtSquare:this.DoSquare(t,e);break;case ClipperLib.JoinType.jtRound:this.DoRound(t,e)}return e=t},ClipperLib.ClipperOffset.prototype.DoSquare=function(t,e){var i=Math.tan(Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y)/4);this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[e].X-this.m_normals[e].Y*i)),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[e].Y+this.m_normals[e].X*i)))),this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_delta*(this.m_normals[t].X+this.m_normals[t].Y*i)),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_delta*(this.m_normals[t].Y-this.m_normals[t].X*i))))},ClipperLib.ClipperOffset.prototype.DoMiter=function(t,e,i){var r=this.m_delta/i;this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+(this.m_normals[e].X+this.m_normals[t].X)*r),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+(this.m_normals[e].Y+this.m_normals[t].Y)*r)))},ClipperLib.ClipperOffset.prototype.DoRound=function(t,e){for(var i,r=Math.atan2(this.m_sinA,this.m_normals[e].X*this.m_normals[t].X+this.m_normals[e].Y*this.m_normals[t].Y),n=ClipperLib.Cast_Int32(ClipperLib.ClipperOffset.Round(this.m_StepsPerRad*Math.abs(r))),p=this.m_normals[e].X,o=this.m_normals[e].Y,l=0;n>l;++l)this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+p*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+o*this.m_delta))),i=p,p=p*this.m_cos-this.m_sin*o,o=i*this.m_sin+o*this.m_cos;this.m_destPoly.push(new ClipperLib.IntPoint(ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].X+this.m_normals[t].X*this.m_delta),ClipperLib.ClipperOffset.Round(this.m_srcPoly[t].Y+this.m_normals[t].Y*this.m_delta)))},ClipperLib.Error=function(t){try{throw new Error(t)}catch(e){alert(e.message)}},ClipperLib.JS={},ClipperLib.JS.AreaOfPolygon=function(t,e){return e||(e=1),ClipperLib.Clipper.Area(t)/(e*e)},ClipperLib.JS.AreaOfPolygons=function(t,e){e||(e=1);for(var i=0,r=0;r<t.length;r++)i+=ClipperLib.Clipper.Area(t[r]);return i/(e*e)},ClipperLib.JS.BoundsOfPath=function(t,e){return ClipperLib.JS.BoundsOfPaths([t],e)},ClipperLib.JS.BoundsOfPaths=function(t,e){e||(e=1);var i=ClipperLib.Clipper.GetBounds(t);return i.left/=e,i.bottom/=e,i.right/=e,i.top/=e,i},ClipperLib.JS.Clean=function(t,e){if(!(t instanceof Array))return[];var i=t[0]instanceof Array,t=ClipperLib.JS.Clone(t);if("number"!=typeof e||null===e)return ClipperLib.Error("Delta is not a number in Clean()."),t;if(0===t.length||1==t.length&&0===t[0].length||0>e)return t;i||(t=[t]);for(var r,n,p,o,l,s,u,h=t.length,a=[],C=0;h>C;C++)if(n=t[C],r=n.length,0!==r)if(3>r)p=n,a.push(p);else{for(p=n,o=e*e,l=n[0],s=1,u=1;r>u;u++)(n[u].X-l.X)*(n[u].X-l.X)+(n[u].Y-l.Y)*(n[u].Y-l.Y)<=o||(p[s]=n[u],l=n[u],s++);l=n[s-1],(n[0].X-l.X)*(n[0].X-l.X)+(n[0].Y-l.Y)*(n[0].Y-l.Y)<=o&&s--,r>s&&p.splice(s,r-s),p.length&&a.push(p)}return!i&&a.length?a=a[0]:i||0!==a.length?i&&0===a.length&&(a=[[]]):a=[],a},ClipperLib.JS.Clone=function(t){if(!(t instanceof Array))return[];if(0===t.length)return[];if(1==t.length&&0===t[0].length)return[[]];var e=t[0]instanceof Array;e||(t=[t]);var i,r,n,p,o=t.length,l=new Array(o);for(r=0;o>r;r++){for(i=t[r].length,p=new Array(i),n=0;i>n;n++)p[n]={X:t[r][n].X,Y:t[r][n].Y};l[r]=p}return e||(l=l[0]),l},ClipperLib.JS.Lighten=function(t,e){if(!(t instanceof Array))return[];if("number"!=typeof e||null===e)return ClipperLib.Error("Tolerance is not a number in Lighten()."),ClipperLib.JS.Clone(t);if(0===t.length||1==t.length&&0===t[0].length||0>e)return ClipperLib.JS.Clone(t);t[0]instanceof Array||(t=[t]);var i,r,n,p,o,l,s,u,h,a,C,f,d,L,P,b,m,y=t.length,c=e*e,v=[];for(i=0;y>i;i++)if(n=t[i],l=n.length,0!=l){for(p=0;1e6>p;p++){for(o=[],l=n.length,n[l-1].X!=n[0].X||n[l-1].Y!=n[0].Y?(f=1,n.push({X:n[0].X,Y:n[0].Y}),l=n.length):f=0,C=[],r=0;l-2>r;r++)s=n[r],h=n[r+1],u=n[r+2],b=s.X,m=s.Y,d=u.X-b,L=u.Y-m,(0!==d||0!==L)&&(P=((h.X-b)*d+(h.Y-m)*L)/(d*d+L*L),P>1?(b=u.X,m=u.Y):P>0&&(b+=d*P,m+=L*P)),d=h.X-b,L=h.Y-m,a=d*d+L*L,c>=a&&(C[r+1]=1,r++);for(o.push({X:n[0].X,Y:n[0].Y}),r=1;l-1>r;r++)C[r]||o.push({X:n[r].X,Y:n[r].Y});if(o.push({X:n[l-1].X,Y:n[l-1].Y}),f&&n.pop(),!C.length)break;n=o}l=o.length,o[l-1].X==o[0].X&&o[l-1].Y==o[0].Y&&o.pop(),o.length>2&&v.push(o)}return!t[0]instanceof Array&&(v=v[0]),"undefined"==typeof v&&(v=[[]]),v},ClipperLib.JS.PerimeterOfPath=function(t,e,i){if("undefined"==typeof t)return 0;var r,n,p=Math.sqrt,o=0,l=0,s=0,u=0,h=0,a=t.length;if(2>a)return 0;for(e&&(t[a]=t[0],a++);--a;)r=t[a],l=r.X,s=r.Y,n=t[a-1],u=n.X,h=n.Y,o+=p((l-u)*(l-u)+(s-h)*(s-h));return e&&t.pop(),o/i},ClipperLib.JS.PerimeterOfPaths=function(t,e,i){i||(i=1);for(var r=0,n=0;n<t.length;n++)r+=ClipperLib.JS.PerimeterOfPath(t[n],e,i);return r},ClipperLib.JS.ScaleDownPath=function(t,e){var i,r;for(e||(e=1),i=t.length;i--;)r=t[i],r.X=r.X/e,r.Y=r.Y/e},ClipperLib.JS.ScaleDownPaths=function(t,e){var i,r,n;Math.round;for(e||(e=1),i=t.length;i--;)for(r=t[i].length;r--;)n=t[i][r],n.X=n.X/e,n.Y=n.Y/e},ClipperLib.JS.ScaleUpPath=function(t,e){var i,r,n=Math.round;for(e||(e=1),i=t.length;i--;)r=t[i],r.X=n(r.X*e),r.Y=n(r.Y*e)},ClipperLib.JS.ScaleUpPaths=function(t,e){var i,r,n,p=Math.round;for(e||(e=1),i=t.length;i--;)for(r=t[i].length;r--;)n=t[i][r],n.X=p(n.X*e),n.Y=p(n.Y*e)},ClipperLib.ExPolygons=function(){return[]},ClipperLib.ExPolygon=function(){this.outer=null,this.holes=null},ClipperLib.JS.AddOuterPolyNodeToExPolygons=function(t,e){var i=new ClipperLib.ExPolygon;i.outer=t.Contour();var r=t.Childs(),n=r.length;i.holes=new Array(n);var p,o,l,s,u,h;for(l=0;n>l;l++)for(p=r[l],i.holes[l]=p.Contour(),s=0,u=p.Childs(),h=u.length;h>s;s++)o=u[s],ClipperLib.JS.AddOuterPolyNodeToExPolygons(o,e);e.push(i)},ClipperLib.JS.ExPolygonsToPaths=function(t){var e,i,r,n,p=new ClipperLib.Paths;for(e=0,r=t.length;r>e;e++)for(p.push(t[e].outer),i=0,n=t[e].holes.length;n>i;i++)p.push(t[e].holes[i]);return p},ClipperLib.JS.PolyTreeToExPolygons=function(t){var e,i,r,n,p=new ClipperLib.ExPolygons;for(i=0,r=t.Childs(),n=r.length;n>i;i++)e=r[i],ClipperLib.JS.AddOuterPolyNodeToExPolygons(e,p);return p},module.exports=ClipperLib;


},{}],4:[function(require,module,exports){
(function (global){
(function(){function n(n,t){if(n!==t){var r=null===n,e=n===b,u=n===n,i=null===t,o=t===b,f=t===t;if(n>t&&!i||!u||r&&!o&&f||e&&f)return 1;if(t>n&&!r||!f||i&&!e&&u||o&&u)return-1}return 0}function t(n,t,r){for(var e=n.length,u=r?e:-1;r?u--:++u<e;)if(t(n[u],u,n))return u;return-1}function r(n,t,r){if(t!==t)return h(n,r);for(var e=r-1,u=n.length;++e<u;)if(n[e]===t)return e;return-1}function e(n){return"function"==typeof n||!1}function u(n){return null==n?"":n+""}function i(n,t){for(var r=-1,e=n.length;++r<e&&t.indexOf(n.charAt(r))>-1;);return r}function o(n,t){for(var r=n.length;r--&&t.indexOf(n.charAt(r))>-1;);return r}function f(t,r){return n(t.criteria,r.criteria)||t.index-r.index}function a(t,r,e){for(var u=-1,i=t.criteria,o=r.criteria,f=i.length,a=e.length;++u<f;){var c=n(i[u],o[u]);if(c){if(u>=a)return c;var l=e[u];return c*("asc"===l||l===!0?1:-1)}}return t.index-r.index}function c(n){return qn[n]}function l(n){return Mn[n]}function s(n,t,r){return t?n=Vn[n]:r&&(n=Yn[n]),"\\"+n}function p(n){return"\\"+Yn[n]}function h(n,t,r){for(var e=n.length,u=t+(r?0:-1);r?u--:++u<e;){var i=n[u];if(i!==i)return u}return-1}function v(n){return!!n&&"object"==typeof n}function _(n){return 160>=n&&n>=9&&13>=n||32==n||160==n||5760==n||6158==n||n>=8192&&(8202>=n||8232==n||8233==n||8239==n||8287==n||12288==n||65279==n)}function g(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;)n[r]===t&&(n[r]=D,i[++u]=r);return i}function y(n,t){for(var r,e=-1,u=n.length,i=-1,o=[];++e<u;){var f=n[e],a=t?t(f,e,n):f;e&&r===a||(r=a,o[++i]=f)}return o}function d(n){for(var t=-1,r=n.length;++t<r&&_(n.charCodeAt(t)););return t}function m(n){for(var t=n.length;t--&&_(n.charCodeAt(t)););return t}function w(n){return Pn[n]}function x(_){function G(n){if(v(n)&&!Cf(n)&&!(n instanceof qn)){if(n instanceof nn)return n;if(no.call(n,"__chain__")&&no.call(n,"__wrapped__"))return he(n)}return new nn(n)}function H(){}function nn(n,t,r){this.__wrapped__=n,this.__actions__=r||[],this.__chain__=!!t}function qn(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Oo,this.__views__=[]}function Mn(){var n=new qn(this.__wrapped__);return n.__actions__=et(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=et(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=et(this.__views__),n}function Pn(){if(this.__filtered__){var n=new qn(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function Kn(){var n=this.__wrapped__.value(),t=this.__dir__,r=Cf(n),e=0>t,u=r?n.length:0,i=Vr(0,u,this.__views__),o=i.start,f=i.end,a=f-o,c=e?f:o-1,l=this.__iteratees__,s=l.length,p=0,h=Ao(a,this.__takeCount__);if(!r||T>u||u==a&&h==a)return er(e&&r?n.reverse():n,this.__actions__);var v=[];n:for(;a--&&h>p;){c+=t;for(var _=-1,g=n[c];++_<s;){var y=l[_],d=y.iteratee,m=y.type,w=d(g);if(m==B)g=w;else if(!w){if(m==L)continue n;break n}}v[p++]=g}return v}function Vn(){this.__data__={}}function Yn(n){return this.has(n)&&delete this.__data__[n]}function Gn(n){return"__proto__"==n?b:this.__data__[n]}function Jn(n){return"__proto__"!=n&&no.call(this.__data__,n)}function Xn(n,t){return"__proto__"!=n&&(this.__data__[n]=t),this}function Zn(n){var t=n?n.length:0;for(this.data={hash:go(null),set:new lo};t--;)this.push(n[t])}function Hn(n,t){var r=n.data,e="string"==typeof t||Wu(t)?r.set.has(t):r.hash[t];return e?0:-1}function Qn(n){var t=this.data;"string"==typeof n||Wu(n)?t.set.add(n):t.hash[n]=!0}function rt(n,t){for(var r=-1,e=n.length,u=-1,i=t.length,o=zi(e+i);++r<e;)o[r]=n[r];for(;++u<i;)o[r++]=t[u];return o}function et(n,t){var r=-1,e=n.length;for(t||(t=zi(e));++r<e;)t[r]=n[r];return t}function ut(n,t){for(var r=-1,e=n.length;++r<e&&t(n[r],r,n)!==!1;);return n}function it(n,t){for(var r=n.length;r--&&t(n[r],r,n)!==!1;);return n}function ot(n,t){for(var r=-1,e=n.length;++r<e;)if(!t(n[r],r,n))return!1;return!0}function ft(n,t,r,e){for(var u=-1,i=n.length,o=e,f=o;++u<i;){var a=n[u],c=+t(a);r(c,o)&&(o=c,f=a)}return f}function at(n,t){for(var r=-1,e=n.length,u=-1,i=[];++r<e;){var o=n[r];t(o,r,n)&&(i[++u]=o)}return i}function ct(n,t){for(var r=-1,e=n.length,u=zi(e);++r<e;)u[r]=t(n[r],r,n);return u}function lt(n,t){for(var r=-1,e=t.length,u=n.length;++r<e;)n[u+r]=t[r];return n}function st(n,t,r,e){var u=-1,i=n.length;for(e&&i&&(r=n[++u]);++u<i;)r=t(r,n[u],u,n);return r}function pt(n,t,r,e){var u=n.length;for(e&&u&&(r=n[--u]);u--;)r=t(r,n[u],u,n);return r}function ht(n,t){for(var r=-1,e=n.length;++r<e;)if(t(n[r],r,n))return!0;return!1}function vt(n,t){for(var r=n.length,e=0;r--;)e+=+t(n[r])||0;return e}function _t(n,t){return n===b?t:n}function gt(n,t,r,e){return n!==b&&no.call(e,r)?n:t}function yt(n,t,r){for(var e=-1,u=Df(t),i=u.length;++e<i;){var o=u[e],f=n[o],a=r(f,t[o],o,n,t);(a===a?a===f:f!==f)&&(f!==b||o in n)||(n[o]=a)}return n}function dt(n,t){return null==t?n:wt(t,Df(t),n)}function mt(n,t){for(var r=-1,e=null==n,u=!e&&Zr(n),i=u?n.length:0,o=t.length,f=zi(o);++r<o;){var a=t[r];u?f[r]=Hr(a,i)?n[a]:b:f[r]=e?b:n[a]}return f}function wt(n,t,r){r||(r={});for(var e=-1,u=t.length;++e<u;){var i=t[e];r[i]=n[i]}return r}function xt(n,t,r){var e=typeof n;return"function"==e?t===b?n:or(n,t,r):null==n?Ri:"object"==e?zt(n):t===b?Si(n):Dt(n,t)}function bt(n,t,r,e,u,i,o){var f;if(r&&(f=u?r(n,e,u):r(n)),f!==b)return f;if(!Wu(n))return n;var a=Cf(n);if(a){if(f=Yr(n),!t)return et(n,f)}else{var c=ro.call(n),l=c==Y;if(c!=X&&c!=q&&(!l||u))return Dn[c]?Jr(n,c,t):u?n:{};if(f=Gr(l?{}:n),!t)return dt(f,n)}i||(i=[]),o||(o=[]);for(var s=i.length;s--;)if(i[s]==n)return o[s];return i.push(n),o.push(f),(a?ut:$t)(n,function(e,u){f[u]=bt(e,t,r,u,n,i,o)}),f}function At(n,t,r){if("function"!=typeof n)throw new Ji(z);return so(function(){n.apply(b,r)},t)}function jt(n,t){var e=n?n.length:0,u=[];if(!e)return u;var i=-1,o=Mr(),f=o==r,a=f&&t.length>=T?_r(t):null,c=t.length;a&&(o=Hn,f=!1,t=a);n:for(;++i<e;){var l=n[i];if(f&&l===l){for(var s=c;s--;)if(t[s]===l)continue n;u.push(l)}else o(t,l,0)<0&&u.push(l)}return u}function kt(n,t){var r=!0;return No(n,function(n,e,u){return r=!!t(n,e,u)}),r}function It(n,t,r,e){var u=e,i=u;return No(n,function(n,o,f){var a=+t(n,o,f);(r(a,u)||a===e&&a===i)&&(u=a,i=n)}),i}function Rt(n,t,r,e){var u=n.length;for(r=null==r?0:+r||0,0>r&&(r=-r>u?0:u+r),e=e===b||e>u?u:+e||0,0>e&&(e+=u),u=r>e?0:e>>>0,r>>>=0;u>r;)n[r++]=t;return n}function Ot(n,t){var r=[];return No(n,function(n,e,u){t(n,e,u)&&r.push(n)}),r}function Et(n,t,r,e){var u;return r(n,function(n,r,i){return t(n,r,i)?(u=e?r:n,!1):void 0}),u}function Ct(n,t,r,e){e||(e=[]);for(var u=-1,i=n.length;++u<i;){var o=n[u];v(o)&&Zr(o)&&(r||Cf(o)||ku(o))?t?Ct(o,t,r,e):lt(e,o):r||(e[e.length]=o)}return e}function Ut(n,t){return Lo(n,t,ni)}function $t(n,t){return Lo(n,t,Df)}function St(n,t){return Bo(n,t,Df)}function Wt(n,t){for(var r=-1,e=t.length,u=-1,i=[];++r<e;){var o=t[r];Su(n[o])&&(i[++u]=o)}return i}function Ft(n,t,r){if(null!=n){r!==b&&r in se(n)&&(t=[r]);for(var e=0,u=t.length;null!=n&&u>e;)n=n[t[e++]];return e&&e==u?n:b}}function Nt(n,t,r,e,u,i){return n===t?!0:null==n||null==t||!Wu(n)&&!v(t)?n!==n&&t!==t:Tt(n,t,Nt,r,e,u,i)}function Tt(n,t,r,e,u,i,o){var f=Cf(n),a=Cf(t),c=M,l=M;f||(c=ro.call(n),c==q?c=X:c!=X&&(f=Mu(n))),a||(l=ro.call(t),l==q?l=X:l!=X&&(a=Mu(t)));var s=c==X,p=l==X,h=c==l;if(h&&!f&&!s)return Br(n,t,c);if(!u){var v=s&&no.call(n,"__wrapped__"),_=p&&no.call(t,"__wrapped__");if(v||_)return r(v?n.value():n,_?t.value():t,e,u,i,o)}if(!h)return!1;i||(i=[]),o||(o=[]);for(var g=i.length;g--;)if(i[g]==n)return o[g]==t;i.push(n),o.push(t);var y=(f?Lr:zr)(n,t,r,e,u,i,o);return i.pop(),o.pop(),y}function Lt(n,t,r){var e=t.length,u=e,i=!r;if(null==n)return!u;for(n=se(n);e--;){var o=t[e];if(i&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return!1}for(;++e<u;){o=t[e];var f=o[0],a=n[f],c=o[1];if(i&&o[2]){if(a===b&&!(f in n))return!1}else{var l=r?r(a,c,f):b;if(!(l===b?Nt(c,a,r,!0):l))return!1}}return!0}function Bt(n,t){var r=-1,e=Zr(n)?zi(n.length):[];return No(n,function(n,u,i){e[++r]=t(n,u,i)}),e}function zt(n){var t=Pr(n);if(1==t.length&&t[0][2]){var r=t[0][0],e=t[0][1];return function(n){return null==n?!1:n[r]===e&&(e!==b||r in se(n))}}return function(n){return Lt(n,t)}}function Dt(n,t){var r=Cf(n),e=ne(n)&&ee(t),u=n+"";return n=pe(n),function(i){if(null==i)return!1;var o=u;if(i=se(i),(r||!e)&&!(o in i)){if(i=1==n.length?i:Ft(i,Jt(n,0,-1)),null==i)return!1;o=Ie(n),i=se(i)}return i[o]===t?t!==b||o in i:Nt(t,i[o],b,!0)}}function qt(n,t,r,e,u){if(!Wu(n))return n;var i=Zr(t)&&(Cf(t)||Mu(t)),o=i?b:Df(t);return ut(o||t,function(f,a){if(o&&(a=f,f=t[a]),v(f))e||(e=[]),u||(u=[]),Mt(n,t,a,qt,r,e,u);else{var c=n[a],l=r?r(c,f,a,n,t):b,s=l===b;s&&(l=f),l===b&&(!i||a in n)||!s&&(l===l?l===c:c!==c)||(n[a]=l)}}),n}function Mt(n,t,r,e,u,i,o){for(var f=i.length,a=t[r];f--;)if(i[f]==a)return void(n[r]=o[f]);var c=n[r],l=u?u(c,a,r,n,t):b,s=l===b;s&&(l=a,Zr(a)&&(Cf(a)||Mu(a))?l=Cf(c)?c:Zr(c)?et(c):[]:zu(a)||ku(a)?l=ku(c)?Gu(c):zu(c)?c:{}:s=!1),i.push(a),o.push(l),s?n[r]=e(l,a,u,i,o):(l===l?l!==c:c===c)&&(n[r]=l)}function Pt(n){return function(t){return null==t?b:t[n]}}function Kt(n){var t=n+"";return n=pe(n),function(r){return Ft(r,n,t)}}function Vt(n,t){for(var r=n?t.length:0;r--;){var e=t[r];if(e!=u&&Hr(e)){var u=e;po.call(n,e,1)}}return n}function Yt(n,t){return n+yo(Io()*(t-n+1))}function Gt(n,t,r,e,u){return u(n,function(n,u,i){r=e?(e=!1,n):t(r,n,u,i)}),r}function Jt(n,t,r){var e=-1,u=n.length;t=null==t?0:+t||0,0>t&&(t=-t>u?0:u+t),r=r===b||r>u?u:+r||0,0>r&&(r+=u),u=t>r?0:r-t>>>0,t>>>=0;for(var i=zi(u);++e<u;)i[e]=n[e+t];return i}function Xt(n,t){var r;return No(n,function(n,e,u){return r=t(n,e,u),!r}),!!r}function Zt(n,t){var r=n.length;for(n.sort(t);r--;)n[r]=n[r].value;return n}function Ht(n,t,r){var e=Dr(),u=-1;t=ct(t,function(n){return e(n)});var i=Bt(n,function(n){var r=ct(t,function(t){return t(n)});return{criteria:r,index:++u,value:n}});return Zt(i,function(n,t){return a(n,t,r)})}function Qt(n,t){var r=0;return No(n,function(n,e,u){r+=+t(n,e,u)||0}),r}function nr(n,t){var e=-1,u=Mr(),i=n.length,o=u==r,f=o&&i>=T,a=f?_r():null,c=[];a?(u=Hn,o=!1):(f=!1,a=t?[]:c);n:for(;++e<i;){var l=n[e],s=t?t(l,e,n):l;if(o&&l===l){for(var p=a.length;p--;)if(a[p]===s)continue n;t&&a.push(s),c.push(l)}else u(a,s,0)<0&&((t||f)&&a.push(s),c.push(l))}return c}function tr(n,t){for(var r=-1,e=t.length,u=zi(e);++r<e;)u[r]=n[t[r]];return u}function rr(n,t,r,e){for(var u=n.length,i=e?u:-1;(e?i--:++i<u)&&t(n[i],i,n););return r?Jt(n,e?0:i,e?i+1:u):Jt(n,e?i+1:0,e?u:i)}function er(n,t){var r=n;r instanceof qn&&(r=r.value());for(var e=-1,u=t.length;++e<u;){var i=t[e];r=i.func.apply(i.thisArg,lt([r],i.args))}return r}function ur(n,t,r){var e=0,u=n?n.length:e;if("number"==typeof t&&t===t&&Uo>=u){for(;u>e;){var i=e+u>>>1,o=n[i];(r?t>=o:t>o)&&null!==o?e=i+1:u=i}return u}return ir(n,t,Ri,r)}function ir(n,t,r,e){t=r(t);for(var u=0,i=n?n.length:0,o=t!==t,f=null===t,a=t===b;i>u;){var c=yo((u+i)/2),l=r(n[c]),s=l!==b,p=l===l;if(o)var h=p||e;else h=f?p&&s&&(e||null!=l):a?p&&(e||s):null==l?!1:e?t>=l:t>l;h?u=c+1:i=c}return Ao(i,Co)}function or(n,t,r){if("function"!=typeof n)return Ri;if(t===b)return n;switch(r){case 1:return function(r){return n.call(t,r)};case 3:return function(r,e,u){return n.call(t,r,e,u)};case 4:return function(r,e,u,i){return n.call(t,r,e,u,i)};case 5:return function(r,e,u,i,o){return n.call(t,r,e,u,i,o)}}return function(){return n.apply(t,arguments)}}function fr(n){var t=new io(n.byteLength),r=new ho(t);return r.set(new ho(n)),t}function ar(n,t,r){for(var e=r.length,u=-1,i=bo(n.length-e,0),o=-1,f=t.length,a=zi(f+i);++o<f;)a[o]=t[o];for(;++u<e;)a[r[u]]=n[u];for(;i--;)a[o++]=n[u++];return a}function cr(n,t,r){for(var e=-1,u=r.length,i=-1,o=bo(n.length-u,0),f=-1,a=t.length,c=zi(o+a);++i<o;)c[i]=n[i];for(var l=i;++f<a;)c[l+f]=t[f];for(;++e<u;)c[l+r[e]]=n[i++];return c}function lr(n,t){return function(r,e,u){var i=t?t():{};if(e=Dr(e,u,3),Cf(r))for(var o=-1,f=r.length;++o<f;){var a=r[o];n(i,a,e(a,o,r),r)}else No(r,function(t,r,u){n(i,t,e(t,r,u),u)});return i}}function sr(n){return yu(function(t,r){var e=-1,u=null==t?0:r.length,i=u>2?r[u-2]:b,o=u>2?r[2]:b,f=u>1?r[u-1]:b;for("function"==typeof i?(i=or(i,f,5),u-=2):(i="function"==typeof f?f:b,u-=i?1:0),o&&Qr(r[0],r[1],o)&&(i=3>u?b:i,u=1);++e<u;){var a=r[e];a&&n(t,a,i)}return t})}function pr(n,t){return function(r,e){var u=r?qo(r):0;if(!re(u))return n(r,e);for(var i=t?u:-1,o=se(r);(t?i--:++i<u)&&e(o[i],i,o)!==!1;);return r}}function hr(n){return function(t,r,e){for(var u=se(t),i=e(t),o=i.length,f=n?o:-1;n?f--:++f<o;){var a=i[f];if(r(u[a],a,u)===!1)break}return t}}function vr(n,t){function r(){var u=this&&this!==nt&&this instanceof r?e:n;return u.apply(t,arguments)}var e=yr(n);return r}function _r(n){return go&&lo?new Zn(n):null}function gr(n){return function(t){for(var r=-1,e=ji(li(t)),u=e.length,i="";++r<u;)i=n(i,e[r],r);return i}}function yr(n){return function(){var t=arguments;switch(t.length){case 0:return new n;case 1:return new n(t[0]);case 2:return new n(t[0],t[1]);case 3:return new n(t[0],t[1],t[2]);case 4:return new n(t[0],t[1],t[2],t[3]);case 5:return new n(t[0],t[1],t[2],t[3],t[4]);case 6:return new n(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new n(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var r=Fo(n.prototype),e=n.apply(r,t);return Wu(e)?e:r}}function dr(n){function t(r,e,u){u&&Qr(r,e,u)&&(e=b);var i=Tr(r,n,b,b,b,b,b,e);return i.placeholder=t.placeholder,i}return t}function mr(n,t){return yu(function(r){var e=r[0];return null==e?e:(r.push(t),n.apply(b,r))})}function wr(n,t){return function(r,e,u){if(u&&Qr(r,e,u)&&(e=b),e=Dr(e,u,3),1==e.length){r=Cf(r)?r:le(r);var i=ft(r,e,n,t);if(!r.length||i!==t)return i}return It(r,e,n,t)}}function xr(n,r){return function(e,u,i){if(u=Dr(u,i,3),Cf(e)){var o=t(e,u,r);return o>-1?e[o]:b}return Et(e,u,n)}}function br(n){return function(r,e,u){return r&&r.length?(e=Dr(e,u,3),t(r,e,n)):-1}}function Ar(n){return function(t,r,e){return r=Dr(r,e,3),Et(t,r,n,!0)}}function jr(n){return function(){for(var t,r=arguments.length,e=n?r:-1,u=0,i=zi(r);n?e--:++e<r;){var o=i[u++]=arguments[e];if("function"!=typeof o)throw new Ji(z);!t&&nn.prototype.thru&&"wrapper"==qr(o)&&(t=new nn([],!0))}for(e=t?-1:r;++e<r;){o=i[e];var f=qr(o),a="wrapper"==f?Do(o):b;t=a&&te(a[0])&&a[1]==(U|R|E|$)&&!a[4].length&&1==a[9]?t[qr(a[0])].apply(t,a[3]):1==o.length&&te(o)?t[f]():t.thru(o)}return function(){var n=arguments,e=n[0];if(t&&1==n.length&&Cf(e)&&e.length>=T)return t.plant(e).value();for(var u=0,o=r?i[u].apply(this,n):e;++u<r;)o=i[u].call(this,o);return o}}}function kr(n,t){return function(r,e,u){return"function"==typeof e&&u===b&&Cf(r)?n(r,e):t(r,or(e,u,3))}}function Ir(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=or(r,e,3)),n(t,r,ni)}}function Rr(n){return function(t,r,e){return("function"!=typeof r||e!==b)&&(r=or(r,e,3)),n(t,r)}}function Or(n){return function(t,r,e){var u={};return r=Dr(r,e,3),$t(t,function(t,e,i){var o=r(t,e,i);e=n?o:e,t=n?t:o,u[e]=t}),u}}function Er(n){return function(t,r,e){return t=u(t),(n?t:"")+Sr(t,r,e)+(n?"":t)}}function Cr(n){var t=yu(function(r,e){var u=g(e,t.placeholder);return Tr(r,n,b,e,u)});return t}function Ur(n,t){return function(r,e,u,i){var o=arguments.length<3;return"function"==typeof e&&i===b&&Cf(r)?n(r,e,u,o):Gt(r,Dr(e,i,4),u,o,t)}}function $r(n,t,r,e,u,i,o,f,a,c){function l(){for(var m=arguments.length,w=m,x=zi(m);w--;)x[w]=arguments[w];if(e&&(x=ar(x,e,u)),i&&(x=cr(x,i,o)),v||y){var A=l.placeholder,I=g(x,A);if(m-=I.length,c>m){var R=f?et(f):b,O=bo(c-m,0),U=v?I:b,$=v?b:I,S=v?x:b,W=v?b:x;t|=v?E:C,t&=~(v?C:E),_||(t&=~(j|k));var F=[n,t,r,S,U,W,$,R,a,O],N=$r.apply(b,F);return te(n)&&Mo(N,F),N.placeholder=A,N}}var T=p?r:this,L=h?T[n]:n;return f&&(x=ae(x,f)),s&&a<x.length&&(x.length=a),this&&this!==nt&&this instanceof l&&(L=d||yr(n)),L.apply(T,x)}var s=t&U,p=t&j,h=t&k,v=t&R,_=t&I,y=t&O,d=h?b:yr(n);return l}function Sr(n,t,r){var e=n.length;if(t=+t,e>=t||!wo(t))return"";var u=t-e;return r=null==r?" ":r+"",gi(r,_o(u/r.length)).slice(0,u)}function Wr(n,t,r,e){function u(){for(var t=-1,f=arguments.length,a=-1,c=e.length,l=zi(c+f);++a<c;)l[a]=e[a];for(;f--;)l[a++]=arguments[++t];var s=this&&this!==nt&&this instanceof u?o:n;return s.apply(i?r:this,l)}var i=t&j,o=yr(n);return u}function Fr(n){var t=Pi[n];return function(n,r){return r=r===b?0:+r||0,r?(r=ao(10,r),t(n*r)/r):t(n)}}function Nr(n){return function(t,r,e,u){var i=Dr(e);return null==e&&i===xt?ur(t,r,n):ir(t,r,i(e,u,1),n)}}function Tr(n,t,r,e,u,i,o,f){var a=t&k;if(!a&&"function"!=typeof n)throw new Ji(z);var c=e?e.length:0;if(c||(t&=~(E|C),e=u=b),c-=u?u.length:0,t&C){var l=e,s=u;e=u=b}var p=a?b:Do(n),h=[n,t,r,e,u,l,s,i,o,f];if(p&&(ue(h,p),t=h[1],f=h[9]),h[9]=null==f?a?0:n.length:bo(f-c,0)||0,t==j)var v=vr(h[0],h[2]);else v=t!=E&&t!=(j|E)||h[4].length?$r.apply(b,h):Wr.apply(b,h);var _=p?zo:Mo;return _(v,h)}function Lr(n,t,r,e,u,i,o){var f=-1,a=n.length,c=t.length;if(a!=c&&!(u&&c>a))return!1;for(;++f<a;){var l=n[f],s=t[f],p=e?e(u?s:l,u?l:s,f):b;if(p!==b){if(p)continue;return!1}if(u){if(!ht(t,function(n){return l===n||r(l,n,e,u,i,o)}))return!1}else if(l!==s&&!r(l,s,e,u,i,o))return!1}return!0}function Br(n,t,r){switch(r){case P:case K:return+n==+t;case V:return n.name==t.name&&n.message==t.message;case J:return n!=+n?t!=+t:n==+t;case Z:case Q:return n==t+""}return!1}function zr(n,t,r,e,u,i,o){var f=Df(n),a=f.length,c=Df(t),l=c.length;if(a!=l&&!u)return!1;for(var s=a;s--;){var p=f[s];if(!(u?p in t:no.call(t,p)))return!1}for(var h=u;++s<a;){p=f[s];var v=n[p],_=t[p],g=e?e(u?_:v,u?v:_,p):b;if(!(g===b?r(v,_,e,u,i,o):g))return!1;h||(h="constructor"==p)}if(!h){var y=n.constructor,d=t.constructor;if(y!=d&&"constructor"in n&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof d&&d instanceof d))return!1}return!0}function Dr(n,t,r){var e=G.callback||ki;return e=e===ki?xt:e,r?e(n,t,r):e}function qr(n){for(var t=n.name,r=Wo[t],e=r?r.length:0;e--;){var u=r[e],i=u.func;if(null==i||i==n)return u.name}return t}function Mr(n,t,e){var u=G.indexOf||je;return u=u===je?r:u,n?u(n,t,e):u}function Pr(n){for(var t=ti(n),r=t.length;r--;)t[r][2]=ee(t[r][1]);return t}function Kr(n,t){var r=null==n?b:n[t];return Tu(r)?r:b}function Vr(n,t,r){for(var e=-1,u=r.length;++e<u;){var i=r[e],o=i.size;switch(i.type){case"drop":n+=o;break;case"dropRight":t-=o;break;case"take":t=Ao(t,n+o);break;case"takeRight":n=bo(n,t-o)}}return{start:n,end:t}}function Yr(n){var t=n.length,r=new n.constructor(t);return t&&"string"==typeof n[0]&&no.call(n,"index")&&(r.index=n.index,r.input=n.input),r}function Gr(n){var t=n.constructor;return"function"==typeof t&&t instanceof t||(t=Vi),new t}function Jr(n,t,r){var e=n.constructor;switch(t){case tn:return fr(n);case P:case K:return new e(+n);case rn:case en:case un:case on:case fn:case an:case cn:case ln:case sn:var u=n.buffer;return new e(r?fr(u):u,n.byteOffset,n.length);case J:case Q:return new e(n);case Z:var i=new e(n.source,Cn.exec(n));i.lastIndex=n.lastIndex}return i}function Xr(n,t,r){null==n||ne(t,n)||(t=pe(t),n=1==t.length?n:Ft(n,Jt(t,0,-1)),t=Ie(t));var e=null==n?n:n[t];return null==e?b:e.apply(n,r)}function Zr(n){return null!=n&&re(qo(n))}function Hr(n,t){return n="number"==typeof n||Sn.test(n)?+n:-1,t=null==t?$o:t,n>-1&&n%1==0&&t>n}function Qr(n,t,r){if(!Wu(r))return!1;var e=typeof t;if("number"==e?Zr(r)&&Hr(t,r.length):"string"==e&&t in r){var u=r[t];return n===n?n===u:u!==u}return!1}function ne(n,t){var r=typeof n;if("string"==r&&An.test(n)||"number"==r)return!0;if(Cf(n))return!1;var e=!bn.test(n);return e||null!=t&&n in se(t)}function te(n){var t=qr(n);if(!(t in qn.prototype))return!1;var r=G[t];if(n===r)return!0;var e=Do(r);return!!e&&n===e[0]}function re(n){return"number"==typeof n&&n>-1&&n%1==0&&$o>=n}function ee(n){return n===n&&!Wu(n)}function ue(n,t){var r=n[1],e=t[1],u=r|e,i=U>u,o=e==U&&r==R||e==U&&r==$&&n[7].length<=t[8]||e==(U|$)&&r==R;if(!i&&!o)return n;e&j&&(n[2]=t[2],u|=r&j?0:I);var f=t[3];if(f){var a=n[3];n[3]=a?ar(a,f,t[4]):et(f),n[4]=a?g(n[3],D):et(t[4])}return f=t[5],f&&(a=n[5],n[5]=a?cr(a,f,t[6]):et(f),n[6]=a?g(n[5],D):et(t[6])),f=t[7],f&&(n[7]=et(f)),e&U&&(n[8]=null==n[8]?t[8]:Ao(n[8],t[8])),null==n[9]&&(n[9]=t[9]),n[0]=t[0],n[1]=u,n}function ie(n,t){return n===b?t:Uf(n,t,ie)}function oe(n,t){n=se(n);for(var r=-1,e=t.length,u={};++r<e;){var i=t[r];i in n&&(u[i]=n[i])}return u}function fe(n,t){var r={};return Ut(n,function(n,e,u){t(n,e,u)&&(r[e]=n)}),r}function ae(n,t){for(var r=n.length,e=Ao(t.length,r),u=et(n);e--;){var i=t[e];n[e]=Hr(i,r)?u[i]:b}return n}function ce(n){for(var t=ni(n),r=t.length,e=r&&n.length,u=!!e&&re(e)&&(Cf(n)||ku(n)),i=-1,o=[];++i<r;){var f=t[i];(u&&Hr(f,e)||no.call(n,f))&&o.push(f)}return o}function le(n){return null==n?[]:Zr(n)?Wu(n)?n:Vi(n):ii(n)}function se(n){return Wu(n)?n:Vi(n)}function pe(n){if(Cf(n))return n;var t=[];return u(n).replace(jn,function(n,r,e,u){t.push(e?u.replace(On,"$1"):r||n)}),t}function he(n){return n instanceof qn?n.clone():new nn(n.__wrapped__,n.__chain__,et(n.__actions__))}function ve(n,t,r){t=(r?Qr(n,t,r):null==t)?1:bo(yo(t)||1,1);for(var e=0,u=n?n.length:0,i=-1,o=zi(_o(u/t));u>e;)o[++i]=Jt(n,e,e+=t);return o}function _e(n){for(var t=-1,r=n?n.length:0,e=-1,u=[];++t<r;){var i=n[t];i&&(u[++e]=i)}return u}function ge(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),Jt(n,0>t?0:t)):[]}function ye(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Jt(n,0,0>t?0:t)):[]}function de(n,t,r){return n&&n.length?rr(n,Dr(t,r,3),!0,!0):[]}function me(n,t,r){return n&&n.length?rr(n,Dr(t,r,3),!0):[]}function we(n,t,r,e){var u=n?n.length:0;return u?(r&&"number"!=typeof r&&Qr(n,t,r)&&(r=0,e=u),Rt(n,t,r,e)):[]}function xe(n){return n?n[0]:b}function be(n,t,r){var e=n?n.length:0;return r&&Qr(n,t,r)&&(t=!1),e?Ct(n,t):[]}function Ae(n){var t=n?n.length:0;return t?Ct(n,!0):[]}function je(n,t,e){var u=n?n.length:0;if(!u)return-1;if("number"==typeof e)e=0>e?bo(u+e,0):e;else if(e){var i=ur(n,t);return u>i&&(t===t?t===n[i]:n[i]!==n[i])?i:-1}return r(n,t,e||0)}function ke(n){return ye(n,1)}function Ie(n){var t=n?n.length:0;return t?n[t-1]:b}function Re(n,t,r){var e=n?n.length:0;if(!e)return-1;var u=e;if("number"==typeof r)u=(0>r?bo(e+r,0):Ao(r||0,e-1))+1;else if(r){u=ur(n,t,!0)-1;var i=n[u];return(t===t?t===i:i!==i)?u:-1}if(t!==t)return h(n,u,!0);for(;u--;)if(n[u]===t)return u;return-1}function Oe(){var n=arguments,t=n[0];if(!t||!t.length)return t;for(var r=0,e=Mr(),u=n.length;++r<u;)for(var i=0,o=n[r];(i=e(t,o,i))>-1;)po.call(t,i,1);return t}function Ee(n,t,r){var e=[];if(!n||!n.length)return e;var u=-1,i=[],o=n.length;for(t=Dr(t,r,3);++u<o;){var f=n[u];t(f,u,n)&&(e.push(f),i.push(u))}return Vt(n,i),e}function Ce(n){return ge(n,1)}function Ue(n,t,r){var e=n?n.length:0;return e?(r&&"number"!=typeof r&&Qr(n,t,r)&&(t=0,r=e),Jt(n,t,r)):[]}function $e(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),Jt(n,0,0>t?0:t)):[]}function Se(n,t,r){var e=n?n.length:0;return e?((r?Qr(n,t,r):null==t)&&(t=1),t=e-(+t||0),Jt(n,0>t?0:t)):[]}function We(n,t,r){return n&&n.length?rr(n,Dr(t,r,3),!1,!0):[]}function Fe(n,t,r){return n&&n.length?rr(n,Dr(t,r,3)):[]}function Ne(n,t,e,u){var i=n?n.length:0;if(!i)return[];null!=t&&"boolean"!=typeof t&&(u=e,e=Qr(n,t,u)?b:t,t=!1);var o=Dr();return(null!=e||o!==xt)&&(e=o(e,u,3)),t&&Mr()==r?y(n,e):nr(n,e)}function Te(n){if(!n||!n.length)return[];var t=-1,r=0;n=at(n,function(n){return Zr(n)?(r=bo(n.length,r),!0):void 0});for(var e=zi(r);++t<r;)e[t]=ct(n,Pt(t));return e}function Le(n,t,r){var e=n?n.length:0;if(!e)return[];var u=Te(n);return null==t?u:(t=or(t,r,4),ct(u,function(n){return st(n,t,b,!0)}))}function Be(){for(var n=-1,t=arguments.length;++n<t;){var r=arguments[n];if(Zr(r))var e=e?lt(jt(e,r),jt(r,e)):r}return e?nr(e):[]}function ze(n,t){var r=-1,e=n?n.length:0,u={};for(!e||t||Cf(n[0])||(t=[]);++r<e;){var i=n[r];t?u[i]=t[r]:i&&(u[i[0]]=i[1])}return u}function De(n){var t=G(n);return t.__chain__=!0,t}function qe(n,t,r){return t.call(r,n),n}function Me(n,t,r){return t.call(r,n)}function Pe(){return De(this)}function Ke(){return new nn(this.value(),this.__chain__)}function Ve(n){for(var t,r=this;r instanceof H;){var e=he(r);t?u.__wrapped__=e:t=e;var u=e;r=r.__wrapped__}return u.__wrapped__=n,t}function Ye(){var n=this.__wrapped__,t=function(n){return r&&r.__dir__<0?n:n.reverse()};if(n instanceof qn){var r=n;return this.__actions__.length&&(r=new qn(this)),r=r.reverse(),r.__actions__.push({func:Me,args:[t],thisArg:b}),new nn(r,this.__chain__)}return this.thru(t)}function Ge(){return this.value()+""}function Je(){return er(this.__wrapped__,this.__actions__)}function Xe(n,t,r){var e=Cf(n)?ot:kt;return r&&Qr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=Dr(t,r,3)),e(n,t)}function Ze(n,t,r){var e=Cf(n)?at:Ot;return t=Dr(t,r,3),e(n,t)}function He(n,t){return uf(n,zt(t))}function Qe(n,t,r,e){var u=n?qo(n):0;return re(u)||(n=ii(n),u=n.length),r="number"!=typeof r||e&&Qr(t,r,e)?0:0>r?bo(u+r,0):r||0,"string"==typeof n||!Cf(n)&&qu(n)?u>=r&&n.indexOf(t,r)>-1:!!u&&Mr(n,t,r)>-1}function nu(n,t,r){var e=Cf(n)?ct:Bt;return t=Dr(t,r,3),e(n,t)}function tu(n,t){return nu(n,Si(t))}function ru(n,t,r){var e=Cf(n)?at:Ot;return t=Dr(t,r,3),e(n,function(n,r,e){return!t(n,r,e)})}function eu(n,t,r){if(r?Qr(n,t,r):null==t){n=le(n);var e=n.length;return e>0?n[Yt(0,e-1)]:b}var u=-1,i=Yu(n),e=i.length,o=e-1;for(t=Ao(0>t?0:+t||0,e);++u<t;){var f=Yt(u,o),a=i[f];i[f]=i[u],i[u]=a}return i.length=t,i}function uu(n){return eu(n,Oo)}function iu(n){var t=n?qo(n):0;return re(t)?t:Df(n).length}function ou(n,t,r){var e=Cf(n)?ht:Xt;return r&&Qr(n,t,r)&&(t=b),("function"!=typeof t||r!==b)&&(t=Dr(t,r,3)),e(n,t)}function fu(n,t,r){if(null==n)return[];r&&Qr(n,t,r)&&(t=b);var e=-1;t=Dr(t,r,3);var u=Bt(n,function(n,r,u){return{criteria:t(n,r,u),index:++e,value:n}});return Zt(u,f)}function au(n,t,r,e){return null==n?[]:(e&&Qr(t,r,e)&&(r=b),Cf(t)||(t=null==t?[]:[t]),Cf(r)||(r=null==r?[]:[r]),Ht(n,t,r))}function cu(n,t){return Ze(n,zt(t))}function lu(n,t){if("function"!=typeof t){if("function"!=typeof n)throw new Ji(z);var r=n;n=t,t=r}return n=wo(n=+n)?n:0,function(){return--n<1?t.apply(this,arguments):void 0}}function su(n,t,r){return r&&Qr(n,t,r)&&(t=b),t=n&&null==t?n.length:bo(+t||0,0),Tr(n,U,b,b,b,b,t)}function pu(n,t){var r;if("function"!=typeof t){if("function"!=typeof n)throw new Ji(z);var e=n;n=t,t=e}return function(){return--n>0&&(r=t.apply(this,arguments)),1>=n&&(t=b),r}}function hu(n,t,r){function e(){h&&oo(h),c&&oo(c),_=0,c=h=v=b}function u(t,r){r&&oo(r),c=h=v=b,t&&(_=gf(),l=n.apply(p,a),h||c||(a=p=b))}function i(){var n=t-(gf()-s);0>=n||n>t?u(v,c):h=so(i,n)}function o(){u(y,h)}function f(){if(a=arguments,s=gf(),p=this,v=y&&(h||!d),g===!1)var r=d&&!h;else{c||d||(_=s);var e=g-(s-_),u=0>=e||e>g;u?(c&&(c=oo(c)),_=s,l=n.apply(p,a)):c||(c=so(o,e))}return u&&h?h=oo(h):h||t===g||(h=so(i,t)),r&&(u=!0,l=n.apply(p,a)),!u||h||c||(a=p=b),l}var a,c,l,s,p,h,v,_=0,g=!1,y=!0;if("function"!=typeof n)throw new Ji(z);if(t=0>t?0:+t||0,r===!0){var d=!0;y=!1}else Wu(r)&&(d=!!r.leading,g="maxWait"in r&&bo(+r.maxWait||0,t),y="trailing"in r?!!r.trailing:y);return f.cancel=e,f}function vu(n,t){if("function"!=typeof n||t&&"function"!=typeof t)throw new Ji(z);var r=function(){var e=arguments,u=t?t.apply(this,e):e[0],i=r.cache;if(i.has(u))return i.get(u);var o=n.apply(this,e);return r.cache=i.set(u,o),o};return r.cache=new vu.Cache,r}function _u(n){if("function"!=typeof n)throw new Ji(z);return function(){return!n.apply(this,arguments)}}function gu(n){return pu(2,n)}function yu(n,t){if("function"!=typeof n)throw new Ji(z);return t=bo(t===b?n.length-1:+t||0,0),function(){for(var r=arguments,e=-1,u=bo(r.length-t,0),i=zi(u);++e<u;)i[e]=r[t+e];switch(t){case 0:return n.call(this,i);case 1:return n.call(this,r[0],i);case 2:return n.call(this,r[0],r[1],i)}var o=zi(t+1);for(e=-1;++e<t;)o[e]=r[e];return o[t]=i,n.apply(this,o)}}function du(n){if("function"!=typeof n)throw new Ji(z);return function(t){return n.apply(this,t)}}function mu(n,t,r){var e=!0,u=!0;if("function"!=typeof n)throw new Ji(z);return r===!1?e=!1:Wu(r)&&(e="leading"in r?!!r.leading:e,u="trailing"in r?!!r.trailing:u),hu(n,t,{leading:e,maxWait:+t,trailing:u})}function wu(n,t){return t=null==t?Ri:t,Tr(t,E,b,[n],[])}function xu(n,t,r,e){return t&&"boolean"!=typeof t&&Qr(n,t,r)?t=!1:"function"==typeof t&&(e=r,r=t,t=!1),"function"==typeof r?bt(n,t,or(r,e,1)):bt(n,t)}function bu(n,t,r){return"function"==typeof t?bt(n,!0,or(t,r,1)):bt(n,!0)}function Au(n,t){return n>t}function ju(n,t){return n>=t}function ku(n){return v(n)&&Zr(n)&&no.call(n,"callee")&&!co.call(n,"callee")}function Iu(n){return n===!0||n===!1||v(n)&&ro.call(n)==P}function Ru(n){return v(n)&&ro.call(n)==K}function Ou(n){return!!n&&1===n.nodeType&&v(n)&&!zu(n)}function Eu(n){return null==n?!0:Zr(n)&&(Cf(n)||qu(n)||ku(n)||v(n)&&Su(n.splice))?!n.length:!Df(n).length}function Cu(n,t,r,e){r="function"==typeof r?or(r,e,3):b;var u=r?r(n,t):b;return u===b?Nt(n,t,r):!!u}function Uu(n){return v(n)&&"string"==typeof n.message&&ro.call(n)==V}function $u(n){return"number"==typeof n&&wo(n)}function Su(n){return Wu(n)&&ro.call(n)==Y}function Wu(n){var t=typeof n;return!!n&&("object"==t||"function"==t)}function Fu(n,t,r,e){return r="function"==typeof r?or(r,e,3):b,Lt(n,Pr(t),r)}function Nu(n){return Bu(n)&&n!=+n}function Tu(n){return null==n?!1:Su(n)?uo.test(Qi.call(n)):v(n)&&$n.test(n)}function Lu(n){return null===n}function Bu(n){return"number"==typeof n||v(n)&&ro.call(n)==J}function zu(n){var t;if(!v(n)||ro.call(n)!=X||ku(n)||!no.call(n,"constructor")&&(t=n.constructor,"function"==typeof t&&!(t instanceof t)))return!1;var r;return Ut(n,function(n,t){r=t}),r===b||no.call(n,r)}function Du(n){return Wu(n)&&ro.call(n)==Z}function qu(n){return"string"==typeof n||v(n)&&ro.call(n)==Q}function Mu(n){return v(n)&&re(n.length)&&!!zn[ro.call(n)]}function Pu(n){return n===b}function Ku(n,t){return t>n}function Vu(n,t){return t>=n}function Yu(n){var t=n?qo(n):0;return re(t)?t?et(n):[]:ii(n)}function Gu(n){return wt(n,ni(n))}function Ju(n,t,r){var e=Fo(n);return r&&Qr(n,t,r)&&(t=b),t?dt(e,t):e}function Xu(n){return Wt(n,ni(n))}function Zu(n,t,r){var e=null==n?b:Ft(n,pe(t),t+"");return e===b?r:e}function Hu(n,t){if(null==n)return!1;var r=no.call(n,t);if(!r&&!ne(t)){if(t=pe(t),n=1==t.length?n:Ft(n,Jt(t,0,-1)),null==n)return!1;t=Ie(t),r=no.call(n,t)}return r||re(n.length)&&Hr(t,n.length)&&(Cf(n)||ku(n))}function Qu(n,t,r){r&&Qr(n,t,r)&&(t=b);for(var e=-1,u=Df(n),i=u.length,o={};++e<i;){var f=u[e],a=n[f];t?no.call(o,a)?o[a].push(f):o[a]=[f]:o[a]=f}return o}function ni(n){if(null==n)return[];Wu(n)||(n=Vi(n));var t=n.length;t=t&&re(t)&&(Cf(n)||ku(n))&&t||0;for(var r=n.constructor,e=-1,u="function"==typeof r&&r.prototype===n,i=zi(t),o=t>0;++e<t;)i[e]=e+"";for(var f in n)o&&Hr(f,t)||"constructor"==f&&(u||!no.call(n,f))||i.push(f);return i}function ti(n){n=se(n);for(var t=-1,r=Df(n),e=r.length,u=zi(e);++t<e;){var i=r[t];u[t]=[i,n[i]]}return u}function ri(n,t,r){var e=null==n?b:n[t];return e===b&&(null==n||ne(t,n)||(t=pe(t),n=1==t.length?n:Ft(n,Jt(t,0,-1)),e=null==n?b:n[Ie(t)]),e=e===b?r:e),Su(e)?e.call(n):e}function ei(n,t,r){if(null==n)return n;var e=t+"";t=null!=n[e]||ne(t,n)?[e]:pe(t);for(var u=-1,i=t.length,o=i-1,f=n;null!=f&&++u<i;){var a=t[u];Wu(f)&&(u==o?f[a]=r:null==f[a]&&(f[a]=Hr(t[u+1])?[]:{})),f=f[a]}return n}function ui(n,t,r,e){var u=Cf(n)||Mu(n);if(t=Dr(t,e,4),null==r)if(u||Wu(n)){var i=n.constructor;r=u?Cf(n)?new i:[]:Fo(Su(i)?i.prototype:b)}else r={};return(u?ut:$t)(n,function(n,e,u){return t(r,n,e,u)}),r}function ii(n){return tr(n,Df(n))}function oi(n){return tr(n,ni(n))}function fi(n,t,r){return t=+t||0,r===b?(r=t,t=0):r=+r||0,n>=Ao(t,r)&&n<bo(t,r)}function ai(n,t,r){r&&Qr(n,t,r)&&(t=r=b);var e=null==n,u=null==t;if(null==r&&(u&&"boolean"==typeof n?(r=n,n=1):"boolean"==typeof t&&(r=t,u=!0)),e&&u&&(t=1,u=!1),n=+n||0,u?(t=n,n=0):t=+t||0,r||n%1||t%1){var i=Io();return Ao(n+i*(t-n+fo("1e-"+((i+"").length-1))),t)}return Yt(n,t)}function ci(n){return n=u(n),n&&n.charAt(0).toUpperCase()+n.slice(1)}function li(n){
return n=u(n),n&&n.replace(Wn,c).replace(Rn,"")}function si(n,t,r){n=u(n),t+="";var e=n.length;return r=r===b?e:Ao(0>r?0:+r||0,e),r-=t.length,r>=0&&n.indexOf(t,r)==r}function pi(n){return n=u(n),n&&dn.test(n)?n.replace(gn,l):n}function hi(n){return n=u(n),n&&In.test(n)?n.replace(kn,s):n||"(?:)"}function vi(n,t,r){n=u(n),t=+t;var e=n.length;if(e>=t||!wo(t))return n;var i=(t-e)/2,o=yo(i),f=_o(i);return r=Sr("",f,r),r.slice(0,o)+n+r}function _i(n,t,r){return(r?Qr(n,t,r):null==t)?t=0:t&&(t=+t),n=mi(n),ko(n,t||(Un.test(n)?16:10))}function gi(n,t){var r="";if(n=u(n),t=+t,1>t||!n||!wo(t))return r;do t%2&&(r+=n),t=yo(t/2),n+=n;while(t);return r}function yi(n,t,r){return n=u(n),r=null==r?0:Ao(0>r?0:+r||0,n.length),n.lastIndexOf(t,r)==r}function di(n,t,r){var e=G.templateSettings;r&&Qr(n,t,r)&&(t=r=b),n=u(n),t=yt(dt({},r||t),e,gt);var i,o,f=yt(dt({},t.imports),e.imports,gt),a=Df(f),c=tr(f,a),l=0,s=t.interpolate||Fn,h="__p += '",v=Yi((t.escape||Fn).source+"|"+s.source+"|"+(s===xn?En:Fn).source+"|"+(t.evaluate||Fn).source+"|$","g"),_="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Bn+"]")+"\n";n.replace(v,function(t,r,e,u,f,a){return e||(e=u),h+=n.slice(l,a).replace(Nn,p),r&&(i=!0,h+="' +\n__e("+r+") +\n'"),f&&(o=!0,h+="';\n"+f+";\n__p += '"),e&&(h+="' +\n((__t = ("+e+")) == null ? '' : __t) +\n'"),l=a+t.length,t}),h+="';\n";var g=t.variable;g||(h="with (obj) {\n"+h+"\n}\n"),h=(o?h.replace(pn,""):h).replace(hn,"$1").replace(vn,"$1;"),h="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var y=Hf(function(){return Mi(a,_+"return "+h).apply(b,c)});if(y.source=h,Uu(y))throw y;return y}function mi(n,t,r){var e=n;return(n=u(n))?(r?Qr(e,t,r):null==t)?n.slice(d(n),m(n)+1):(t+="",n.slice(i(n,t),o(n,t)+1)):n}function wi(n,t,r){var e=n;return n=u(n),n?(r?Qr(e,t,r):null==t)?n.slice(d(n)):n.slice(i(n,t+"")):n}function xi(n,t,r){var e=n;return n=u(n),n?(r?Qr(e,t,r):null==t)?n.slice(0,m(n)+1):n.slice(0,o(n,t+"")+1):n}function bi(n,t,r){r&&Qr(n,t,r)&&(t=b);var e=S,i=W;if(null!=t)if(Wu(t)){var o="separator"in t?t.separator:o;e="length"in t?+t.length||0:e,i="omission"in t?u(t.omission):i}else e=+t||0;if(n=u(n),e>=n.length)return n;var f=e-i.length;if(1>f)return i;var a=n.slice(0,f);if(null==o)return a+i;if(Du(o)){if(n.slice(f).search(o)){var c,l,s=n.slice(0,f);for(o.global||(o=Yi(o.source,(Cn.exec(o)||"")+"g")),o.lastIndex=0;c=o.exec(s);)l=c.index;a=a.slice(0,null==l?f:l)}}else if(n.indexOf(o,f)!=f){var p=a.lastIndexOf(o);p>-1&&(a=a.slice(0,p))}return a+i}function Ai(n){return n=u(n),n&&yn.test(n)?n.replace(_n,w):n}function ji(n,t,r){return r&&Qr(n,t,r)&&(t=b),n=u(n),n.match(t||Tn)||[]}function ki(n,t,r){return r&&Qr(n,t,r)&&(t=b),v(n)?Oi(n):xt(n,t)}function Ii(n){return function(){return n}}function Ri(n){return n}function Oi(n){return zt(bt(n,!0))}function Ei(n,t){return Dt(n,bt(t,!0))}function Ci(n,t,r){if(null==r){var e=Wu(t),u=e?Df(t):b,i=u&&u.length?Wt(t,u):b;(i?i.length:e)||(i=!1,r=t,t=n,n=this)}i||(i=Wt(t,Df(t)));var o=!0,f=-1,a=Su(n),c=i.length;r===!1?o=!1:Wu(r)&&"chain"in r&&(o=r.chain);for(;++f<c;){var l=i[f],s=t[l];n[l]=s,a&&(n.prototype[l]=function(t){return function(){var r=this.__chain__;if(o||r){var e=n(this.__wrapped__),u=e.__actions__=et(this.__actions__);return u.push({func:t,args:arguments,thisArg:n}),e.__chain__=r,e}return t.apply(n,lt([this.value()],arguments))}}(s))}return n}function Ui(){return nt._=eo,this}function $i(){}function Si(n){return ne(n)?Pt(n):Kt(n)}function Wi(n){return function(t){return Ft(n,pe(t),t+"")}}function Fi(n,t,r){r&&Qr(n,t,r)&&(t=r=b),n=+n||0,r=null==r?1:+r||0,null==t?(t=n,n=0):t=+t||0;for(var e=-1,u=bo(_o((t-n)/(r||1)),0),i=zi(u);++e<u;)i[e]=n,n+=r;return i}function Ni(n,t,r){if(n=yo(n),1>n||!wo(n))return[];var e=-1,u=zi(Ao(n,Eo));for(t=or(t,r,1);++e<n;)Eo>e?u[e]=t(e):t(e);return u}function Ti(n){var t=++to;return u(n)+t}function Li(n,t){return(+n||0)+(+t||0)}function Bi(n,t,r){return r&&Qr(n,t,r)&&(t=b),t=Dr(t,r,3),1==t.length?vt(Cf(n)?n:le(n),t):Qt(n,t)}_=_?tt.defaults(nt.Object(),_,tt.pick(nt,Ln)):nt;var zi=_.Array,Di=_.Date,qi=_.Error,Mi=_.Function,Pi=_.Math,Ki=_.Number,Vi=_.Object,Yi=_.RegExp,Gi=_.String,Ji=_.TypeError,Xi=zi.prototype,Zi=Vi.prototype,Hi=Gi.prototype,Qi=Mi.prototype.toString,no=Zi.hasOwnProperty,to=0,ro=Zi.toString,eo=nt._,uo=Yi("^"+Qi.call(no).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),io=_.ArrayBuffer,oo=_.clearTimeout,fo=_.parseFloat,ao=Pi.pow,co=Zi.propertyIsEnumerable,lo=Kr(_,"Set"),so=_.setTimeout,po=Xi.splice,ho=_.Uint8Array,vo=Kr(_,"WeakMap"),_o=Pi.ceil,go=Kr(Vi,"create"),yo=Pi.floor,mo=Kr(zi,"isArray"),wo=_.isFinite,xo=Kr(Vi,"keys"),bo=Pi.max,Ao=Pi.min,jo=Kr(Di,"now"),ko=_.parseInt,Io=Pi.random,Ro=Ki.NEGATIVE_INFINITY,Oo=Ki.POSITIVE_INFINITY,Eo=4294967295,Co=Eo-1,Uo=Eo>>>1,$o=9007199254740991,So=vo&&new vo,Wo={};G.support={};G.templateSettings={escape:mn,evaluate:wn,interpolate:xn,variable:"",imports:{_:G}};var Fo=function(){function n(){}return function(t){if(Wu(t)){n.prototype=t;var r=new n;n.prototype=b}return r||{}}}(),No=pr($t),To=pr(St,!0),Lo=hr(),Bo=hr(!0),zo=So?function(n,t){return So.set(n,t),n}:Ri,Do=So?function(n){return So.get(n)}:$i,qo=Pt("length"),Mo=function(){var n=0,t=0;return function(r,e){var u=gf(),i=N-(u-t);if(t=u,i>0){if(++n>=F)return r}else n=0;return zo(r,e)}}(),Po=yu(function(n,t){return v(n)&&Zr(n)?jt(n,Ct(t,!1,!0)):[]}),Ko=br(),Vo=br(!0),Yo=yu(function(n){for(var t=n.length,e=t,u=zi(s),i=Mr(),o=i==r,f=[];e--;){var a=n[e]=Zr(a=n[e])?a:[];u[e]=o&&a.length>=120?_r(e&&a):null}var c=n[0],l=-1,s=c?c.length:0,p=u[0];n:for(;++l<s;)if(a=c[l],(p?Hn(p,a):i(f,a,0))<0){for(var e=t;--e;){var h=u[e];if((h?Hn(h,a):i(n[e],a,0))<0)continue n}p&&p.push(a),f.push(a)}return f}),Go=yu(function(t,r){r=Ct(r);var e=mt(t,r);return Vt(t,r.sort(n)),e}),Jo=Nr(),Xo=Nr(!0),Zo=yu(function(n){return nr(Ct(n,!1,!0))}),Ho=yu(function(n,t){return Zr(n)?jt(n,t):[]}),Qo=yu(Te),nf=yu(function(n){var t=n.length,r=t>2?n[t-2]:b,e=t>1?n[t-1]:b;return t>2&&"function"==typeof r?t-=2:(r=t>1&&"function"==typeof e?(--t,e):b,e=b),n.length=t,Le(n,r,e)}),tf=yu(function(n){return n=Ct(n),this.thru(function(t){return rt(Cf(t)?t:[se(t)],n)})}),rf=yu(function(n,t){return mt(n,Ct(t))}),ef=lr(function(n,t,r){no.call(n,r)?++n[r]:n[r]=1}),uf=xr(No),of=xr(To,!0),ff=kr(ut,No),af=kr(it,To),cf=lr(function(n,t,r){no.call(n,r)?n[r].push(t):n[r]=[t]}),lf=lr(function(n,t,r){n[r]=t}),sf=yu(function(n,t,r){var e=-1,u="function"==typeof t,i=ne(t),o=Zr(n)?zi(n.length):[];return No(n,function(n){var f=u?t:i&&null!=n?n[t]:b;o[++e]=f?f.apply(n,r):Xr(n,t,r)}),o}),pf=lr(function(n,t,r){n[r?0:1].push(t)},function(){return[[],[]]}),hf=Ur(st,No),vf=Ur(pt,To),_f=yu(function(n,t){if(null==n)return[];var r=t[2];return r&&Qr(t[0],t[1],r)&&(t.length=1),Ht(n,Ct(t),[])}),gf=jo||function(){return(new Di).getTime()},yf=yu(function(n,t,r){var e=j;if(r.length){var u=g(r,yf.placeholder);e|=E}return Tr(n,e,t,r,u)}),df=yu(function(n,t){t=t.length?Ct(t):Xu(n);for(var r=-1,e=t.length;++r<e;){var u=t[r];n[u]=Tr(n[u],j,n)}return n}),mf=yu(function(n,t,r){var e=j|k;if(r.length){var u=g(r,mf.placeholder);e|=E}return Tr(t,e,n,r,u)}),wf=dr(R),xf=dr(O),bf=yu(function(n,t){return At(n,1,t)}),Af=yu(function(n,t,r){return At(n,t,r)}),jf=jr(),kf=jr(!0),If=yu(function(n,t){if(t=Ct(t),"function"!=typeof n||!ot(t,e))throw new Ji(z);var r=t.length;return yu(function(e){for(var u=Ao(e.length,r);u--;)e[u]=t[u](e[u]);return n.apply(this,e)})}),Rf=Cr(E),Of=Cr(C),Ef=yu(function(n,t){return Tr(n,$,b,b,b,Ct(t))}),Cf=mo||function(n){return v(n)&&re(n.length)&&ro.call(n)==M},Uf=sr(qt),$f=sr(function(n,t,r){return r?yt(n,t,r):dt(n,t)}),Sf=mr($f,_t),Wf=mr(Uf,ie),Ff=Ar($t),Nf=Ar(St),Tf=Ir(Lo),Lf=Ir(Bo),Bf=Rr($t),zf=Rr(St),Df=xo?function(n){var t=null==n?b:n.constructor;return"function"==typeof t&&t.prototype===n||"function"!=typeof n&&Zr(n)?ce(n):Wu(n)?xo(n):[]}:ce,qf=Or(!0),Mf=Or(),Pf=yu(function(n,t){if(null==n)return{};if("function"!=typeof t[0]){var t=ct(Ct(t),Gi);return oe(n,jt(ni(n),t))}var r=or(t[0],t[1],3);return fe(n,function(n,t,e){return!r(n,t,e)})}),Kf=yu(function(n,t){return null==n?{}:"function"==typeof t[0]?fe(n,or(t[0],t[1],3)):oe(n,Ct(t))}),Vf=gr(function(n,t,r){return t=t.toLowerCase(),n+(r?t.charAt(0).toUpperCase()+t.slice(1):t)}),Yf=gr(function(n,t,r){return n+(r?"-":"")+t.toLowerCase()}),Gf=Er(),Jf=Er(!0),Xf=gr(function(n,t,r){return n+(r?"_":"")+t.toLowerCase()}),Zf=gr(function(n,t,r){return n+(r?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}),Hf=yu(function(n,t){try{return n.apply(b,t)}catch(r){return Uu(r)?r:new qi(r)}}),Qf=yu(function(n,t){return function(r){return Xr(r,n,t)}}),na=yu(function(n,t){return function(r){return Xr(n,r,t)}}),ta=Fr("ceil"),ra=Fr("floor"),ea=wr(Au,Ro),ua=wr(Ku,Oo),ia=Fr("round");return G.prototype=H.prototype,nn.prototype=Fo(H.prototype),nn.prototype.constructor=nn,qn.prototype=Fo(H.prototype),qn.prototype.constructor=qn,Vn.prototype["delete"]=Yn,Vn.prototype.get=Gn,Vn.prototype.has=Jn,Vn.prototype.set=Xn,Zn.prototype.push=Qn,vu.Cache=Vn,G.after=lu,G.ary=su,G.assign=$f,G.at=rf,G.before=pu,G.bind=yf,G.bindAll=df,G.bindKey=mf,G.callback=ki,G.chain=De,G.chunk=ve,G.compact=_e,G.constant=Ii,G.countBy=ef,G.create=Ju,G.curry=wf,G.curryRight=xf,G.debounce=hu,G.defaults=Sf,G.defaultsDeep=Wf,G.defer=bf,G.delay=Af,G.difference=Po,G.drop=ge,G.dropRight=ye,G.dropRightWhile=de,G.dropWhile=me,G.fill=we,G.filter=Ze,G.flatten=be,G.flattenDeep=Ae,G.flow=jf,G.flowRight=kf,G.forEach=ff,G.forEachRight=af,G.forIn=Tf,G.forInRight=Lf,G.forOwn=Bf,G.forOwnRight=zf,G.functions=Xu,G.groupBy=cf,G.indexBy=lf,G.initial=ke,G.intersection=Yo,G.invert=Qu,G.invoke=sf,G.keys=Df,G.keysIn=ni,G.map=nu,G.mapKeys=qf,G.mapValues=Mf,G.matches=Oi,G.matchesProperty=Ei,G.memoize=vu,G.merge=Uf,G.method=Qf,G.methodOf=na,G.mixin=Ci,G.modArgs=If,G.negate=_u,G.omit=Pf,G.once=gu,G.pairs=ti,G.partial=Rf,G.partialRight=Of,G.partition=pf,G.pick=Kf,G.pluck=tu,G.property=Si,G.propertyOf=Wi,G.pull=Oe,G.pullAt=Go,G.range=Fi,G.rearg=Ef,G.reject=ru,G.remove=Ee,G.rest=Ce,G.restParam=yu,G.set=ei,G.shuffle=uu,G.slice=Ue,G.sortBy=fu,G.sortByAll=_f,G.sortByOrder=au,G.spread=du,G.take=$e,G.takeRight=Se,G.takeRightWhile=We,G.takeWhile=Fe,G.tap=qe,G.throttle=mu,G.thru=Me,G.times=Ni,G.toArray=Yu,G.toPlainObject=Gu,G.transform=ui,G.union=Zo,G.uniq=Ne,G.unzip=Te,G.unzipWith=Le,G.values=ii,G.valuesIn=oi,G.where=cu,G.without=Ho,G.wrap=wu,G.xor=Be,G.zip=Qo,G.zipObject=ze,G.zipWith=nf,G.backflow=kf,G.collect=nu,G.compose=kf,G.each=ff,G.eachRight=af,G.extend=$f,G.iteratee=ki,G.methods=Xu,G.object=ze,G.select=Ze,G.tail=Ce,G.unique=Ne,Ci(G,G),G.add=Li,G.attempt=Hf,G.camelCase=Vf,G.capitalize=ci,G.ceil=ta,G.clone=xu,G.cloneDeep=bu,G.deburr=li,G.endsWith=si,G.escape=pi,G.escapeRegExp=hi,G.every=Xe,G.find=uf,G.findIndex=Ko,G.findKey=Ff,G.findLast=of,G.findLastIndex=Vo,G.findLastKey=Nf,G.findWhere=He,G.first=xe,G.floor=ra,G.get=Zu,G.gt=Au,G.gte=ju,G.has=Hu,G.identity=Ri,G.includes=Qe,G.indexOf=je,G.inRange=fi,G.isArguments=ku,G.isArray=Cf,G.isBoolean=Iu,G.isDate=Ru,G.isElement=Ou,G.isEmpty=Eu,G.isEqual=Cu,G.isError=Uu,G.isFinite=$u,G.isFunction=Su,G.isMatch=Fu,G.isNaN=Nu,G.isNative=Tu,G.isNull=Lu,G.isNumber=Bu,G.isObject=Wu,G.isPlainObject=zu,G.isRegExp=Du,G.isString=qu,G.isTypedArray=Mu,G.isUndefined=Pu,G.kebabCase=Yf,G.last=Ie,G.lastIndexOf=Re,G.lt=Ku,G.lte=Vu,G.max=ea,G.min=ua,G.noConflict=Ui,G.noop=$i,G.now=gf,G.pad=vi,G.padLeft=Gf,G.padRight=Jf,G.parseInt=_i,G.random=ai,G.reduce=hf,G.reduceRight=vf,G.repeat=gi,G.result=ri,G.round=ia,G.runInContext=x,G.size=iu,G.snakeCase=Xf,G.some=ou,G.sortedIndex=Jo,G.sortedLastIndex=Xo,G.startCase=Zf,G.startsWith=yi,G.sum=Bi,G.template=di,G.trim=mi,G.trimLeft=wi,G.trimRight=xi,G.trunc=bi,G.unescape=Ai,G.uniqueId=Ti,G.words=ji,G.all=Xe,G.any=ou,G.contains=Qe,G.eq=Cu,G.detect=uf,G.foldl=hf,G.foldr=vf,G.head=xe,G.include=Qe,G.inject=hf,Ci(G,function(){var n={};return $t(G,function(t,r){G.prototype[r]||(n[r]=t)}),n}(),!1),G.sample=eu,G.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(t){return eu(t,n)}):eu(this.value())},G.VERSION=A,ut(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){G[n].placeholder=G}),ut(["drop","take"],function(n,t){qn.prototype[n]=function(r){var e=this.__filtered__;if(e&&!t)return new qn(this);r=null==r?1:bo(yo(r)||0,0);var u=this.clone();return e?u.__takeCount__=Ao(u.__takeCount__,r):u.__views__.push({size:r,type:n+(u.__dir__<0?"Right":"")}),u},qn.prototype[n+"Right"]=function(t){return this.reverse()[n](t).reverse()}}),ut(["filter","map","takeWhile"],function(n,t){var r=t+1,e=r!=B;qn.prototype[n]=function(n,t){var u=this.clone();return u.__iteratees__.push({iteratee:Dr(n,t,1),type:r}),u.__filtered__=u.__filtered__||e,u}}),ut(["first","last"],function(n,t){var r="take"+(t?"Right":"");qn.prototype[n]=function(){return this[r](1).value()[0]}}),ut(["initial","rest"],function(n,t){var r="drop"+(t?"":"Right");qn.prototype[n]=function(){return this.__filtered__?new qn(this):this[r](1)}}),ut(["pluck","where"],function(n,t){var r=t?"filter":"map",e=t?zt:Si;qn.prototype[n]=function(n){return this[r](e(n))}}),qn.prototype.compact=function(){return this.filter(Ri)},qn.prototype.reject=function(n,t){return n=Dr(n,t,1),this.filter(function(t){return!n(t)})},qn.prototype.slice=function(n,t){n=null==n?0:+n||0;var r=this;return r.__filtered__&&(n>0||0>t)?new qn(r):(0>n?r=r.takeRight(-n):n&&(r=r.drop(n)),t!==b&&(t=+t||0,r=0>t?r.dropRight(-t):r.take(t-n)),r)},qn.prototype.takeRightWhile=function(n,t){return this.reverse().takeWhile(n,t).reverse()},qn.prototype.toArray=function(){return this.take(Oo)},$t(qn.prototype,function(n,t){var r=/^(?:filter|map|reject)|While$/.test(t),e=/^(?:first|last)$/.test(t),u=G[e?"take"+("last"==t?"Right":""):t];u&&(G.prototype[t]=function(){var t=e?[1]:arguments,i=this.__chain__,o=this.__wrapped__,f=!!this.__actions__.length,a=o instanceof qn,c=t[0],l=a||Cf(o);l&&r&&"function"==typeof c&&1!=c.length&&(a=l=!1);var s=function(n){return e&&i?u(n,1)[0]:u.apply(b,lt([n],t))},p={func:Me,args:[s],thisArg:b},h=a&&!f;if(e&&!i)return h?(o=o.clone(),o.__actions__.push(p),n.call(o)):u.call(b,this.value())[0];if(!e&&l){o=h?o:new qn(this);var v=n.apply(o,t);return v.__actions__.push(p),new nn(v,i)}return this.thru(s)})}),ut(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(n){var t=(/^(?:replace|split)$/.test(n)?Hi:Xi)[n],r=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",e=/^(?:join|pop|replace|shift)$/.test(n);G.prototype[n]=function(){var n=arguments;return e&&!this.__chain__?t.apply(this.value(),n):this[r](function(r){return t.apply(r,n)})}}),$t(qn.prototype,function(n,t){var r=G[t];if(r){var e=r.name,u=Wo[e]||(Wo[e]=[]);u.push({name:t,func:r})}}),Wo[$r(b,k).name]=[{name:"wrapper",func:b}],qn.prototype.clone=Mn,qn.prototype.reverse=Pn,qn.prototype.value=Kn,G.prototype.chain=Pe,G.prototype.commit=Ke,G.prototype.concat=tf,G.prototype.plant=Ve,G.prototype.reverse=Ye,G.prototype.toString=Ge,G.prototype.run=G.prototype.toJSON=G.prototype.valueOf=G.prototype.value=Je,G.prototype.collect=G.prototype.map,G.prototype.head=G.prototype.first,G.prototype.select=G.prototype.filter,G.prototype.tail=G.prototype.rest,G}var b,A="3.10.1",j=1,k=2,I=4,R=8,O=16,E=32,C=64,U=128,$=256,S=30,W="...",F=150,N=16,T=200,L=1,B=2,z="Expected a function",D="__lodash_placeholder__",q="[object Arguments]",M="[object Array]",P="[object Boolean]",K="[object Date]",V="[object Error]",Y="[object Function]",G="[object Map]",J="[object Number]",X="[object Object]",Z="[object RegExp]",H="[object Set]",Q="[object String]",nn="[object WeakMap]",tn="[object ArrayBuffer]",rn="[object Float32Array]",en="[object Float64Array]",un="[object Int8Array]",on="[object Int16Array]",fn="[object Int32Array]",an="[object Uint8Array]",cn="[object Uint8ClampedArray]",ln="[object Uint16Array]",sn="[object Uint32Array]",pn=/\b__p \+= '';/g,hn=/\b(__p \+=) '' \+/g,vn=/(__e\(.*?\)|\b__t\)) \+\n'';/g,_n=/&(?:amp|lt|gt|quot|#39|#96);/g,gn=/[&<>"'`]/g,yn=RegExp(_n.source),dn=RegExp(gn.source),mn=/<%-([\s\S]+?)%>/g,wn=/<%([\s\S]+?)%>/g,xn=/<%=([\s\S]+?)%>/g,bn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,An=/^\w*$/,jn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,kn=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,In=RegExp(kn.source),Rn=/[\u0300-\u036f\ufe20-\ufe23]/g,On=/\\(\\)?/g,En=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Cn=/\w*$/,Un=/^0[xX]/,$n=/^\[object .+?Constructor\]$/,Sn=/^\d+$/,Wn=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Fn=/($^)/,Nn=/['\n\r\u2028\u2029\\]/g,Tn=function(){var n="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(n+"+(?="+n+t+")|"+n+"?"+t+"|"+n+"+|[0-9]+","g")}(),Ln=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Bn=-1,zn={};zn[rn]=zn[en]=zn[un]=zn[on]=zn[fn]=zn[an]=zn[cn]=zn[ln]=zn[sn]=!0,zn[q]=zn[M]=zn[tn]=zn[P]=zn[K]=zn[V]=zn[Y]=zn[G]=zn[J]=zn[X]=zn[Z]=zn[H]=zn[Q]=zn[nn]=!1;var Dn={};Dn[q]=Dn[M]=Dn[tn]=Dn[P]=Dn[K]=Dn[rn]=Dn[en]=Dn[un]=Dn[on]=Dn[fn]=Dn[J]=Dn[X]=Dn[Z]=Dn[Q]=Dn[an]=Dn[cn]=Dn[ln]=Dn[sn]=!0,Dn[V]=Dn[Y]=Dn[G]=Dn[H]=Dn[nn]=!1;var qn={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},Mn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},Pn={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Kn={"function":!0,object:!0},Vn={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Yn={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Gn=Kn[typeof exports]&&exports&&!exports.nodeType&&exports,Jn=Kn[typeof module]&&module&&!module.nodeType&&module,Xn=Gn&&Jn&&"object"==typeof global&&global&&global.Object&&global,Zn=Kn[typeof self]&&self&&self.Object&&self,Hn=Kn[typeof window]&&window&&window.Object&&window,Qn=Jn&&Jn.exports===Gn&&Gn,nt=Xn||Hn!==(this&&this.window)&&Hn||Zn||this,tt=x();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(nt._=tt,define(function(){return tt})):Gn&&Jn?Qn?(Jn.exports=tt)._=tt:Gn._=tt:nt._=tt}).call(this);


}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],5:[function(require,module,exports){
function blur(r,t,a,n){if(!(isNaN(n)||1>n)){n|=0;var e,l,b,f,g,o,u,x,i,s,h,c,v,_,k,m,B,S,w,N,d,p,j,q,y=n+n+1,z=t-1,A=a-1,C=n+1,D=C*(C+1)/2,E=new BlurStack,F=E;for(b=1;y>b;b++)if(F=F.next=new BlurStack,b==C)var G=F;F.next=E;var H=null,I=null;u=o=0;var J=mul_table[n],K=shg_table[n];for(l=0;a>l;l++){for(m=B=S=w=x=i=s=h=0,c=C*(N=r[o]),v=C*(d=r[o+1]),_=C*(p=r[o+2]),k=C*(j=r[o+3]),x+=D*N,i+=D*d,s+=D*p,h+=D*j,F=E,b=0;C>b;b++)F.r=N,F.g=d,F.b=p,F.a=j,F=F.next;for(b=1;C>b;b++)f=o+((b>z?z:b)<<2),x+=(F.r=N=r[f])*(q=C-b),i+=(F.g=d=r[f+1])*q,s+=(F.b=p=r[f+2])*q,h+=(F.a=j=r[f+3])*q,m+=N,B+=d,S+=p,w+=j,F=F.next;for(H=E,I=G,e=0;t>e;e++)r[o+3]=j=h*J>>K,0!=j?(j=255/j,r[o]=(x*J>>K)*j,r[o+1]=(i*J>>K)*j,r[o+2]=(s*J>>K)*j):r[o]=r[o+1]=r[o+2]=0,x-=c,i-=v,s-=_,h-=k,c-=H.r,v-=H.g,_-=H.b,k-=H.a,f=u+((f=e+n+1)<z?f:z)<<2,m+=H.r=r[f],B+=H.g=r[f+1],S+=H.b=r[f+2],w+=H.a=r[f+3],x+=m,i+=B,s+=S,h+=w,H=H.next,c+=N=I.r,v+=d=I.g,_+=p=I.b,k+=j=I.a,m-=N,B-=d,S-=p,w-=j,I=I.next,o+=4;u+=t}for(e=0;t>e;e++){for(B=S=w=m=i=s=h=x=0,o=e<<2,c=C*(N=r[o]),v=C*(d=r[o+1]),_=C*(p=r[o+2]),k=C*(j=r[o+3]),x+=D*N,i+=D*d,s+=D*p,h+=D*j,F=E,b=0;C>b;b++)F.r=N,F.g=d,F.b=p,F.a=j,F=F.next;for(g=t,b=1;n>=b;b++)o=g+e<<2,x+=(F.r=N=r[o])*(q=C-b),i+=(F.g=d=r[o+1])*q,s+=(F.b=p=r[o+2])*q,h+=(F.a=j=r[o+3])*q,m+=N,B+=d,S+=p,w+=j,F=F.next,A>b&&(g+=t);for(o=e,H=E,I=G,l=0;a>l;l++)f=o<<2,r[f+3]=j=h*J>>K,j>0?(j=255/j,r[f]=(x*J>>K)*j,r[f+1]=(i*J>>K)*j,r[f+2]=(s*J>>K)*j):r[f]=r[f+1]=r[f+2]=0,x-=c,i-=v,s-=_,h-=k,c-=H.r,v-=H.g,_-=H.b,k-=H.a,f=e+((f=l+C)<A?f:A)*t<<2,x+=m+=H.r=r[f],i+=B+=H.g=r[f+1],s+=S+=H.b=r[f+2],h+=w+=H.a=r[f+3],H=H.next,c+=N=I.r,v+=d=I.g,_+=p=I.b,k+=j=I.a,m-=N,B-=d,S-=p,w-=j,I=I.next,o+=t}}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}var mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];module.exports=blur;


},{}],6:[function(require,module,exports){
function DOMParser(t){this.options=t||{locator:{}}}function buildErrorHandler(t,e,n){function r(e){var r=t[e];if(!r)if(i)r=2==t.length?function(n){t(e,n)}:t;else for(var a=arguments.length;--a&&!(r=t[arguments[a]]););o[e]=r&&function(t){r(t+_locator(n))}||function(){}}if(!t){if(e instanceof DOMHandler)return e;t=e}var o={},i=t instanceof Function;return n=n||{},r("warning","warn"),r("error","warn","warning"),r("fatalError","warn","warning","error"),o}function DOMHandler(){this.cdata=!1}function position(t,e){e.lineNumber=t.lineNumber,e.columnNumber=t.columnNumber}function _locator(t){return t?"\n@"+(t.systemId||"")+"#[line:"+t.lineNumber+",col:"+t.columnNumber+"]":void 0}function _toString(t,e,n){return"string"==typeof t?t.substr(e,n):t.length>=e+n||e?new java.lang.String(t,e,n)+"":t}function appendElement(t,e){t.currentElement?t.currentElement.appendChild(e):t.document.appendChild(e)}if(DOMParser.prototype.parseFromString=function(t,e){var n=this.options,r=new XMLReader,o=n.domBuilder||new DOMHandler,i=n.errorHandler,a=n.locator,c=n.xmlns||{},l={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return a&&o.setDocumentLocator(a),r.errorHandler=buildErrorHandler(i,o,a),r.domBuilder=n.domBuilder||o,/\/x?html?$/.test(e)&&(l.nbsp="",l.copy="",c[""]="http://www.w3.org/1999/xhtml"),t?r.parse(t,c,l):r.errorHandler.error("invalid document source"),o.document},DOMHandler.prototype={startDocument:function(){this.document=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.document.documentURI=this.locator.systemId)},startElement:function(t,e,n,r){var o=this.document,i=o.createElementNS(t,n||e),a=r.length;appendElement(this,i),this.currentElement=i,this.locator&&position(this.locator,i);for(var c=0;a>c;c++){var t=r.getURI(c),l=r.getValue(c),n=r.getQName(c),s=o.createAttributeNS(t,n);s.getOffset&&position(s.getOffset(1),s),s.value=s.nodeValue=l,i.setAttributeNode(s)}},endElement:function(t,e,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(t,e){},endPrefixMapping:function(t){},processingInstruction:function(t,e){var n=this.document.createProcessingInstruction(t,e);this.locator&&position(this.locator,n),appendElement(this,n)},ignorableWhitespace:function(t,e,n){},characters:function(t,e,n){if(t=_toString.apply(this,arguments),this.currentElement&&t){if(this.cdata){var r=this.document.createCDATASection(t);this.currentElement.appendChild(r)}else{var r=this.document.createTextNode(t);this.currentElement.appendChild(r)}this.locator&&position(this.locator,r)}},skippedEntity:function(t){},endDocument:function(){this.document.normalize()},setDocumentLocator:function(t){(this.locator=t)&&(t.lineNumber=0)},comment:function(t,e,n){t=_toString.apply(this,arguments);var r=this.document.createComment(t);this.locator&&position(this.locator,r),appendElement(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(t,e,n){var r=this.document.implementation;if(r&&r.createDocumentType){var o=r.createDocumentType(t,e,n);this.locator&&position(this.locator,o),appendElement(this,o)}},warning:function(t){console.warn(t,_locator(this.locator))},error:function(t){console.error(t,_locator(this.locator))},fatalError:function(t){throw console.error(t,_locator(this.locator)),t}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(t){DOMHandler.prototype[t]=function(){return null}}),"function"==typeof require){var XMLReader=require("./sax").XMLReader,DOMImplementation=exports.DOMImplementation=require("./dom").DOMImplementation;exports.XMLSerializer=require("./dom").XMLSerializer,exports.DOMParser=DOMParser}


},{"./dom":7,"./sax":8}],7:[function(require,module,exports){
function copy(e,t){for(var n in e)t[n]=e[n]}function _extends(e,t){function n(){}var o=e.prototype;if(Object.create){var i=Object.create(t.prototype);o.__proto__=i}o instanceof t||(n.prototype=t.prototype,n=new n,copy(o,n),e.prototype=o=n),o.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),o.constructor=e)}function DOMException(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,ExceptionMessage[e]),this.message=ExceptionMessage[e],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return n.code=e,t&&(this.message=this.message+": "+t),n}function NodeList(){}function LiveNodeList(e,t){this._node=e,this._refresh=t,_updateLiveList(this)}function _updateLiveList(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var n=e._refresh(e._node);__set__(e,"length",n.length),copy(n,e),e._inc=t}}function NamedNodeMap(){}function _findNodeIndex(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function _addNamedNode(e,t,n,o){if(o?t[_findNodeIndex(t,o)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(o&&_onRemoveAttribute(i,e,o),_onAddAttribute(i,e,n))}}function _removeNamedNode(e,t,n){var o=_findNodeIndex(t,n);if(!(o>=0))throw DOMException(NOT_FOUND_ERR,new Error);for(var i=t.length-1;i>o;)t[o]=t[++o];if(t.length=i,e){var r=e.ownerDocument;r&&(_onRemoveAttribute(r,e,n),n.ownerElement=null)}}function DOMImplementation(e){if(this._features={},e)for(var t in e)this._features=e[t]}function Node(){}function _xmlEncoder(e){return"<"==e&&"&lt;"||">"==e&&"&gt;"||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function _visitNode(e,t){if(t(e))return!0;if(e=e.firstChild)do if(_visitNode(e,t))return!0;while(e=e.nextSibling)}function Document(){}function _onAddAttribute(e,t,n){e&&e._inc++;var o=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==o&&(t._nsMap[n.prefix?n.localName:""]=n.value)}function _onRemoveAttribute(e,t,n,o){e&&e._inc++;var i=n.namespaceURI;"http://www.w3.org/2000/xmlns/"==i&&delete t._nsMap[n.prefix?n.localName:""]}function _onUpdateChild(e,t,n){if(e&&e._inc){e._inc++;var o=t.childNodes;if(n)o[o.length++]=n;else{for(var i=t.firstChild,r=0;i;)o[r++]=i,i=i.nextSibling;o.length=r}}}function _removeChild(e,t){var n=t.previousSibling,o=t.nextSibling;return n?n.nextSibling=o:e.firstChild=o,o?o.previousSibling=n:e.lastChild=n,_onUpdateChild(e.ownerDocument,e),t}function _insertBefore(e,t,n){var o=t.parentNode;if(o&&o.removeChild(t),t.nodeType===DOCUMENT_FRAGMENT_NODE){var i=t.firstChild;if(null==i)return t;var r=t.lastChild}else i=r=t;var a=n?n.previousSibling:e.lastChild;i.previousSibling=a,r.nextSibling=n,a?a.nextSibling=i:e.firstChild=i,null==n?e.lastChild=r:n.previousSibling=r;do i.parentNode=e;while(i!==r&&(i=i.nextSibling));return _onUpdateChild(e.ownerDocument||e,e),t.nodeType==DOCUMENT_FRAGMENT_NODE&&(t.firstChild=t.lastChild=null),t}function _appendSingleChild(e,t){var n=t.parentNode;if(n){var o=e.lastChild;n.removeChild(t);var o=e.lastChild}var o=e.lastChild;return t.parentNode=e,t.previousSibling=o,t.nextSibling=null,o?o.nextSibling=t:e.firstChild=t,e.lastChild=t,_onUpdateChild(e.ownerDocument,e,t),t}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function serializeToString(e,t){switch(e.nodeType){case ELEMENT_NODE:var n=e.attributes,o=n.length,i=e.firstChild,r=e.tagName,a=htmlns===e.namespaceURI;t.push("<",r);for(var s=0;o>s;s++)serializeToString(n.item(s),t,a);if(i||a&&!/^(?:meta|link|img|br|hr|input)$/i.test(r)){if(t.push(">"),a&&/^script$/i.test(r))i&&t.push(i.data);else for(;i;)serializeToString(i,t),i=i.nextSibling;t.push("</",r,">")}else t.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(var i=e.firstChild;i;)serializeToString(i,t),i=i.nextSibling;return;case ATTRIBUTE_NODE:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return t.push(e.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return t.push("<![CDATA[",e.data,"]]>");case COMMENT_NODE:return t.push("<!--",e.data,"-->");case DOCUMENT_TYPE_NODE:var u=e.publicId,d=e.systemId;if(t.push("<!DOCTYPE ",e.name),u)t.push(' PUBLIC "',u),d&&"."!=d&&t.push('" "',d),t.push('">');else if(d&&"."!=d)t.push(' SYSTEM "',d,'">');else{var c=e.internalSubset;c&&t.push(" [",c,"]"),t.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return t.push("<?",e.target," ",e.data,"?>");case ENTITY_REFERENCE_NODE:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function importNode(e,t,n){var o;switch(t.nodeType){case ELEMENT_NODE:o=t.cloneNode(!1),o.ownerDocument=e;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:n=!0}if(o||(o=t.cloneNode(!1)),o.ownerDocument=e,o.parentNode=null,n)for(var i=t.firstChild;i;)o.appendChild(importNode(e,i,n)),i=i.nextSibling;return o}function cloneNode(e,t,n){var o=new t.constructor;for(var i in t){var r=t[i];"object"!=typeof r&&r!=o[i]&&(o[i]=r)}switch(t.childNodes&&(o.childNodes=new NodeList),o.ownerDocument=e,o.nodeType){case ELEMENT_NODE:var a=t.attributes,s=o.attributes=new NamedNodeMap,u=a.length;s._ownerElement=o;for(var d=0;u>d;d++)o.setAttributeNode(cloneNode(e,a.item(d),!0));break;case ATTRIBUTE_NODE:n=!0}if(n)for(var c=t.firstChild;c;)o.appendChild(cloneNode(e,c,n)),c=c.nextSibling;return o}function __set__(e,t,n){e[t]=n}function getTextContent(e){switch(e.nodeType){case 1:case 11:var t=[];for(e=e.firstChild;e;)7!==e.nodeType&&8!==e.nodeType&&t.push(getTextContent(e)),e=e.nextSibling;return t.join("");default:return e.nodeValue}}var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},INDEX_SIZE_ERR=ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),DOMSTRING_SIZE_ERR=ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),HIERARCHY_REQUEST_ERR=ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3),WRONG_DOCUMENT_ERR=ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),INVALID_CHARACTER_ERR=ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),NO_DATA_ALLOWED_ERR=ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),NO_MODIFICATION_ALLOWED_ERR=ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),NOT_FOUND_ERR=ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8),NOT_SUPPORTED_ERR=ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),INUSE_ATTRIBUTE_ERR=ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10),INVALID_STATE_ERR=ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),SYNTAX_ERR=ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),INVALID_MODIFICATION_ERR=ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),NAMESPACE_ERR=ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),INVALID_ACCESS_ERR=ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(e){return this[e]||null}},LiveNodeList.prototype.item=function(e){return _updateLiveList(this),this[e]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var n=this.getNamedItem(e.nodeName);return _addNamedNode(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return t=this.getNamedItemNS(e.namespaceURI,e.localName),_addNamedNode(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return _removeNamedNode(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return _removeNamedNode(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var o=this[n];if(o.localName==t&&o.namespaceURI==e)return o}return null}},DOMImplementation.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return n&&(!t||t in n)?!0:!1},createDocument:function(e,t,n){var o=new Document;if(o.doctype=n,n&&o.appendChild(n),o.implementation=this,o.childNodes=new NodeList,t){var i=o.createElementNS(e,t);o.appendChild(i)}return o},createDocumentType:function(e,t,n){var o=new DocumentType;return o.name=e,o.nodeName=e,o.publicId=t,o.systemId=n,o}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return _insertBefore(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return _removeChild(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return cloneNode(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==TEXT_NODE&&e.nodeType==TEXT_NODE?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var o in n)if(n[o]==e)return o;t=2==t.nodeType?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=2==t.nodeType?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return null==t}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==DOCUMENT_FRAGMENT_NODE){for(var n=e.firstChild;n;){var o=n.nextSibling;this.insertBefore(n,t),n=o}return e}return null==this.documentElement&&1==e.nodeType&&(this.documentElement=e),_insertBefore(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),_removeChild(this,e)},importNode:function(e,t){return importNode(this,e,t)},getElementById:function(e){var t=null;return _visitNode(this.documentElement,function(n){return 1==n.nodeType&&n.getAttribute("id")==e?(t=n,!0):void 0}),t},createElement:function(e){var t=new Element;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new NodeList;var n=t.attributes=new NamedNodeMap;return n._ownerElement=t,t},createDocumentFragment:function(){var e=new DocumentFragment;return e.ownerDocument=this,e.childNodes=new NodeList,e},createTextNode:function(e){var t=new Text;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new Comment;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new CDATASection;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new ProcessingInstruction;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new Attr;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new EntityReference;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new Element,o=t.split(":"),i=n.attributes=new NamedNodeMap;return n.childNodes=new NodeList,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==o.length?(n.prefix=o[0],n.localName=o[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new Attr,o=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==o.length?(n.prefix=o[0],n.localName=o[1]):n.localName=t,n}},_extends(Document,Node),Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(e,null):_appendSingleChild(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var o=this.ownerDocument.createAttributeNS(e,t);o.value=o.nodeValue=n,this.setAttributeNode(o)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new LiveNodeList(this,function(t){var n=[];return _visitNode(t,function(o){o===t||o.nodeType!=ELEMENT_NODE||"*"!==e&&o.tagName!=e||n.push(o)}),n})},getElementsByTagNameNS:function(e,t){return new LiveNodeList(this,function(n){var o=[];return _visitNode(n,function(i){i===n||i.nodeType!==ELEMENT_NODE||i.namespaceURI!==e||"*"!==t&&i.localName!=t||o.push(i)}),o})}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(ExceptionMessage[3])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){var o=this.data.substring(0,e),i=this.data.substring(e+t);n=o+n+i,this.nodeValue=this.data=n,this.length=n.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var o=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(o,this.nextSibling),o}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(e){var t=[];return serializeToString(e,t),t.join("")},Node.prototype.toString=function(){return XMLSerializer.prototype.serializeToString(this)};try{Object.defineProperty&&(Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(e){switch(this.nodeType){case 1:case 11:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=value,this.nodeValue=e}}}),__set__=function(e,t,n){e["$$"+t]=n})}catch(e){}"function"==typeof require&&(exports.DOMImplementation=DOMImplementation,exports.XMLSerializer=XMLSerializer);


},{}],8:[function(require,module,exports){
function XMLReader(){}function parse(e,t,r,a,n){function s(e){if(e>65535){e-=65536;var t=55296+(e>>10),r=56320+(1023&e);return String.fromCharCode(t,r)}return String.fromCharCode(e)}function i(e){var t=e.slice(1,-1);return t in r?r[t]:"#"===t.charAt(0)?s(parseInt(t.substr(1).replace("x","0x"))):(n.error("entity not found:"+e),e)}function c(t){var r=e.substring(S,t).replace(/&#?\w+;/g,i);m&&o(S),a.characters(r,0,t-S),S=t}function o(t,r){for(;t>=l&&(r=f.exec(e));)u=r.index,l=u+r[0].length,m.lineNumber++;m.columnNumber=t-u+1}for(var u=0,l=0,f=/.+(?:\r\n?|\n)|.*$/g,m=a.locator,p=[{currentNSMap:t}],d={},S=0;;){var _=e.indexOf("<",S);if(0>_){if(!e.substr(S).match(/^\s*$/)){var h=a.document,g=h.createTextNode(e.substr(S));h.appendChild(g),a.currentElement=g}return}switch(_>S&&c(_),e.charAt(_+1)){case"/":var w=e.indexOf(">",_+3),b=e.substring(_+2,w),v=p.pop(),x=v.localNSMap;if(v.tagName!=b&&n.fatalError("end tag name: "+b+" is not match the current start tagName:"+v.tagName),a.endElement(v.uri,v.localName,b),x)for(var T in x)a.endPrefixMapping(T);w++;break;case"?":m&&o(_),w=parseInstruction(e,_,a);break;case"!":m&&o(_),w=parseDCC(e,_,a,n);break;default:try{m&&o(_);var N=new ElementAttributes,w=parseElementStartPart(e,_,N,i,n),E=N.length;if(E&&m){for(var A=copyLocator(m,{}),_=0;E>_;_++){var C=N[_];o(C.offset),C.offset=copyLocator(m,{})}copyLocator(A,m)}!N.closed&&fixSelfClosed(e,w,N.tagName,d)&&(N.closed=!0,r.nbsp||n.warning("unclosed xml attribute")),appendElement(N,a,p),"http://www.w3.org/1999/xhtml"!==N.uri||N.closed?w++:w=parseHtmlSpecialContent(e,w,N.tagName,i,a)}catch(F){n.error("element parse error: "+F),w=-1}}0>w?c(_+1):S=w}}function copyLocator(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function parseElementStartPart(e,t,r,a,n){for(var s,i,c=++t,o=S_TAG;;){var u=e.charAt(c);switch(u){case"=":if(o===S_ATTR)s=e.slice(t,c),o=S_EQ;else{if(o!==S_ATTR_S)throw new Error("attribute equal must after attrName");o=S_EQ}break;case"'":case'"':if(o===S_EQ){if(t=c+1,c=e.indexOf(u,t),!(c>0))throw new Error("attribute value no end '"+u+"' match");i=e.slice(t,c).replace(/&#?\w+;/g,a),r.add(s,i,t-1),o=S_E}else{if(o!=S_V)throw new Error('attribute value must after "="');i=e.slice(t,c).replace(/&#?\w+;/g,a),r.add(s,i,t),n.warning('attribute "'+s+'" missed start quot('+u+")!!"),t=c+1,o=S_E}break;case"/":switch(o){case S_TAG:r.setTagName(e.slice(t,c));case S_E:case S_S:case S_C:o=S_C,r.closed=!0;case S_V:case S_ATTR:case S_ATTR_S:break;default:throw new Error("attribute invalid close char('/')")}break;case"":n.error("unexpected end of input");case">":switch(o){case S_TAG:r.setTagName(e.slice(t,c));case S_E:case S_S:case S_C:break;case S_V:case S_ATTR:i=e.slice(t,c),"/"===i.slice(-1)&&(r.closed=!0,i=i.slice(0,-1));case S_ATTR_S:o===S_ATTR_S&&(i=s),o==S_V?(n.warning('attribute "'+i+'" missed quot(")!!'),r.add(s,i.replace(/&#?\w+;/g,a),t)):(n.warning('attribute "'+i+'" missed value!! "'+i+'" instead!!'),r.add(i,i,t));break;case S_EQ:throw new Error("attribute value missed!!")}return c;case"":u=" ";default:if(" ">=u)switch(o){case S_TAG:r.setTagName(e.slice(t,c)),o=S_S;break;case S_ATTR:s=e.slice(t,c),o=S_ATTR_S;break;case S_V:var i=e.slice(t,c).replace(/&#?\w+;/g,a);n.warning('attribute "'+i+'" missed quot(")!!'),r.add(s,i,t);case S_E:o=S_S}else switch(o){case S_ATTR_S:n.warning('attribute "'+s+'" missed value!! "'+s+'" instead!!'),r.add(s,s,t),t=c,o=S_ATTR;break;case S_E:n.warning('attribute space is required"'+s+'"!!');case S_S:o=S_ATTR,t=c;break;case S_EQ:o=S_V,t=c;break;case S_C:throw new Error("elements closed character '/' and '>' must be connected to")}}c++}}function appendElement(e,t,r){for(var a=e.tagName,n=null,s=r[r.length-1].currentNSMap,i=e.length;i--;){var c=e[i],o=c.qName,u=c.value,l=o.indexOf(":");if(l>0)var f=c.prefix=o.slice(0,l),m=o.slice(l+1),p="xmlns"===f&&m;else m=o,f=null,p="xmlns"===o&&"";c.localName=m,p!==!1&&(null==n&&(n={},_copy(s,s={})),s[p]=n[p]=u,c.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(p,u))}for(var i=e.length;i--;){c=e[i];var f=c.prefix;f&&("xml"===f&&(c.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==f&&(c.uri=s[f]))}var l=a.indexOf(":");l>0?(f=e.prefix=a.slice(0,l),m=e.localName=a.slice(l+1)):(f=null,m=e.localName=a);var d=e.uri=s[f||""];if(t.startElement(d,m,a,e),e.closed){if(t.endElement(d,m,a),n)for(f in n)t.endPrefixMapping(f)}else e.currentNSMap=s,e.localNSMap=n,r.push(e)}function parseHtmlSpecialContent(e,t,r,a,n){if(/^(?:script|textarea)$/i.test(r)){var s=e.indexOf("</"+r+">",t),i=e.substring(t+1,s);if(/[&<]/.test(i))return/^script$/i.test(r)?(n.characters(i,0,i.length),s):(i=i.replace(/&#?\w+;/g,a),n.characters(i,0,i.length),s)}return t+1}function fixSelfClosed(e,t,r,a){var n=a[r];return null==n&&(n=a[r]=e.lastIndexOf("</"+r+">")),t>n}function _copy(e,t){for(var r in e)t[r]=e[r]}function parseDCC(e,t,r,a){var n=e.charAt(t+2);switch(n){case"-":if("-"===e.charAt(t+3)){var s=e.indexOf("-->",t+4);return s>t?(r.comment(e,t+4,s-t-4),s+3):(a.error("Unclosed comment"),-1)}return-1;default:if("CDATA["==e.substr(t+3,6)){var s=e.indexOf("]]>",t+9);return r.startCDATA(),r.characters(e,t+9,s-t-9),r.endCDATA(),s+3}var i=split(e,t),c=i.length;if(c>1&&/!doctype/i.test(i[0][0])){var o=i[1][0],u=c>3&&/^public$/i.test(i[2][0])&&i[3][0],l=c>4&&i[4][0],f=i[c-1];return r.startDTD(o,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),l&&l.replace(/^(['"])(.*?)\1$/,"$2")),r.endDTD(),f.index+f[0].length}}return-1}function parseInstruction(e,t,r){var a=e.indexOf("?>",t);if(a){var n=e.substring(t,a).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(n){n[0].length;return r.processingInstruction(n[1],n[2]),a+2}return-1}return-1}function ElementAttributes(e){}function _set_proto_(e,t){return e.__proto__=t,e}function split(e,t){var r,a=[],n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(n.lastIndex=t,n.exec(e);r=n.exec(e);)if(a.push(r),r[1])return a}var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"-\\ux203F-]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_S=2,S_EQ=3,S_V=4,S_E=5,S_S=6,S_C=7;XMLReader.prototype={parse:function(e,t,r){var a=this.domBuilder;a.startDocument(),_copy(t,t={}),parse(e,t,r,a,this.errorHandler),a.endDocument()}},ElementAttributes.prototype={setTagName:function(e){if(!tagNamePattern.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,r){if(!tagNamePattern.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:r}},length:0,getLocalName:function(e){return this[e].localName},getOffset:function(e){return this[e].offset},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(e,t){function r(){}r.prototype=t,r=new r;for(t in e)r[t]=e[t];return r}),"function"==typeof require&&(exports.XMLReader=XMLReader);


},{}],9:[function(require,module,exports){
"use strict";function importCommands(r){for(var i in r)g[i]=r[i]}var _=require("lodash"),vg=require("./libraries/vg/vg"),img=require("./libraries/img/img"),g={};for(var k in vg)g[k]=vg[k];delete g["delete"];for(var k in img)g[k]=img[k];importCommands(require("./libraries/math")),importCommands(require("./libraries/string")),importCommands(require("./libraries/list")),importCommands(require("./libraries/data")),importCommands(require("./libraries/image")),importCommands(require("./libraries/graphics")),importCommands(require("./libraries/easing")),g.importSVG=function(r){return g.svg.parseString(r)},g.importImage=function(r){var i=g.Layer.fromImage(r);return new g.Img(i.toCanvas())},g.importText=function(r){return r?String(r):""},g.importCSV=function(r,i){function e(r,i){var e,t,n=[],m="",a=!1;for(r=r.trim(),t=0;t<r.length;t+=1)e=r[t],'"'===e?'"'===r[t+1]?(m+='"',t+=1):a=!a:e===i?a?m+=e:(n.push(m),m=""):m+=e;return n.push(m),n}var t,n;return i=i||",",r?(t=r.split(/\r\n|\r|\n/g),n=e(t[0],i),t=t.slice(1),t=_.reject(t,_.isEmpty),t=_.map(t,function(r){var t,m={};return t=_.map(e(r,i),function(r){return isNaN(r)?r:parseFloat(r)}),_.each(t,function(r,i){m[n[i]]=r}),m})):null},g.merge=function(){var r=_.flatten(arguments,!0);if(Array.isArray(r)&&(r=_.reject(r,_.isEmpty),r.length>0)){var i=r[0];if(i&&(i.commands||i.shapes))return vg.merge(r);if(i instanceof img.Img)return img.merge(r)}return null},g.mix=function(r,i,e){if(e=void 0!==e?e:.5,"number"==typeof r)return r*(1-e)+i*e;if("object"==typeof r){for(var t={},n=Object.keys(r),m=0,a=n.length;a>m;m+=1){var o=n[m],s=r[o],u=i[o];void 0!==s&&void 0!==u&&(t[o]=g.mix(s,u,e))}return t}return 0},module.exports=g;
},{"./libraries/data":10,"./libraries/easing":12,"./libraries/graphics":13,"./libraries/image":14,"./libraries/img/img":18,"./libraries/list":21,"./libraries/math":22,"./libraries/string":23,"./libraries/vg/vg":45,"lodash":4}],10:[function(require,module,exports){
"use strict";var _=require("lodash"),list=require("./list"),g={};g.convert=function(t,n,r,u,o){var e=arguments.length;if(2===e){var a=arguments[1];n=a.inMin,r=a.inMax,u=a.outMin,o=a.outMax}else 3===e&&(n=arguments[1][0],r=arguments[1][1],u=arguments[2][0],o=arguments[2][1]);try{t=(t-n)/(r-n)}catch(i){t=n}return u+t*(o-u)},g.filterData=function(t,n,r,u){if(null===u||void 0===u)return t;for(var o=[],e=0;e<t.length;e+=1){var a=t[e],i=a[n];"=="===r&&i==u?o.push(a):"!="===r&&i!=u?o.push(a):">"===r&&i>u?o.push(a):">="===r&&i>=u?o.push(a):"<"===r&&u>i?o.push(a):"<="===r&&u>=i&&o.push(a)}return o},g.groupBy=function(t,n){return _.values(_.groupBy(t,n))},g.keys=function(t){for(var n=[],r=0;r<t.length;r++)n=n.concat(_.keys(t[r]));return list.distinct(n)},g.lookup=function(t,n){var r,u;return r=t,u=r[n],void 0!==u?("function"==typeof u&&(u=u.call(r)),u):(_.each(n.split("."),function(t){return r?void("function"==typeof r[t]?(u=r[t],r=u.call(r)):r=r[t]):null}),r)},g.dataScale=function(t,n,r){return{domain:t,outMin:n,outMax:r}},g.ticks=function(t,n,r){r=void 0!==r?r:10;var u,o=n-t,e=Math.pow(10,Math.floor(Math.log(o/r)/Math.LN10)),a=r/o*e,i=[];for(.15>=a?e*=10:.35>=a?e*=5:.75>=a&&(e*=2),t=Math.ceil(t/e)*e,n=Math.floor(n/e)*e+.5*e,u=t;n>u;u+=e)i.push(u);return i},module.exports=g;


},{"./list":21,"lodash":4}],11:[function(require,module,exports){
"use strict";function isBuffer(){return!1}function isObject(e){return"object"==typeof e&&null!==e}function objectToString(e){return Object.prototype.toString.call(e)}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isNullOrUndefined(e){return null===e||void 0===e}var util={isObject:isObject,isRegExp:isRegExp,isDate:isDate,isNullOrUndefined:isNullOrUndefined,isBuffer:isBuffer},pSlice=Array.prototype.slice,deepEqual={},isArguments,_deepEqual,objEquiv;_deepEqual=function(e,t){if(e===t)return!0;if(util.isBuffer(e)&&util.isBuffer(t)){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return util.isDate(e)&&util.isDate(t)?e.getTime()===t.getTime():util.isRegExp(e)&&util.isRegExp(t)?e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase:util.isObject(e)||util.isObject(t)?objEquiv(e,t):e==t},deepEqual.deepEqual=_deepEqual,isArguments=function(e){return"[object Arguments]"===Object.prototype.toString.call(e)},objEquiv=function(e,t){if(util.isNullOrUndefined(e)||util.isNullOrUndefined(t))return!1;if(e.prototype!==t.prototype)return!1;var i=isArguments(e),r=isArguments(t);if(i&&!r||!i&&r)return!1;if(i)return e=pSlice.call(e),t=pSlice.call(t),_deepEqual(e,t);var u,n,l,s;try{u=Object.keys(e),n=Object.keys(t)}catch(o){return!1}if(u.length!==n.length)return!1;for(u.sort(),n.sort(),s=u.length-1;s>=0;s--)if(u[s]!=n[s])return!1;for(s=u.length-1;s>=0;s--)if(l=u[s],!_deepEqual(e[l],t[l]))return!1;return!0},module.exports=deepEqual;


},{}],12:[function(require,module,exports){
"use strict";var g={};g.easeInQuad=function(t,n,e,u){return e*(t/=u)*t+n},g.easeOutQuad=function(t,n,e,u){return-e*(t/=u)*(t-2)+n},g.easeInOutQuad=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t+n:-e/2*(--t*(t-2)-1)+n},g.easeInCubic=function(t,n,e,u){return e*(t/=u)*t*t+n},g.easeOutCubic=function(t,n,e,u){return e*((t=t/u-1)*t*t+1)+n},g.easeInOutCubic=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*t+n:e/2*((t-=2)*t*t+2)+n},g.easeInQuart=function(t,n,e,u){return e*(t/=u)*t*t*t+n},g.easeOutQuart=function(t,n,e,u){return-e*((t=t/u-1)*t*t*t-1)+n},g.easeInOutQuart=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*t*t+n:-e/2*((t-=2)*t*t*t-2)+n},g.easeInQuint=function(t,n,e,u){return e*(t/=u)*t*t*t*t+n},g.easeOutQuint=function(t,n,e,u){return e*((t=t/u-1)*t*t*t*t+1)+n},g.easeInOutQuint=function(t,n,e,u){return(t/=u/2)<1?e/2*t*t*t*t*t+n:e/2*((t-=2)*t*t*t*t+2)+n},g.easeInSine=function(t,n,e,u){return-e*Math.cos(t/u*(Math.PI/2))+e+n},g.easeOutSine=function(t,n,e,u){return e*Math.sin(t/u*(Math.PI/2))+n},g.easeInOutSine=function(t,n,e,u){return-e/2*(Math.cos(Math.PI*t/u)-1)+n},g.easeInExpo=function(t,n,e,u){return 0===t?n:e*Math.pow(2,10*(t/u-1))+n},g.easeOutExpo=function(t,n,e,u){return t===u?n+e:e*(-Math.pow(2,-10*t/u)+1)+n},g.easeInOutExpo=function(t,n,e,u){return 0===t?n:t===u?n+e:(t/=u/2)<1?e/2*Math.pow(2,10*(t-1))+n:e/2*(-Math.pow(2,-10*--t)+2)+n},g.easeInCirc=function(t,n,e,u){return-e*(Math.sqrt(1-(t/=u)*t)-1)+n},g.easeOutCirc=function(t,n,e,u){return e*Math.sqrt(1-(t=t/u-1)*t)+n},g.easeInOutCirc=function(t,n,e,u){return(t/=u/2)<1?-e/2*(Math.sqrt(1-t*t)-1)+n:e/2*(Math.sqrt(1-(t-=2)*t)+1)+n},g.easeInElastic=function(t,n,e,u){var a=1.70158,r=0,i=e;return 0===t?n:1===(t/=u)?n+e:(r||(r=.3*u),i<Math.abs(e)?(i=e,a=r/4):a=r/(2*Math.PI)*Math.asin(e/i),-(i*Math.pow(2,10*(t-=1))*Math.sin((t*u-a)*(2*Math.PI)/r))+n)},g.easeOutElastic=function(t,n,e,u){var a=1.70158,r=0,i=e;return 0===t?n:1===(t/=u)?n+e:(r||(r=.3*u),i<Math.abs(e)?(i=e,a=r/4):a=r/(2*Math.PI)*Math.asin(e/i),i*Math.pow(2,-10*t)*Math.sin((t*u-a)*(2*Math.PI)/r)+e+n)},g.easeInOutElastic=function(t,n,e,u){var a=1.70158,r=0,i=e;return 0===t?n:2===(t/=u/2)?n+e:(r||(r=u*(.3*1.5)),i<Math.abs(e)?(i=e,a=r/4):a=r/(2*Math.PI)*Math.asin(e/i),1>t?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t*u-a)*(2*Math.PI)/r))+n:i*Math.pow(2,-10*(t-=1))*Math.sin((t*u-a)*(2*Math.PI)/r)*.5+e+n)},g.easeInBack=function(t,n,e,u,a){return void 0===a&&(a=1.70158),e*(t/=u)*t*((a+1)*t-a)+n},g.easeOutBack=function(t,n,e,u,a){return void 0===a&&(a=1.70158),e*((t=t/u-1)*t*((a+1)*t+a)+1)+n},g.easeInOutBack=function(t,n,e,u,a){return void 0===a&&(a=1.70158),(t/=u/2)<1?e/2*(t*t*(((a*=1.525)+1)*t-a))+n:e/2*((t-=2)*t*(((a*=1.525)+1)*t+a)+2)+n},g.easeInBounce=function(t,n,e,u){return e-g.easeOutBounce(u-t,0,e,u)+n},g.easeOutBounce=function(t,n,e,u){return(t/=u)<1/2.75?e*(7.5625*t*t)+n:2/2.75>t?e*(7.5625*(t-=1.5/2.75)*t+.75)+n:2.5/2.75>t?e*(7.5625*(t-=2.25/2.75)*t+.9375)+n:e*(7.5625*(t-=2.625/2.75)*t+.984375)+n},g.easeInOutBounce=function(t,n,e,u){return u/2>t?.5*g.easeInBounce(2*t,0,e,u)+n:.5*g.easeOutBounce(2*t-u,0,e,u)+.5*e+n},g.easing=function(t){var n=g[t],e=Array.prototype.slice.call(arguments,1);return n.apply(null,e)},module.exports=g;


},{}],13:[function(require,module,exports){
"use strict";function clamp(r,n,t){return Math.min(t,Math.max(n,r))}function transformShape(r,n){return n.transformShape(r)}function transformImage(r,n){return r._transform(n.m)}function transform(r,n){if(r instanceof vg.Path||r instanceof vg.Group||r instanceof vg.Text||void 0!==r.x&&void 0!==r.y)return transformShape(r,n);if(Array.isArray(r)){for(var t=[],e=0;e<r.length;e+=1)t.push(transform(r[e],n));return t}return r instanceof img.Img?transformImage(r,n):void 0}var _=require("lodash"),vg=require("./vg/vg"),img=require("./img/img"),math=require("./math"),g={};g.HORIZONTAL="horizontal",g.VERTICAL="vertical",g.BOTH="both",g.LEFT="left",g.RIGHT="right",g.CENTER="center",g.TOP="top",g.BOTTOM="bottom",g.MIDDLE="middle",g.align=function(r,n,t,e){if(r){var a,o,i,s=n.x,f=n.y,u=vg.bounds(r);return a=t===g.LEFT?s-u.x:t===g.RIGHT?s-u.x-u.width:t===g.CENTER?s-u.x-u.width/2:0,o=e===g.TOP?f-u.y:e===g.BOTTOM?f-u.y-u.height:e===g.MIDDLE?f-u.y-u.height/2:0,i=(new vg.Transform).translate(a,o),transform(r,i)}},g.colorize=function(r,n){var t=arguments;if(("object"!=typeof n||n instanceof vg.Color)&&(n={},void 0!==t[1]&&(n.fill=t[1]),void 0!==t[2]&&(n.stroke=t[2]),void 0!==t[3]&&(n.strokeWidth=t[3])),r instanceof vg.Path||r instanceof vg.Group)return r.colorize(n);if(r instanceof img.Img||r instanceof vg.Text){if(n.fill||0===n.fill)return r.colorize(n.fill);throw new Error("No color given")}},g.copy=function(r,n,t,e,a,o){var i,g,s,f,u,v=[],l=0,c=0,h=0,m=1,d=1,p=!1;for(r instanceof vg.Path||r instanceof vg.Group||r instanceof vg.Text?u=transformShape:Array.isArray(r)&&r.length>0&&void 0!==r[0].x&&void 0!==r[0].y?(p=!0,u=transformShape):r instanceof img.Img&&(u=transformImage),i=0;n>i;i+=1){for(g=new vg.Transform,s=0;s<t.length;s+=1)f=t[s],"t"===f?g=g.translate(l,c):"r"===f?g=g.rotate(h):"s"===f&&(g=g.scale(m,d));p?v=v.concat(u(r,g)):v.push(u(r,g)),l+=e.x,c+=e.y,h+=a,m+=o.x,d+=o.y}return v},g.flip=function(r,n){if("none"===n)return r;if(r instanceof vg.Path||r instanceof vg.Group||r instanceof vg.Text||Array.isArray(r)&&r.length>0&&void 0!==r[0].x&&void 0!==r[0].y){var t=n===g.HORIZONTAL||n===g.BOTH?-1:1,e=n===g.VERTICAL||n===g.BOTH?-1:1;return vg.scale(r,new vg.Point(t,e),vg.centerPoint(r))}if(r instanceof img.Img){var a=r,o=a.toLayer(!1);return(n===g.HORIZONTAL||n===g.BOTH)&&o.flipHorizontal(),(n===g.VERTICAL||n===g.BOTH)&&o.flipVertical(),a.withCanvas(o.toCanvas())}},g.fit=function(r,n,t,e,a){if(r){a=void 0!==a?a:!1;var o,i,g,s=vg.bounds(r),f=s.x,u=s.y,v=s.width,l=s.height;return v=v>1e-12?v:0,l=l>1e-12?l:0,o=new vg.Transform,o=o.translate(n.x,n.y),a?(i=v>0?t/v:1,g=l>0?e/l:1):(i=v>0?t/v:Number.MAX_VALUE,g=l>0?e/l:Number.MAX_VALUE,i=g=Math.min(i,g)),o=o.scale(i,g),o=o.translate(-v/2-f,-l/2-u),transform(r,o)}},g.fitTo=function(r,n,t){if(r){if(!n)return r;var e=vg.bounds(n),a=e.x,o=e.y,i=e.width,s=e.height;return g.fit(r,{x:a+i/2,y:o+s/2},i,s,t)}},g.hslAdjust=function(r,n,t,e,a){function o(e){if(e instanceof vg.Group){for(var i=[],g=0;g<e.shapes.length;g+=1)i.push(o(e.shapes[g]));return new vg.Group(i)}if(e instanceof vg.Path){var b=e.clone();return b.fill=o(b.fill),b.stroke=o(b.stroke),b}var A=e;return A instanceof vg.Color||(A=vg.Color.parse(A)),s=A.r,f=A.g,u=A.b,(0!==n||0!==t)&&(v=s,f>v&&(v=f),u>v&&(v=u),l=s,l>f&&(l=f),l>u&&(l=u),c=v-l,d=(l+v)/2,d>0&&c>0&&(.5>=d?(m=c/(v+l)*w,m>1&&(m=1),r=d*(1+m)):(m=c/(2-v-l)*w,m>1&&(m=1),r=d+m-d*m),h=s===v?f===l?5+(v-u)/c+n:1-(v-f)/c+n:f===v?u===l?1+(v-s)/c+n:3-(v-u)/c+n:s===l?3+(v-f)/c+n:5-(v-s)/c+n,0>h&&(h+=6),h>=6&&(h-=6),p=d+d-r,y=h>>0,T=(r-p)*(h-y),0===y?(s=r,f=p+T,u=p):1===y?(s=r-T,f=r,u=p):2===y?(s=p,f=r,u=p+T):3===y?(s=p,f=r-T,u=r):4===y?(s=p+T,f=p,u=r):5===y&&(s=r,f=p,u=r-T))),s=s*C+x,f=f*C+x,u=u*C+x,0>s&&(s=0),0>f&&(f=0),0>u&&(u=0),s>1&&(s=1),f>1&&(f=1),u>1&&(u=1),new vg.Color(s,f,u,A.a+a)}if(a||(a=0),r instanceof img.Img){var i=r,g=i.toLayer(!1);return g.addFilter("hslAdjust",{h:n,s:t,l:e,a:a}),i.withCanvas(g.toCanvas())}n=clamp(n,-1,1),t=clamp(t,-1,1),e=clamp(e,-1,1),a=clamp(a,-1,1);var s,f,u,v,l,c,h,m,d,p,T,y,w=1+t*(0>t?1:2),C=0>e?1+e:1-e,x=0>e?0:e;return n=6*n%6,o(r)},g.rgbAdjust=function(r,n,t,e,a){function o(r){if(r instanceof img.Img){var i=r,g=i.toLayer(!1);return g.addFilter("rgbAdjust",{r:n,g:t,b:e,a:a}),i.withCanvas(g.toCanvas())}if(r instanceof vg.Group){for(var s=[],f=0;f<r.shapes.length;f+=1)s.push(o(r.shapes[f]));return new vg.Group(s)}if(r instanceof vg.Path){var u=r.clone();return u.fill=o(u.fill),u.stroke=o(u.stroke),u}var v=r;return v instanceof vg.Color||(v=vg.Color.parse(v)),new vg.Color(v.r+n,v.g+t,v.b+e,v.a+a)}return a||(a=0),n=clamp(n,-1,1),t=clamp(t,-1,1),e=clamp(e,-1,1),a=clamp(a,-1,1),o(r)},g.stack=function(r,n,t){if(!r)return[];if(r.length<=1)return r;var e,a,o,i,g=r[0].bounds(),s=[];return"e"===n?(e=-(g.width/2),_.each(r,function(r){i=r.bounds(),o=(new vg.Transform).translate(e-i.x,0),s.push(transform(r,o)),e+=i.width+t})):"w"===n?(e=g.width/2,_.each(r,function(r){i=r.bounds(),o=(new vg.Transform).translate(e+i.x,0),s.push(transform(r,o)),e-=i.width+t})):"n"===n?(a=g.height/2,_.each(r,function(r){i=r.bounds(),o=(new vg.Transform).translate(0,a+i.y),s.push(transform(r,o)),a-=i.height+t})):"s"===n&&(a=-(g.height/2),_.each(r,function(r){i=r.bounds(),o=(new vg.Transform).translate(0,a-i.y),s.push(transform(r,o)),a+=i.height+t})),s},g.angle=function(r,n){var t=arguments;return 4===t.length?(r=vg.Point.read(t[0],t[1]),n=vg.Point.read(t[2],t[3])):(r=vg.Point.read(r),n=vg.Point.read(n)),math.degrees(Math.atan2(n.y-r.y,n.x-r.x))},g.coordinates=function(r,n,t){var e=arguments;return 4===e.length?(r=vg.Point.read(e[0],e[1]),n=e[2],t=e[3]):r=vg.Point.read(r),vg.geo.coordinates(r.x,r.y,n,t)},g.distance=function(r,n){var t=arguments;return 4===t.length?(r=vg.Point.read(t[0],t[1]),n=vg.Point.read(t[2],t[3])):(r=vg.Point.read(r),n=vg.Point.read(n)),Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2))},g.grayColor=function(r,n){return n||0===n||(n=1),vg.Color.gray(r,n,1)},g.hexColor=function(r){function n(r){return!isNaN(parseFloat(r))&&isFinite(r)}return r=n(r)?r.toString(16):String(r),"#"!==r[0]&&(r="#"+r),vg.Color.parse(r)},g.hslColor=function(r,n,t,e){return e||0===e||(e=1),vg.Color.hsl(r,n,t,e,1)},g.rgbColor=function(r,n,t,e){return e||0===e||(e=1),vg.Color.rgb(r,n,t,e,1)},g.desaturate=function(r,n){return r?r.desaturate({method:n}):null},g.invert=function(r){if(!r)return null;if(r instanceof img.Img){var n=r,t=n.toLayer(!1);return t.addFilter("invert"),n.withCanvas(t.toCanvas())}return r.invert()},module.exports=g;


},{"./img/img":18,"./math":22,"./vg/vg":45,"lodash":4}],14:[function(require,module,exports){
"use strict";var vg=require("./vg/vg"),img=require("./img/img"),Img=img.Img,Layer=img.Layer,ImageCanvas=img.ImageCanvas,g={};g.blend=function(a,t,e){var r=a.bounds(),n=t.bounds(),i=new vg.Rect(r.x,r.y,r.width,r.height).unite(n),o=Math.ceil(i.width),d=Math.ceil(i.height),s=o/2+i.x,g=d/2+i.y,h=new ImageCanvas(o,d),u=h.addLayer(a.toLayer());u.translate(-s,-g);var v=h.addLayer(t.toLayer());return v.translate(-s,-g),v.blendmode=e,new Img(h.render(),s,g)},g.blur=function(a,t){var e=a.toLayer(!1);return e.addFilter("blur",{radius:t}),a.withCanvas(e.toCanvas())},g.brighten=function(a,t,e){var r=a.toLayer(!1);return r.addFilter("brightness",{brightness:t/100,contrast:e/100}),a.withCanvas(r.toCanvas())},g.bump=function(a,t,e,r){var n=a.toLayer(!1);return n.addFilter("bump",{dx:t.x,dy:t.y,radius:e,zoom:r/100}),a.withCanvas(n.toCanvas())},g.colorImage=function(a,t,e){var r=Layer.fromColor(e);return r.width=a,r.height=t,new Img(r.toCanvas())},g.crop=function(a,t){return a.crop(t)},g.crossEdges=function(a,t){var e=a.toLayer(!1);return e.addFilter("crossedges",{strength:t/100}),a.withCanvas(e.toCanvas())},g.dent=function(a,t,e,r){var n=a.toLayer(!1);return n.addFilter("dent",{dx:t.x,dy:t.y,radius:e,zoom:r/100}),a.withCanvas(n.toCanvas())},g.emboss=function(a,t,e){var r=a.toLayer(!1);return r.addFilter("emboss",{amount:t/100,angle:e}),a.withCanvas(r.toCanvas())},g.equalize=function(a){var t=a.toLayer(!1);return t.addFilter("equalize"),a.withCanvas(t.toCanvas())},g.findEdges=function(a){var t=a.toLayer(!1);return t.addFilter("findedges"),a.withCanvas(t.toCanvas())},g.glow=function(a,t,e){var r=a.toLayer(!1);return r.addFilter("glow",{amount:t/100,kernelSize:e}),a.withCanvas(r.toCanvas())},g.gradientImage=function(a,t,e,r,n,i,o){var d=Layer.fromGradient(e,r,n,i,o/100);return d.width=a,d.height=t,new Img(d.toCanvas())},g.histogram=function(a,t,e){var r,n,i,o,d=a.getPixels(),s=new Array(256);for(r=0;r<s.length;r+=1)s[r]=0;if("lum"===t)for(r=0;r<d.width*d.height;r+=1)i=d.get(r),o=.2125*i[0]+.7154*i[1]+.0721*i[2],s[Math.round(o)]+=1;else for("red"===t&&(n=0),"green"===t&&(n=1),"blue"===t&&(n=2),"alpha"===t&&(n=3),r=0;r<d.width*d.height;r+=1)i=d.get(r),o=i[n],s[o]+=1;if(e)for(r=0;r<s.length;r+=1)s[r]/=d.width*d.height;return s},g.lightTunnel=function(a,t,e){var r=a.toLayer(!1);return r.addFilter("splash",{dx:t.x,dy:t.y,radius:e}),a.withCanvas(r.toCanvas())},g.luminanceBW=function(a){var t=a.toLayer(!1);return t.addFilter("luminancebw"),a.withCanvas(t.toCanvas())},g.mask=function(a,t){a=a.transformed(),t=t.transformed();var e=a.toLayer(!1),r=t.toLayer(),n=a.bounds(),i=t.bounds(),o=new vg.Rect(n.x,n.y,n.width,n.height).unite(i),d=Math.ceil(o.width),s=Math.ceil(o.height),g=d/2+o.x,h=s/2+o.y;r.translate(-g,-h);var u=e.mask.addLayer("white");return u.width=e.width,u.height=e.height,e.mask.addLayer(r),a.withCanvas(e.toCanvas())},g.mosaic=function(a,t){var e=a.toLayer(!1);return e.addFilter("mosaic",{blockSize:t}),a.withCanvas(e.toCanvas())},g.pinch=function(a,t,e){var r=a.toLayer(!1);return r.addFilter("pinch",{dx:t.x,dy:t.y,zoom:e/100}),a.withCanvas(r.toCanvas())},g.posterize=function(a,t){var e=a.toLayer(!1);return e.addFilter("posterize",{levels:t}),a.withCanvas(e.toCanvas())},g.removeNoise=function(a){var t=a.toLayer(!1);return t.addFilter("removenoise"),a.withCanvas(t.toCanvas())},g.solarize=function(a){var t=a.toLayer(!1);return t.addFilter("solarize"),a.withCanvas(t.toCanvas())},g.toBitmap=function(a,t){var e,r=document.createElement("canvas");e=t?t.bounds():a.bounds();var n=e.x,i=e.y,o=r.width=Math.ceil(e.width),d=r.height=Math.ceil(e.height),s=r.getContext("2d");return s.translate(-n,-i),a.draw(s),new Img(r,o/2+n,d/2+i)},g.toPixels=function(a,t){t=t>1?t:1;for(var e=a.canvas,r=e.width,n=e.height,i=e.getContext("2d"),o=i.getImageData(0,0,e.width,e.height),d=o.data,s=4*e.width,g=[],h=0;n>h;h+=t)for(var u=0;r>u;u+=t){var v=h*s+4*u,l=d[v],c=d[v+1],w=d[v+2],m=d[v+3];g.push({x:u-r/2,y:h-n/2,r:l,g:c,b:w,a:m,color:new vg.Color(l/255,c/255,w/255,m/255)})}return g},g.twirl=function(a,t,e,r){var n=a.toLayer(!1);return n.addFilter("twirl",{dx:t.x,dy:t.y,radius:e,angle:r}),a.withCanvas(n.toCanvas())},module.exports=g;


},{"./img/img":18,"./vg/vg":45}],15:[function(require,module,exports){
"use strict";function passThrough(e,n){n(null,e)}function processLayers(e){return function(n,r){async.compose(AsyncRenderer.processImage(n.filters),AsyncRenderer.processMask(n.mask),AsyncRenderer.load(e,n))(null,r)}}var async=require("async"),process=require("./process"),CanvasRenderer=require("./canvasrenderer"),AsyncRenderer={};AsyncRenderer.toImage=function(){return function(e,n){n(null,CanvasRenderer.toImage(e))}},AsyncRenderer.load=function(e,n){return n.isPath()?AsyncRenderer.loadFile(n.data):n.isFill()?AsyncRenderer.generateColor(e,n):n.isGradient()?AsyncRenderer.generateGradient(e,n):n.isHtmlCanvas()?AsyncRenderer.loadHtmlCanvas(n.data):n.isImage()?AsyncRenderer.loadImage(n.data):n.isImageCanvas()?AsyncRenderer.loadImageCanvas(n.data):void 0},AsyncRenderer.loadFile=function(e){return function(n,r){var a=document.createElement("canvas"),t=a.getContext("2d"),s=new Image;s.onload=function(){a.width=s.width,a.height=s.height,t.drawImage(s,0,0,a.width,a.height),r(null,a)},s.src=e}},AsyncRenderer.loadHtmlCanvas=function(e){return function(n,r){r(null,e)}},AsyncRenderer.loadImageCanvas=function(e){return function(n,r){e.render(function(e){r(null,e)})}},AsyncRenderer.loadImage=function(e){return function(n,r){var a=CanvasRenderer.loadImage(e);r(null,a)}},AsyncRenderer.generateColor=function(e,n){return function(r,a){var t=CanvasRenderer.generateColor(e,n);a(null,t)}},AsyncRenderer.generateGradient=function(e,n){return function(r,a){var t=CanvasRenderer.generateGradient(e,n);a(null,t)}},AsyncRenderer.processImage=function(e){return 0===e.length?passThrough:function(n,r){CanvasRenderer.processImage(n,e),r(null,n)}},AsyncRenderer.processMask=function(e){return 0===e.layers.length?passThrough:function(n,r){e.width=n.width,e.height=n.height,AsyncRenderer.renderBW(e,function(e){var a=e.getContext("2d").getImageData(0,0,e.width,e.height).data,t={name:"mask",options:{data:a,x:0,y:0,width:e.width,height:e.height}},s=AsyncRenderer.processImage([t]);s(n,r)})}},AsyncRenderer.mergeManualBlend=function(e,n){return function(r,a){CanvasRenderer.mergeManualBlend(e,n)(r),a(null,r)}},AsyncRenderer.mergeNativeBlend=function(e,n){return function(r,a){CanvasRenderer.mergeNativeBlend(e,n)(r),a(null,r)}},AsyncRenderer.merge=function(e,n,r){var a=CanvasRenderer.createRenderPipe(AsyncRenderer,e,n);a.reverse();var t=CanvasRenderer.singleLayerWithOpacity(e,n[0]);a.push(function(e,n){n(null,t)}),async.compose.apply(null,a)(null,function(){r(t)})},AsyncRenderer.composite=function(e,n,r){return n&&0!==n.length?1===n.length?void r(CanvasRenderer.singleLayerWithOpacity(e,n[0])):void AsyncRenderer.merge(e,n,r):void r(null)},AsyncRenderer.render=function(e,n){async.map(e.layers,processLayers(e),function(r,a){n&&AsyncRenderer.composite(e,CanvasRenderer.getLayerData(e,a),n)})},AsyncRenderer.renderBW=function(e,n){AsyncRenderer.render(e,function(e){var r=(e.getContext("2d").getImageData(0,0,e.width,e.height).data,{name:"desaturate",options:{method:"ITU-R BT.709"}}),a=AsyncRenderer.processImage([r]);a(e,function(e,r){n(r)})})},module.exports=AsyncRenderer;


},{"./canvasrenderer":17,"./process":19,"async":1}],16:[function(require,module,exports){
"use strict";function addAliases(n){var t,e,i,o=Object.keys(aliases);for(t=0;t<o.length;t+=1)e=o[t],i=aliases[e],n[e]=n[i]}function realBlendMode(n){return void 0!==aliases[n]?aliases[n]:n}function getNativeModes(){if("undefined"==typeof document)return{};var n,t,e,i,o={},r=document.createElement("canvas"),a=r.getContext("2d"),l=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"],d=["multiply","screen","overlay","soft-light","hard-light","color-dodge","color-burn","darken","lighten","difference","exclusion","hue","saturation","luminosity","color","add","subtract","average","negation"],c=["divide","darker-color","lighter-color","linear-burn","linear-light","vivid-light","pin-light","hard-mix"];for(n=0;n<l.length;n+=1)o[l[n]]=!0;for(n=0;n<c.length;n+=1)o[c[n]]=!1;for(r.width=1,r.height=1,n=0;n<d.length;n+=1){t=d[n],e="darken"===t,i=!1,a.save();try{a.fillStyle=e?"#300":"#a00",a.fillRect(0,0,1,1),a.globalCompositeOperation=t,a.globalCompositeOperation===t&&(a.fillStyle=e?"#a00":"#300",a.fillRect(0,0,1,1),i=a.getImageData(0,0,1,1).data[0]!==(e?170:51))}catch(u){}a.restore(),o[t]=i}return addAliases(o),o}function _blend(n,t,e,i,o){process(n,t,e,i,o)}function _wrap(n){return function(t,e,i,o,r){r.type=n,_blend(t,e,i,o,r)}}var blend,process,aliases={normal:"source-over","linear-dodge":"add"};process=function(n,t,e,i,o){function r(n,t,e){n/=255,t/=255,e/=255;var i,o,r;return n===t&&t===e?(o=0,i=0):n>=t&&t>=e?(o=n-e,i=60*(t-e)/o):t>n&&n>=e?(o=t-e,i=60*(t-n)/o+60):t>=e&&e>n?(o=t-n,i=60*(e-n)/o+120):e>t&&t>n?(o=e-n,i=60*(e-t)/o+180):e>n&&n>=t?(o=e-t,i=60*(n-t)/o+240):(o=n-t,i=60*(n-e)/o+300),r=V*n+W*t+X*e,[i%360,U(T(o,0),1),U(T(r,0),1)]}function a(n,t,e){n%=360;var i,o,r,a;return n>=0&&60>n?(a=t*n/60,r=e-V*t-W*a,i=r+t,o=r+a):n>=60&&120>n?(a=t*(n-60)/60,o=e+X*t+V*a,r=o-t,i=o-a):n>=120&&180>n?(a=t*(n-120)/60,i=e-W*t-X*a,o=i+t,r=i+a):n>=180&&240>n?(a=t*(n-180)/60,r=e+V*t+W*a,i=r-t,o=r-a):n>=240&&300>n?(a=t*(n-240)/60,o=e-X*t-V*a,r=o+t,i=o+a):(a=t*(n-300)/60,i=e+W*t+X*a,o=i-t,r=i-a),i=255*U(T(i,0),1),o=255*U(T(o,0),1),r=255*U(T(r,0),1),[i,o,r]}function l(){L=I+G-G*F,P=q+H-H*F,Q=z+J-J*F}function d(){L=I*G+I*(1-K)+G*(1-F),P=q*H+q*(1-K)+H*(1-F),Q=z*J+z*(1-K)+J*(1-F)}function c(){L=T(G*F-I*K,0)+I*(1-K)+G*(1-F),P=T(H*F-q*K,0)+q*(1-K)+H*(1-F),Q=T(J*F-z*K,0)+z*(1-K)+J*(1-F)}function u(){L=0===I?0:G/I*255,P=0===q?0:H/q*255,Q=0===z?0:J/z*255}function s(){L=I+G-I*G,P=q+H-q*H,Q=z+J-z*J}function f(){L=T(I*K,G*F)+I*(1-K)+G*(1-F),P=T(q*K,H*F)+q*(1-K)+H*(1-F),Q=T(z*K,J*F)+z*(1-K)+J*(1-F)}function h(){L=U(I*K,G*F)+I*(1-K)+G*(1-F),P=U(q*K,H*F)+q*(1-K)+H*(1-F),Q=U(z*K,J*F)+z*(1-K)+J*(1-F)}function g(){I*K*.3+q*K*.59+z*K*.11>=G*F*.3+H*F*.59+J*F*.11?(L=G*F,P=H*F,Q=J*F):(L=I*K,P=q*K,Q=z*K),L+=I*(1-K)+G*(1-F),P+=q*(1-K)+H*(1-F),Q+=z*(1-K)+J*(1-F)}function v(){G*F*.3+H*F*.59+J*F*.11>I*K*.3+q*K*.59+z*K*.11?(L=G*F,P=H*F,Q=J*F):(L=I*K,P=q*K,Q=z*K),L+=I*(1-K)+G*(1-F),P+=q*(1-K)+H*(1-F),Q+=z*(1-K)+J*(1-F)}function y(){L=U(G+I,255),P=U(H+q,255),Q=U(J+z,255)}function p(){L=G+I,P=H+q,Q=J+z,L=255>L?0:L-255,P=255>P?0:P-255,Q=255>Q?0:Q-255}function m(){L=I+G-2*U(I*K,G*F),P=q+H-2*U(q*K,H*F),Q=z+J-2*U(z*K,J*F)}function b(){L=I*K+G*F-2*I*G+I*(1-K)+G*(1-F),P=q*K+H*F-2*q*H+q*(1-K)+H*(1-F),Q=z*K+J*F-2*z*J+z*(1-K)+J*(1-F)}function x(){L=K>=2*G?2*I*G+I*(1-K)+G*(1-F):I*(1+K)+G*(1+F)-2*G*I-K*F,P=K>=2*H?2*q*H+q*(1-K)+H*(1-F):q*(1+K)+H*(1+F)-2*H*q-K*F,Q=K>=2*J?2*z*J+z*(1-K)+J*(1-F):z*(1+K)+J*(1+F)-2*J*z-K*F}function k(){var n,t=Math.pow;return 0===K?(L=I,P=q,void(Q=z)):(n=G/K,F>=2*I?L=G*(F+(2*I-F)*(1-n))+I*(1-K)+G*(1-F):2*I>F&&K>=4*G?L=K*(2*I-F)*(16*t(n,3)-12*t(n,2)-3*n)+I-I*K+G:2*I>F&&4*G>K&&(L=K*(2*I-F)*(t(n,.5)-n)+I-I*K+G),n=H/K,F>=2*q?P=H*(F+(2*q-F)*(1-n))+q*(1-K)+H*(1-F):2*q>F&&K>=4*H?P=K*(2*q-F)*(16*t(n,3)-12*t(n,2)-3*n)+q-q*K+H:2*q>F&&4*H>K&&(P=K*(2*q-F)*(t(n,.5)-n)+q-q*K+H),n=J/K,void(F>=2*z?Q=J*(F+(2*z-F)*(1-n))+z*(1-K)+J*(1-F):2*z>F&&K>=4*J?Q=K*(2*z-F)*(16*t(n,3)-12*t(n,2)-3*n)+z-z*K+J:2*z>F&&4*J>K&&(Q=K*(2*z-F)*(t(n,.5)-n)+z-z*K+J)))}function w(){L=F>=2*I?2*I*G+I*(1-K)+G*(1-F):I*(1+K)+G*(1+F)-F*K-2*I*G,P=F>=2*q?2*q*H+q*(1-K)+H*(1-F):q*(1+K)+H*(1+F)-F*K-2*q*H,Q=F>=2*z?2*z*J+z*(1-K)+J*(1-F):z*(1+K)+J*(1+F)-F*K-2*z*J}function M(){return 0===K?(L=I,P=q,void(Q=z)):(I===F&&0===G?L=I*(1-K):I===F?L=F*K+I*(1-K)+G*(1-F):F>I&&(L=F*K*U(1,G/K*F/(F-I))+I*(1-K)+G*(1-F)),q===F&&0===H?P=q*(1-K):I===F?P=F*K+q*(1-K)+H*(1-F):F>I&&(P=F*K*U(1,H/K*F/(F-q))+q*(1-K)+H*(1-F)),void(z===F&&0===J?Q=z*(1-K):I===F?Q=F*K+z*(1-K)+J*(1-F):F>I&&(Q=F*K*U(1,J/K*F/(F-z))+z*(1-K)+J*(1-F))))}function _(){return 0===K?(L=I,P=q,void(Q=z)):(0===I&&G===K?L=F*K+G*(1-F):0===I?L=G*(1-F):I>0&&(L=F*K*(1-U(1,(1-G/K)*F/I))+I*(1-K)+G*(1-F)),0===q&&H===K?P=F*K+H*(1-F):0===q?P=H*(1-F):q>0&&(P=F*K*(1-U(1,(1-H/K)*F/q))+q*(1-K)+H*(1-F)),void(0===z&&J===K?Q=F*K+J*(1-F):0===z?Q=J*(1-F):z>0&&(Q=F*K*(1-U(1,(1-J/K)*F/z))+z*(1-K)+J*(1-F))))}function O(){var n=2*I+G-256,t=2*q+H-256,e=2*z+J-256;L=0>n||128>I&&0>n?0:n>255?255:n,P=0>t||128>q&&0>t?0:t>255?255:t,Q=0>e||128>z&&0>e?0:e>255?255:e}function A(){var n;128>I?I?(n=255-(255-G<<8)/(2*I),L=0>n?0:n):L=0:(n=2*I-256,255>n?(n=(G<<8)/(255-n),L=n>255?255:n):L=0>n?0:n),128>q?q?(n=255-(255-H<<8)/(2*q),P=0>n?0:n):P=0:(n=2*q-256,255>n?(n=(H<<8)/(255-n),P=n>255?255:n):P=0>n?0:n),128>z?z?(n=255-(255-J<<8)/(2*z),Q=0>n?0:n):Q=0:(n=2*z-256,255>n?(n=(J<<8)/(255-n),Q=n>255?255:n):Q=0>n?0:n)}function B(){var n;128>I?(n=2*I,L=n>G?G:n):(n=2*I-256,L=G>n?G:n),128>q?(n=2*q,P=n>H?H:n):(n=2*q-256,P=H>n?H:n),128>z?(n=2*z,Q=n>J?J:n):(n=2*z-256,Q=J>n?J:n)}function C(){var n;128>I?L=128>255-(255-G<<8)/(2*I)||0===I?0:255:(n=2*I-256,L=255>n&&128>(G<<8)/(255-n)?0:255),128>q?P=128>255-(255-H<<8)/(2*q)||0===q?0:255:(n=2*q-256,P=255>n&&128>(H<<8)/(255-n)?0:255),128>z?Q=128>255-(255-J<<8)/(2*z)||0===z?0:255:(n=2*z-256,Q=255>n&&128>(J<<8)/(255-n)?0:255)}function N(){var n=r(G,H,J),t=r(I,q,z),e=a(t[0],n[1],n[2]);L=e[0],P=e[1],Q=e[2]}function j(){var n=r(G,H,J),t=r(I,q,z),e=a(n[0],t[1],n[2]);L=e[0],P=e[1],Q=e[2]}function R(){var n=r(G,H,J),t=r(I,q,z),e=a(n[0],n[1],t[2]);L=e[0],P=e[1],Q=e[2]}function S(){var n=r(G,H,J),t=r(I,q,z),e=a(t[0],t[1],n[2]);L=e[0],P=e[1],Q=e[2]}function D(n,t){var e=n.x+n.width,i=n.y+n.height,o=t.x+t.width,r=t.y+t.height,a=T(n.x,t.x),l=T(n.y,t.y),d=T(U(e,o)-a,0),c=T(U(i,r)-l,0);return[a,l,d,c]}var E,I,q,z,F,G,H,J,K,L,P,Q,T=Math.max,U=Math.min,V=.2126,W=.7152,X=.0722;E={"source-over":l,multiply:d,subtract:c,divide:u,screen:s,lighten:f,darken:h,"darker-color":g,"lighter-color":v,add:y,"linear-burn":p,difference:m,exclusion:b,overlay:x,"soft-light":k,"hard-light":w,"color-dodge":M,"color-burn":_,"linear-light":O,"vivid-light":A,"pin-light":B,"hard-mix":C,hue:N,saturation:j,luminosity:R,color:S},function(){function r(){F=y[d+3]/255*p,K=n[l+3]/255,h=F+K-F*K,g=255/h,I=y[d]/255*F,q=y[d+1]/255*F,z=y[d+2]/255*F,G=n[l]/255*K,H=n[l+1]/255*K,J=n[l+2]/255*K,m(),t[l]=L*g,t[l+1]=P*g,t[l+2]=Q*g,t[l+3]=255*h}function a(){G=n[l],H=n[l+1],J=n[l+2],I=y[d],q=y[d+1],z=y[d+2],m(),t[l]=L,t[l+1]=P,t[l+2]=Q,t[l+3]=n[l+3],s=p*y[d+3]/255,1>s&&(f=1-s,t[l]=n[l]*f+t[l]*s,t[l+1]=n[l+1]*f+t[l+1]*s,t[l+2]=n[l+2]*f+t[l+2]*s)}var l,d,c,u,s,f,h,g,v,y=o.data,p=0===o.opacity?0:o.opacity||1,m=E[o.type||"_svg_normal"],b=o.dx||0,x=o.dy||0,k=D({x:0,y:0,width:e,height:i},{x:b,y:x,width:o.width,height:o.height}),w=k[0],M=k[1],_=k[2],O=k[3];for(v=0===m.name.indexOf("_svg_")?r:a,u=0;i>u;u+=1)for(c=0;e>c;c+=1)l=4*(u*e+c),u>=M&&c>=w&&w+_>c&&M+O>u?(d=4*((u-x)*o.width+c-b),v()):(t[l]=n[l],t[l+1]=n[l+1],t[l+2]=n[l+2],t[l+3]=n[l+3])}()},blend=function(){for(var n,t={blend:_blend},e=["source-over","add","multiply","subtract","divide","screen","lighten","darken","darker-color","lighter-color","linear-burn","difference","exclusion","overlay","soft-light","hard-light","color-dodge","color-burn","linear-light","vivid-light","pin-light","hard-mix","hue","saturation","luminosity","color"],i=0;i<e.length;i+=1)n=e[i],t[n]=_wrap(n);for(e=Object.keys(e),i=0;i<e.length;i+=1);return addAliases(t),t.getNativeModes=getNativeModes,t.realBlendMode=realBlendMode,t}(),module.exports=blend;


},{}],17:[function(require,module,exports){
"use strict";function createImageData(e,a,t){return e.createImageData?e.createImageData(a,t):e.getImageData(0,0,a,t)}function transformLayer(e,a,t){var r=t.transform.matrix();e.translate(a.width/2,a.height/2),e.transform(r[0],r[1],r[3],r[4],r[6],r[7]),(t.flip_h||t.flip_v)&&e.scale(t.flip_h?-1:1,t.flip_v?-1:1),e.translate(-t.img.width/2,-t.img.height/2)}function transformRect(e,a){var t,r,n,i,d,h=a.img.width,o=a.img.height,s={x:0,y:0},g={x:h,y:0},l={x:0,y:o},m={x:h,y:o},c=[s,g,l,m],v=util.transform();v=v.translate(e.width/2,e.height/2),v=v.append(a.transform),v=v.translate(-a.img.width/2,-a.img.height/2);for(var u=0;4>u;u+=1)t=v.transformPoint(c[u]),0===u?(r=i=t.x,n=d=t.y):(t.x<r&&(r=t.x),t.x>i&&(i=t.x),t.y<n&&(n=t.y),t.y>d&&(d=t.y));return{x:r,y:n,width:i-r,height:d-n}}function rectIntersect(e,a){var t=e.x+e.width,r=e.y+e.height,n=a.x+a.width,i=a.y+a.height,d=Math.max(e.x,a.x),h=Math.max(e.y,a.y),o=Math.max(Math.min(t,n)-d,0),s=Math.max(Math.min(r,i)-h,0);return{x:d,y:h,width:o,height:s}}function calcLayerRect(e,a){var t=transformRect(e,a);return t=rectIntersect(t,{x:0,y:0,width:e.width,height:e.height}),{x:Math.round(t.x),y:Math.round(t.y),width:Math.ceil(t.width),height:Math.ceil(t.height)}}function getTransformedLayerData(e,a,t){var r=document.createElement("canvas"),n=r.getContext("2d");return r.width=t.width,r.height=t.height,n.translate(-t.x,-t.y),transformLayer(n,e,a),n.drawImage(a.img,0,0),n.getImageData(0,0,t.width,t.height)}var blend=require("./blend"),process=require("./process"),util=require("./util"),nativeBlendModes=blend.getNativeModes(),CanvasRenderer={};CanvasRenderer.toImage=function(e){var a=new Image;return a.width=e.width,a.height=e.height,a.src=e.toDataURL(),a},CanvasRenderer.load=function(e,a){return a.isFill()?CanvasRenderer.generateColor(e,a):a.isGradient()?CanvasRenderer.generateGradient(e,a):a.isHtmlCanvas()?CanvasRenderer.loadHtmlCanvas(a.data):a.isImage()?CanvasRenderer.loadImage(a.data):a.isImageCanvas()?CanvasRenderer.loadImageCanvas(a.data):void 0},CanvasRenderer.loadHtmlCanvas=function(e){return e},CanvasRenderer.loadImageCanvas=function(e){return e.render()},CanvasRenderer.loadImage=function(e){var a=document.createElement("canvas"),t=a.getContext("2d");return a.width=e.width,a.height=e.height,t.drawImage(e,0,0,a.width,a.height),a},CanvasRenderer.generateColor=function(e,a){var t=void 0!==a.width?a.width:e.width,r=void 0!==a.height?a.height:e.height,n=document.createElement("canvas"),i=n.getContext("2d");return n.width=t,n.height=r,i.fillStyle=a.data,i.fillRect(0,0,t,r),n},CanvasRenderer.generateGradient=function(e,a){var t,r,n,i,d,h=void 0!==a.width?a.width:e.width,o=void 0!==a.height?a.height:e.height,s=h/2,g=o/2,l=document.createElement("canvas"),m=l.getContext("2d"),c=a.data,v=c.type||"linear",u=c.rotation||0;return"radial"===v?t=m.createRadialGradient(s,g,0,s,g,Math.min(h,o)/2):(0>u&&(u+=360),u>=0&&45>u?(r=0,n=o/2*(45-u)/45,i=h,d=o-n):u>=45&&135>u?(r=h*(u-45)/90,n=0,i=h-r,d=o):u>=135&&225>u?(r=h,n=o*(u-135)/90,i=0,d=o-n):u>=225&&315>u?(r=h*(1-(u-225)/90),n=o,i=h-r,d=0):u>=315&&(r=0,n=o-o/2*(u-315)/45,i=h,d=o-n),t=m.createLinearGradient(r,n,i,d)),t.addColorStop(c.spread||0,c.startColor),t.addColorStop(1,c.endColor),l.width=h,l.height=o,m.fillStyle=t,m.fillRect(0,0,h,o),l},CanvasRenderer.processImage=function(e,a){if(0===a.length)return e;for(var t,r,n=e.getContext("2d"),i=e.width,d=e.height,h=n.getImageData(0,0,i,d),o=createImageData(n,i,d),s=0;s<a.length;s+=1)s>0&&(r=h,h=o,o=r),t=a[s],process[t.name](h.data,o.data,i,d,t.options);return n.putImageData(o,0,0),e},CanvasRenderer.processMask=function(e,a){if(0===a.layers.length)return e;a.width=e.width,a.height=e.height;var t=CanvasRenderer.renderBW(a),r=t.getContext("2d").getImageData(0,0,t.width,t.height).data,n={name:"mask",options:{data:r,x:0,y:0,width:t.width,height:t.height}};return CanvasRenderer.processImage(e,[n])},CanvasRenderer.processLayer=function(e,a){var t=CanvasRenderer.load(e,a),r=CanvasRenderer.processMask(t,a.mask);return CanvasRenderer.processImage(r,a.filters)},CanvasRenderer.mergeManualBlend=function(e,a){return function(t){for(var r,n,i,d,h,o,s=t.getContext("2d"),g=e.width,l=e.height,m=s.getImageData(0,0,g,l),c=createImageData(s,g,l),v=0;v<a.length;v+=1)if(r=a[v],o=calcLayerRect(e,r),o.width>0&&o.height>0){if(v>0&&(d=m,m=c,c=d),i=getTransformedLayerData(e,r,o),h={data:i.data,width:o.width,height:o.height,opacity:r.opacity,dx:o.x,dy:o.y},void 0===blend[r.blendmode])throw new Error("No blend mode named '"+r.blendmode+"'");n=blend.realBlendMode(r.blendmode),blend[n](m.data,c.data,g,l,h)}return s.putImageData(c,0,0),t}},CanvasRenderer.singleLayerWithOpacity=function(e,a){var t=document.createElement("canvas"),r=t.getContext("2d");return t.width=e.width,t.height=e.height,r.save(),transformLayer(r,e,a),1!==a.opacity&&(r.globalAlpha=a.opacity),r.drawImage(a.img,0,0),r.restore(),t},CanvasRenderer.mergeNativeBlend=function(e,a){return function(t){for(var r,n=t.getContext("2d"),i=0;i<a.length;i+=1)r=a[i],n.save(),transformLayer(n,e,r),1!==r.opacity&&(n.globalAlpha=r.opacity),"source-over"!==r.blendmode&&(n.globalCompositeOperation=blend.realBlendMode(r.blendmode)),n.drawImage(r.img,0,0),n.restore();return t}},CanvasRenderer.createRenderPipe=function(e,a,t){function r(){if(void 0!==i){var t=i?e.mergeNativeBlend:e.mergeManualBlend;o.push(t(a,d))}}for(var n,i,d,h,o=[],s=1;s<t.length;s+=1)h=t[s],n=h.blendmode,(void 0===i||i!==nativeBlendModes[n])&&(r(),d=[]),d.push(h),i=nativeBlendModes[n],s===t.length-1&&r();return o},CanvasRenderer.merge=function(e,a){for(var t=CanvasRenderer.createRenderPipe(CanvasRenderer,e,a),r=CanvasRenderer.singleLayerWithOpacity(e,a[0]),n=0;n<t.length;n+=1)r=t[n](r);return r},CanvasRenderer.composite=function(e,a){return a&&0!==a.length?1===a.length?CanvasRenderer.singleLayerWithOpacity(e,a[0]):CanvasRenderer.merge(e,a):null},CanvasRenderer.getLayerData=function(e,a){for(var t,r,n,i=[],d=0;d<a.length;d+=1)r=e.layers[d],n=a[d],t={img:n,opacity:r.opacity,blendmode:r.blendmode,transform:r.transform,flip_h:r.flip_h,flip_v:r.flip_v},i.push(t);return i},CanvasRenderer.render=function(e){for(var a=[],t=0;t<e.layers.length;t+=1)a.push(CanvasRenderer.processLayer(e,e.layers[t]));return CanvasRenderer.composite(e,CanvasRenderer.getLayerData(e,a))},CanvasRenderer.renderBW=function(e){var a=CanvasRenderer.render(e),t=(a.getContext("2d").getImageData(0,0,a.width,a.height).data,{name:"desaturate",options:{method:"ITU-R BT.709"}});return CanvasRenderer.processImage(a,[t])},module.exports=CanvasRenderer;


},{"./blend":16,"./process":19,"./util":20}],18:[function(require,module,exports){
"use strict";function toColor(t,e,r,a,n){var i,o,s,h,l,g,m,u;if(void 0===t)i=o=s=0,h=1;else if(Array.isArray(t))u=e||{},i=void 0!==t[0]?t[0]:0,o=void 0!==t[1]?t[1]:0,s=void 0!==t[2]?t[2]:0,h=void 0!==t[3]?t[3]:u.base||1;else if(void 0!==t.r)u=e||{},i=t.r,o=t.g,s=t.b,h=void 0!==t.a?t.a:u.base||1;else if("string"==typeof t){if(0===t.indexOf("#"))return t;if(0===t.indexOf("rgb"))return t;if(-1!==colors.indexOf(t))return t}else"number"==typeof t&&(1===arguments.length?(i=o=s=t,h=1):2===arguments.length?(i=o=s=t,"number"==typeof e?h=e:(u=e,h=u.base||1)):3===arguments.length?"number"==typeof r?(i=t,o=e,s=r,h=1):(i=o=s=t,h=e,u=r):4===arguments.length?(i=t,o=e,s=r,"number"==typeof a?h=a:(u=a||{},h=u.base||1)):(i=t,o=e,s=r,h=a,u=n));if("number"!=typeof i||"number"!=typeof o||"number"!=typeof s||"number"!=typeof h)throw new Error("Invalid color arguments");return u=u||{},void 0!==u.base&&(i/=u.base,o/=u.base,s/=u.base,h/=u.base),l=Math.round(255*i),g=Math.round(255*o),m=Math.round(255*s),"rgba("+l+", "+g+", "+m+", "+h+")"}function toGradientData(t,e,r,a,n){var i,o,s,h,l,g,m={};if(1===arguments.length)g=t||{},i=g.startColor,o=g.endColor,s=g.type,h=g.rotation,l=g.spread;else if(arguments.length>=2)if(i=t,o=e,s="linear",h=0,l=0,3===arguments.length)"string"==typeof r?s=r:"number"==typeof r&&(h=r);else if(4===arguments.length)if("number"==typeof r)h=r,l=a;else if("linear"===r)h=a;else{if("radial"!==r)throw new Error("Wrong argument provided: "+r);s=r,l=a}else 5===arguments.length&&(s=r,h=a,l=n);if(!i&&0!==i)throw new Error("No startColor was given.");if(!o&&0!==o)throw new Error("No endColor was given.");try{m.startColor=toColor(i)}catch(u){throw new Error("startColor is not a valid color: "+i)}try{m.endColor=toColor(o)}catch(d){throw new Error("endColor is not a valid color: "+o)}if(void 0===s&&(s="linear"),"linear"!==s&&"radial"!==s)throw new Error("Unknown gradient type: "+s);if(m.type=s,void 0===l&&(l=0),"number"!=typeof l)throw new Error("Spread value is not a number: "+l);if("linear"===s){if(void 0===h&&(h=0),"number"!=typeof h)throw new Error("Rotation value is not a number: "+h);m.rotation=h}return m.spread=clamp(l,0,.99),m}function findType(t){if("string"==typeof t)return TYPE_PATH;if(t instanceof Image)return TYPE_IMAGE;if(t instanceof HTMLCanvasElement)return TYPE_HTML_CANVAS;if(t instanceof ImageCanvas)return TYPE_IMAGE_CANVAS;if(void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&void 0!==t.a)return TYPE_FILL;if(void 0!==t.startColor&&void 0!==t.endColor)return TYPE_GRADIENT;throw new Error("Cannot establish type for data ",t)}function isPoint(t){return t?void 0!==t.x&&void 0!==t.y:!1}function pointFromArray(t){var e=t[0],r=t.length>1?t[1]:e;return{x:e,y:r}}function pointFromNumber(t){return{x:t,y:t}}function isValidArg(t){return void 0!==t&&null!==t}function convertArg(t){return Array.isArray(t)?pointFromArray(t):"number"==typeof t?pointFromNumber(t):isPoint(t)?t:void 0}function loadImage(t,e){var r=new Image;r.onload=function(){e(null,[t,this])},r.src=t}function loadImages(t,e){async.map(t,loadImage,function(t,r){if(e){for(var a,n,i={},o=0;o<r.length;o+=1)a=r[o][0],n=r[o][1],i[a]=n;e(i)}})}function rectUnite(t,e){var r=Math.min(t.x,e.x),a=Math.min(t.y,e.y),n=Math.max(t.x+t.width,e.x+e.width)-r,i=Math.max(t.y+t.height,e.y+e.height)-a;return{x:r,y:a,width:n,height:i}}function merge(t){var e,r,a,n;for(e=0;e<t.length;e+=1)r=t[e],a=0===e?r.bounds():rectUnite(a,r.bounds());var i=a.width/2+a.x,o=a.height/2+a.y,s=new ImageCanvas(a.width,a.height);for(e=0;e<t.length;e+=1)n=s.addLayer(t[e].toLayer()),n.translate(-i,-o);return new Img(s.render(),i,o)}var util=require("./util"),CanvasRenderer=require("./canvasrenderer"),AsyncRenderer=require("./asyncrenderer"),img,ImageCanvas,Layer,Img,DEFAULT_WIDTH=800,DEFAULT_HEIGHT=800,TYPE_PATH="path",TYPE_IMAGE="image",TYPE_HTML_CANVAS="htmlCanvas",TYPE_IMAGE_CANVAS="iCanvas",TYPE_FILL="fill",TYPE_GRADIENT="gradient",IDENTITY_TRANSFORM=util.transform(),Transform=IDENTITY_TRANSFORM,clamp=util.clamp,colors=["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"];Layer=function(t,e){e||(e=findType(t)),this.data=t,this.type=e,(e===TYPE_HTML_CANVAS||e===TYPE_IMAGE_CANVAS||e===TYPE_IMAGE)&&(this.width=t.width,this.height=t.height),this.opacity=1,this.blendmode="source-over",this.transform=IDENTITY_TRANSFORM,this.flip_h=!1,this.flip_v=!1,this.mask=new ImageCanvas,this.filters=[]},Layer.Transform=Layer.IDENTITY_TRANSFORM=IDENTITY_TRANSFORM,Layer.prototype.clone=function(){function t(t){var e,r,a={};if(a.name=t.name,void 0!==t.options){a.options={};for(var n=Object.keys(t.options),i=0;i<n.length;i+=1)e=n[i],r=t.options[e],Array.isArray(r)?a.options[e]=r.slice(0):a.options[e]=r}return a}var e=Object.create(Layer.prototype);e.data=this.data,e.type=this.type,e.width=this.width,e.height=this.height,e.opacity=this.opacity,e.blendmode=this.blendmode,e.transform=this.transform,e.flip_h=this.flip_h,e.flip_v=this.flip_v,e.mask=this.mask.clone(),e.filters=[],this.type===TYPE_IMAGE_CANVAS?e.data=this.data.clone():this.type===TYPE_GRADIENT&&(e.data={startColor:this.data.startColor,endColor:this.data.endColor,type:this.data.type,rotation:this.data.rotation,spread:this.data.spread});for(var r=0;r<this.filters.length;r+=1)e.filters.push(t(this.filters[r]));return e},Layer.prototype.setOpacity=function(t){this.opacity=clamp(t,0,1)},Layer.prototype.translate=function(t,e){e=void 0===e?0:e;var r=Transform.translate(t,e);this.transform=this.transform.prepend(r)},Layer.prototype.scale=function(t,e){e=void 0===e?t:e;var r=Transform.scale(t,e);this.transform=this.transform.prepend(r)},Layer.prototype.rotate=function(t){var e=Transform.rotate(t);this.transform=this.transform.prepend(e)},Layer.prototype.skew=function(t,e){e=void 0===e?t:e;var r=Transform.skew(t,e);this.transform=this.transform.prepend(r)},Layer.prototype.flipHorizontal=function(t){void 0!==t?this.flip_h=t:this.flip_h=!this.flip_h},Layer.prototype.flipVertical=function(t){void 0!==t?this.flip_v=t:this.flip_v=!this.flip_v},Layer.prototype.addFilter=function(t,e){this.filters.push({name:t,options:e})},Layer.prototype.draw=function(t){var e=void 0===this.width?DEFAULT_WIDTH:this.width,r=void 0===this.height?DEFAULT_HEIGHT:this.height,a=new ImageCanvas(e,r);a.addLayer(this),a.draw(t)},Layer.prototype.toCanvas=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");return this.draw(e),t},Layer.fromFile=function(t){return new Layer(t,TYPE_PATH)},Layer.fromImage=function(t){return new Layer(t,TYPE_IMAGE)},Layer.fromCanvas=function(t){return t instanceof HTMLCanvasElement?Layer.fromHtmlCanvas(t):Layer.fromImageCanvas(t)},Layer.fromHtmlCanvas=function(t){return new Layer(t,TYPE_HTML_CANVAS)},Layer.fromImageCanvas=function(t){return new Layer(t,TYPE_IMAGE_CANVAS)},Layer.fromColor=function(t){return new Layer(toColor(t),TYPE_FILL)},Layer.fromGradient=function(){return new Layer(toGradientData.apply(null,arguments),TYPE_GRADIENT)},Layer.prototype.isPath=function(){return this.type===TYPE_PATH},Layer.prototype.isFill=function(){return this.type===TYPE_FILL},Layer.prototype.isGradient=function(){return this.type===TYPE_GRADIENT},Layer.prototype.isHtmlCanvas=function(){return this.type===TYPE_HTML_CANVAS},Layer.prototype.isImage=function(){return this.type===TYPE_IMAGE},Layer.prototype.isImageCanvas=function(){return this.type===TYPE_IMAGE_CANVAS};var Pixels=function(t){this.width=t.width,this.height=t.height;var e=t.getContext("2d");this._data=e.getImageData(0,0,this.width,this.height),this.array=this._data.data};Pixels.prototype.get=function(t){t*=4;var e=this.array;return[e[t+0],e[t+1],e[t+2],e[t+3]]},Pixels.prototype.set=function(t,e){t*=4;var r=this.array;r[t+0]=e[0],r[t+1]=e[1],r[t+2]=e[2],r[t+3]=e[3]},Pixels.prototype.toCanvas=function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");return e.putImageData(this._data,0,0),t},ImageCanvas=function(t,e){t||(t=DEFAULT_WIDTH),e||(e=DEFAULT_HEIGHT),this.width=t,this.height=e,this.layers=[]},ImageCanvas.prototype.clone=function(){for(var t=new ImageCanvas(this.width,this.height),e=0;e<this.layers.length;e+=1)t.layers.push(this.layers[e].clone());return t},ImageCanvas.prototype.addLayer=function(t){var e;try{return this.addGradientLayer.apply(this,arguments)}catch(r){}try{return this.addColorLayer.apply(this,arguments)}catch(a){}if(1===arguments.length&&("string"==typeof t?e=new Layer(t,TYPE_PATH):t instanceof Layer?e=t:t instanceof HTMLCanvasElement?e=new Layer(t,TYPE_HTML_CANVAS):t instanceof Image?e=new Layer(t,TYPE_IMAGE):t instanceof ImageCanvas&&(e=new Layer(t,TYPE_IMAGE_CANVAS))),!e)throw new Error("Error creating layer.");return this.layers.push(e),e},ImageCanvas.prototype.addColorLayer=function(){var t=toColor.apply(null,arguments),e=new Layer(t,TYPE_FILL);return this.layers.push(e),e},ImageCanvas.prototype.addGradientLayer=function(){var t=toGradientData.apply(null,arguments),e=new Layer(t,TYPE_GRADIENT);return this.layers.push(e),e},ImageCanvas.prototype.render=function(t){var e=t?AsyncRenderer:CanvasRenderer;return e.render(this,t)},ImageCanvas.prototype.draw=function(t,e){if(e)this.render(function(e){t.drawImage(e,0,0,e.width,e.height)});else{var r=this.render();t.drawImage(r,0,0,r.width,r.height)}},Img=function(t,e,r){this.canvas=t,this.originalWidth=t?t.width:0,this.originalHeight=t?t.height:0,this.transform=e||r?Transform.translate(e,r):Layer.IDENTITY_TRANSFORM},Img.prototype.clone=function(){var t=new Img;return t.canvas=this.canvas,t.originalWidth=this.originalWidth,t.originalHeight=this.originalHeight,t.transform=this.transform,t},Img.prototype.withCanvas=function(t){var e=this.clone();return e.canvas=t,e},Img.prototype._transform=function(t){var e=this.clone();return e.transform=e.transform.prepend(t),e},Img.prototype.translate=function(t){var e=pointFromNumber(0),r=arguments;return 1===r.length&&isValidArg(t)?e=convertArg(t):2===r.length&&(e={x:r[0],y:r[1]}),0===e.x&&0===e.y?this:this._transform(Transform.translate(e.x,e.y))},Img.prototype.rotate=function(t){if(!t)return this;var e=pointFromNumber(0),r=arguments;return 2===r.length?e=convertArg(r[1]):3===r.length&&(e={x:r[1],y:r[2]}),this._transform(Transform.translate(e.x,e.y).rotate(t).translate(-e.x,-e.y))},Img.prototype.scale=function(t){var e=pointFromNumber(1),r=pointFromNumber(0),a=arguments;return 1===a.length&&isValidArg(t)?e=convertArg(t):2===a.length?"number"==typeof t&&"number"==typeof a[1]?e={x:a[0],y:a[1]}:(e=convertArg(t),r=convertArg(a[1])):4===a.length&&(e={x:a[0],y:a[1]},r={x:a[2],y:a[3]}),1===e.x&&1===e.y?this:this._transform(Transform.translate(r.x,r.y).scale(e.x,e.y).translate(-r.x,-r.y))},Img.prototype.skew=function(t){var e=pointFromNumber(0),r=pointFromNumber(0),a=arguments;return 1===a.length&&isValidArg(t)?e=convertArg(t):2===a.length?"number"==typeof t&&"number"==typeof a[1]?e={x:a[0],y:a[1]}:(e=convertArg(t),r=convertArg(a[1])):4===a.length&&(e={x:a[0],y:a[1]},r={x:a[2],y:a[3]}),0===e.x&&0===e.y?this:this._transform(Transform.translate(r.x,r.y).skew(e.x,e.y).translate(-r.x,-r.y))},Img.prototype.transformed=function(){return img.merge([this])},Img.prototype.bounds=function(){for(var t,e,r,a,n,i=this.transform,o=this.originalWidth/2,s=this.originalHeight/2,h={x:-o,y:-s},l={x:o,y:-s},g={x:-o,y:s},m={x:o,y:s},u=[h,l,g,m],d=0;4>d;d+=1)t=i.transformPoint(u[d]),0===d?(e=a=t.x,r=n=t.y):(t.x<e&&(e=t.x),t.x>a&&(a=t.x),t.y<r&&(r=t.y),t.y>n&&(n=t.y));return{x:e,y:r,width:a-e,height:n-r}},Img.prototype.colorize=function(t){var e=Layer.fromColor(t);e.width=this.originalWidth,e.height=this.originalHeight;var r=new Img(e.toCanvas());return r=r._transform(this.transform.matrix()),img.merge([this,r])},Img.prototype.desaturate=function(t){var e=this.toLayer(!1);return e.addFilter("desaturate",t),this.withCanvas(e.toCanvas())},Img.prototype.crop=function(t){function e(t,e){var r=t.x+t.width,a=t.y+t.height,n=e.x+e.width,i=e.y+e.height,o=Math.max(t.x,e.x),s=Math.max(t.y,e.y),h=Math.max(Math.min(r,n)-o,0),l=Math.max(Math.min(a,i)-s,0);return{x:o,y:s,width:h,height:l}}var r=this.bounds(),a=t.bounds(),n=e(r,a),i=Math.ceil(n.width),o=Math.ceil(n.height);if(0===n.width||0===n.height)throw new Error("Resulting image has no dimensions");var s=new img.ImageCanvas(i,o),h=s.addLayer(this.toLayer());return h.translate(i/2-a.width-a.x,o/2-a.height-a.y),i<a.width&&n.x>r.x&&h.translate(a.width-i,0),o<a.height&&n.y>r.y&&h.translate(0,a.height-o),new Img(s.render(),n.x+i/2,n.y+o/2)},Img.prototype.draw=function(t){t.save();var e=this.transform.matrix();t.transform(e[0],e[1],e[3],e[4],e[6],e[7]),t.translate(-this.originalWidth/2,-this.originalHeight/2),t.drawImage(this.canvas,0,0),t.restore()},Img.prototype.toLayer=function(t){var e=document.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height;var r=e.getContext("2d");r.drawImage(this.canvas,0,0);var a=img.Layer.fromHtmlCanvas(e);return void 0===t&&(t=!0),t&&(a.transform=this.transform),a},Img.prototype.getPixels=function(){return new Pixels(this.canvas)},Img.prototype.toImage=function(){var t=this.bounds(),e=this.crop({bounds:function(){return t}}),r=new Image;return r.width=e.canvas.width,r.height=e.canvas.height,r.src=e.canvas.toDataURL(),r},img={},img.Layer=Layer,img.ImageCanvas=ImageCanvas,img.Img=Img,img.Pixels=Pixels;var async=require("async");img.loadImages=loadImages,img.merge=merge,module.exports=img;


},{"./asyncrenderer":15,"./canvasrenderer":17,"./util":20,"async":1}],19:[function(require,module,exports){
"use strict";function defaultOptions(o,n){if(!o)return n;var t,r={};for(t in n)n.hasOwnProperty(t)&&("undefined"==typeof o[t]?r[t]=n[t]:r[t]=o[t]);return r}function smoothstep(o,n,t){return o>t?0:t>=n?1:(t=(t-o)/(n-o),t*t*(3-2*t))}function noise(){return.5*Math.random()+.5}function colorDistance(o,n,t){return clamp(o*n+(1-o)*t,0,255)}function convolve3x3(o,n,t,r,a,e,i,u){var f,l,c,s,p,v,d,m,h,x,g,O,M,T,I,b,y,_,z,U,k,S,w=a[0][0],B=a[0][1],R=a[0][2],P=a[1][0],L=a[1][1],N=a[1][2],Y=a[2][0],q=a[2][1],A=a[2][2];for(l=0;r>l;l+=1)for(m=l*t*4,h=m-4*t,x=m+4*t,1>l&&(h=m),l>=t-1&&(x=m),f=0;t>f;f+=1)c=4*(l*t+f),g=4*f,O=g-4,M=g+4,1>f&&(O=g),f>=t-1&&(M=g),T=h+O,I=h+g,b=h+M,y=m+O,_=m+g,z=m+M,U=x+O,k=x+g,S=x+M,s=o[T]*w+o[I]*B+o[b]*R+o[y]*P+o[_]*L+o[z]*N+o[U]*Y+o[k]*q+o[S]*A,p=o[T+1]*w+o[I+1]*B+o[b+1]*R+o[y+1]*P+o[_+1]*L+o[z+1]*N+o[U+1]*Y+o[k+1]*q+o[S+1]*A,v=o[T+2]*w+o[I+2]*B+o[b+2]*R+o[y+2]*P+o[_+2]*L+o[z+2]*N+o[U+2]*Y+o[k+2]*q+o[S+2]*A,d=e?o[T+3]*w+o[I+3]*B+o[b+3]*R+o[y+3]*P+o[_+3]*L+o[z+3]*N+o[U+3]*Y+o[k+3]*q+o[S+3]*A:o[c+3],u&&(s=p=v=(s+p+v)/3),i&&(s=255-s,p=255-p,v=255-v),n[c]=s,n[c+1]=p,n[c+2]=v,n[c+3]=d}function convolve5x5(o,n,t,r,a,e,i,u){var f,l,c,s,p,v,d,m,h,x,g,O,M,T,I,b,y,_,z,U,k,S,w,B,R,P,L,N,Y,q,A,j,D,C,E,F,G,H,J,K,Q,V,W=a[0][0],X=a[0][1],Z=a[0][2],$=(a[0][3],a[0][4]),oo=a[1][0],no=a[1][1],to=a[1][2],ro=(a[1][3],a[1][4]),ao=a[2][0],eo=a[2][1],io=a[2][2],uo=(a[2][3],a[2][4]),fo=a[3][0],lo=a[3][1],co=a[3][2],so=(a[3][3],a[3][4]),po=a[4][0],vo=a[4][1],mo=a[4][2],ho=(a[4][3],a[4][4]);for(l=0;r>l;l+=1)for(m=l*t*4,h=m-4*t,g=m-4*t*2,x=m+4*t,O=m+4*t*2,1>l&&(h=m),l>=t-1&&(x=m),2>l&&(g=h),l>=t-2&&(O=x),f=0;t>f;f+=1)c=4*(l*t+f),M=4*f,T=M-4,I=M+4,b=M-8,y=M+8,1>f&&(T=M),f>=t-1&&(I=M),2>f&&(b=T),f>=t-2&&(y=I),_=g+b,z=g+T,U=g+M,k=g+I,S=g+y,w=h+b,B=h+T,R=h+M,P=h+I,L=h+y,N=m+b,Y=m+T,q=m+M,A=m+I,j=m+y,D=x+b,C=x+T,E=x+M,F=x+I,G=x+y,H=O+b,J=O+T,K=O+M,Q=O+I,V=O+y,s=o[_]*W+o[z]*X+o[U]*Z+o[k]*$+o[U]*$+o[w]*oo+o[B]*no+o[R]*to+o[P]*ro+o[R]*ro+o[N]*ao+o[Y]*eo+o[q]*io+o[A]*uo+o[q]*uo+o[D]*fo+o[C]*lo+o[E]*co+o[F]*so+o[E]*so+o[H]*po+o[J]*vo+o[K]*mo+o[Q]*ho+o[K]*ho,p=o[_+1]*W+o[z+1]*X+o[U+1]*Z+o[k+1]*$+o[U+1]*$+o[w+1]*oo+o[B+1]*no+o[R+1]*to+o[P+1]*ro+o[R+1]*ro+o[N+1]*ao+o[Y+1]*eo+o[q+1]*io+o[A+1]*uo+o[q+1]*uo+o[D+1]*fo+o[C+1]*lo+o[E+1]*co+o[F+1]*so+o[E+1]*so+o[H+1]*po+o[J+1]*vo+o[K+1]*mo+o[Q+1]*ho+o[K+1]*ho,v=o[_+2]*W+o[z+2]*X+o[U+2]*Z+o[k+2]*$+o[U+2]*$+o[w+2]*oo+o[B+2]*no+o[R+2]*to+o[P+2]*ro+o[R+2]*ro+o[N+2]*ao+o[Y+2]*eo+o[q+2]*io+o[A+2]*uo+o[q+2]*uo+o[D+2]*fo+o[C+2]*lo+o[E+2]*co+o[F+2]*so+o[E+2]*so+o[H+2]*po+o[J+2]*vo+o[K+2]*mo+o[Q+2]*ho+o[K+2]*ho,d=e?o[_+3]*W+o[z+3]*X+o[U+3]*Z+o[k+3]*$+o[U+3]*$+o[w+3]*oo+o[B+3]*no+o[R+3]*to+o[P+3]*ro+o[R+3]*ro+o[N+3]*ao+o[Y+3]*eo+o[q+3]*io+o[A+3]*uo+o[q+3]*uo+o[D+3]*fo+o[C+3]*lo+o[E+3]*co+o[F+3]*so+o[E+3]*so+o[H+3]*po+o[J+3]*vo+o[K+3]*mo+o[Q+3]*ho+o[K+3]*ho:o[c+3],u&&(s=p=v=(s+p+v)/3),i&&(s=255-s,p=255-p,v=255-v),n[c]=s,n[c+1]=p,n[c+2]=v,n[c+3]=d}function gaussian(o,n,t,r,a){var e,i,u,f,l,c,s,p,v,d,m,h,x,g,O,M=[],T=13,I=[[1]];for(a=clamp(a,3,T),x=-a/2+(a%2?.5:0),g=a+x,u=1;T>u;u+=1)I[0][u]=0;for(u=1;T>u;u+=1)for(I[u]=[1],f=1;T>f;f+=1)I[u][f]=I[u-1][f]+I[u-1][f-1];for(O=I[a-1],u=0,h=0;a>u;u+=1)h+=O[u];for(u=0;a>u;u+=1)O[u]/=h;for(i=0;r>i;i+=1)for(e=0;t>e;e+=1){for(l=c=s=p=0,u=x;g>u;u+=1)d=e+u,m=i,h=O[u-x],0>d&&(d=0),d>=t&&(d=t-1),v=4*(m*t+d),l+=o[v]*h,c+=o[v+1]*h,s+=o[v+2]*h,p+=o[v+3]*h;v=4*(i*t+e),M[v]=l,M[v+1]=c,M[v+2]=s,M[v+3]=p}for(i=0;r>i;i+=1)for(e=0;t>e;e+=1){for(l=c=s=p=0,u=x;g>u;u+=1)d=e,m=i+u,h=O[u-x],0>m&&(m=0),m>=r&&(m=r-1),v=4*(m*t+d),l+=M[v]*h,c+=M[v+1]*h,s+=M[v+2]*h,p+=M[v+3]*h;v=4*(i*t+e),n[v]=l,n[v+1]=c,n[v+2]=s,n[v+3]=p}}function getPixel(o,n){return n*=4,[o[n+0],o[n+1],o[n+2],o[n+3]]}function setPixel(o,n,t){n*=4,o[n+0]=t[0],o[n+1]=t[1],o[n+2]=t[2],o[n+3]=t[3]}function polar(o,n,t,r,a,e,i){t=a/2+(t||0),r=e/2+(r||0);var u,f,l,c,s,p,v;for(u=0;e>u;u+=1)for(f=0;a>f;f+=1)l=f-t,c=u-r,s=Math.sqrt(Math.pow(l,2)+Math.pow(c,2)),p=Math.atan2(c,l),v=i(s,p),s=v[0],p=v[1],setPixel(n,f+u*a,getPixel(o,Math.round(t+Math.cos(p)*s)+Math.round(r+Math.sin(p)*s)*a))}var stackblur=require("stackblur"),util=require("./util"),clamp=util.clamp,LUMINOSITY_ITU_R_BT601="ITU-R BT.601",LUMINOSITY_ITU_R_BT709="ITU-R BT.709",process={invert:function(o,n,t,r){var a,e=t*r*4;for(a=0;e>a;a+=4)n[a]=255-o[a],n[a+1]=255-o[a+1],n[a+2]=255-o[a+2],n[a+3]=o[a+3]},sepia:function(o,n,t,r){var a,e,i,u,f=t*r*4;for(a=0;f>a;a+=4)e=o[a],i=o[a+1],u=o[a+2],n[a]=.393*e+.769*i+.189*u,n[a+1]=.349*e+.686*i+.168*u,n[a+2]=.272*e+.534*i+.131*u,n[a+3]=o[a+3]},solarize:function(o,n,t,r){var a,e,i,u,f=t*r*4;for(a=0;f>a;a+=4)e=o[a],i=o[a+1],u=o[a+2],n[a]=e>127?255-e:e,n[a+1]=i>127?255-i:i,n[a+2]=u>127?255-u:u,n[a+3]=o[a+3]},brightness:function(o,n,t,r,a){a=defaultOptions(a,{brightness:1,contrast:0});var e,i,u,f,l,c=t*r*4,s=clamp(a.contrast,-1,1)/2,p=1+clamp(a.brightness,-1,1),v=0>p?-p:p,d=0>p?0:p;for(s=.5*Math.tan((s+1)*Math.PI/4),l=255*-(s-.5),e=0;c>e;e+=4)i=o[e],u=o[e+1],f=o[e+2],i=(i+i*v+d)*s+l,u=(u+u*v+d)*s+l,f=(f+f*v+d)*s+l,n[e]=i,n[e+1]=u,n[e+2]=f,n[e+3]=o[e+3]},desaturate:function(o,n,t,r,a){a=defaultOptions(a,{method:LUMINOSITY_ITU_R_BT601});var e,i,u,f,l,c=t*r*4;for(a.method===LUMINOSITY_ITU_R_BT601?(u=.3,f=.59,l=.11):a.method===LUMINOSITY_ITU_R_BT709&&(u=.2125,f=.7154,l=.0721),e=0;c>e;e+=4)i=o[e]*u+o[e+1]*f+o[e+2]*l,n[e]=i,n[e+1]=i,n[e+2]=i,n[e+3]=o[e+3]},lighten:function(o,n,t,r,a){a=defaultOptions(a,{amount:.25});var e,i=t*r*4,u=1+clamp(a.amount,0,1);for(e=0;i>e;e+=4)n[e]=o[e]*u,n[e+1]=o[e+1]*u,n[e+2]=o[e+2]*u,n[e+3]=o[e+3]},noise:function(o,n,t,r,a){a=defaultOptions(a,{amount:.5,strength:.5,mono:!1});var e,i,u,f,l,c=t*r*4,s=clamp(a.amount,0,1),p=clamp(a.strength,0,1),v=!!a.mono,d=Math.random;for(e=0;c>e;e+=4)u=o[e],f=o[e+1],l=o[e+2],i=d(),s>i&&(v?(i=p*(i/s*2-1)*255,u+=i,f+=i,l+=i):(u+=p*d()*255,f+=p*d()*255,l+=p*d()*255)),n[e]=u,n[e+1]=f,n[e+2]=l,n[e+3]=o[e+3]},flipv:function(o,n,t,r){var a,e,i,u;for(e=0;r>e;e+=1)for(a=0;t>a;a+=1)i=4*(e*t+a),u=4*(e*t+(t-a-1)),n[u]=o[i],n[u+1]=o[i+1],n[u+2]=o[i+2],n[u+3]=o[i+3]},fliph:function(o,n,t,r){var a,e,i,u;for(e=0;r>e;e+=1)for(a=0;t>a;a+=1)i=4*(e*t+a),u=4*((r-e-1)*t+a),n[u]=o[i],n[u+1]=o[i+1],n[u+2]=o[i+2],n[u+3]=o[i+3]},blur:function(o,n,t,r,a){a=defaultOptions(a,{radius:10});for(var e=0;e<o.length;e+=1)n[e]=o[e];stackblur(n,t,r,a.radius)},glow:function(o,n,t,r,a){a=defaultOptions(a,{amount:.75,kernelSize:5});var e,i,u,f,l=t*r*4,c=a.amount,s=[];for(gaussian(o,s,t,r,a.kernelSize),e=0;l>e;e+=4)i=o[e]+s[e]*c,u=o[e+1]+s[e+1]*c,f=o[e+2]+s[e+2]*c,i>255&&(i=255),u>255&&(u=255),f>255&&(f=255),n[e]=i,n[e+1]=u,n[e+2]=f,n[e+3]=o[e+3]},convolve3x3:function(o,n,t,r,a){convolve3x3(o,n,t,r,a.kernel)},convolve5x5:function(o,n,t,r,a){convolve5x5(o,n,t,r,a.kernel)},sharpen3x3:function(o,n,t,r,a){a=defaultOptions(a,{strength:1});var e=-clamp(a.strength,0,1);convolve3x3(o,n,t,r,[[e,e,e],[e,1-8*e,e],[e,e,e]])},sharpen5x5:function(o,n,t,r,a){a=defaultOptions(a,{strength:1});var e=-clamp(a.strength,0,1);convolve5x5(o,n,t,r,[[e,e,e,e,e],[e,e,e,e,e],[e,e,1-24*e,e,e],[e,e,e,e,e],[e,e,e,e,e]])},soften3x3:function(o,n,t,r){var a=1/9;convolve3x3(o,n,t,r,[[a,a,a],[a,a,a],[a,a,a]])},soften5x5:function(o,n,t,r){var a=.04;convolve5x5(o,n,t,r,[[a,a,a,a,a],[a,a,a,a,a],[a,a,a,a,a],[a,a,a,a,a],[a,a,a,a,a]])},crossedges:function(o,n,t,r,a){a=defaultOptions(a,{strength:1});var e=5*clamp(a.strength,0,1);convolve3x3(o,n,t,r,[[0,-e,0],[-e,0,e],[0,e,0]],!1,!0)},emboss:function(o,n,t,r,a){a=defaultOptions(a,{amount:1,angle:0});var e,i=t*r*4,u=a.amount,f=a.angle,l=Math.cos(-f)*u,c=Math.sin(-f)*u,s=-l-c,p=-l,v=c-l,d=-c,m=c,h=-c+l,x=l,g=c+l,O=[];for(convolve3x3(o,O,t,r,[[s,d,h],[p,0,x],[v,m,g]]),e=0;i>e;e+=4)n[e]=128+O[e],n[e+1]=128+O[e+1],n[e+2]=128+O[e+2],n[e+3]=o[e+3]},findedges:function(o,n,t,r){var a,e,i,u,f,l,c,s=t*r*4,p=[],v=[];for(convolve3x3(o,p,t,r,[[-1,0,1],[-2,0,2],[-1,0,1]]),convolve3x3(o,v,t,r,[[-1,-2,-1],[0,0,0],[1,2,1]]),a=0;s>a;a+=4)e=p[a],i=v[a],u=p[a+1],f=v[a+1],l=p[a+2],c=v[a+2],0>e&&(e=-e),0>i&&(i=-i),0>u&&(u=-u),0>f&&(f=-f),0>l&&(l=-l),0>c&&(c=-c),n[a]=255-.8*(e+i),n[a+1]=255-.8*(u+f),n[a+2]=255-.8*(l+c),n[a+3]=o[a+3]},edgeenhance3x3:function(o,n,t,r){var a=-1/9;convolve3x3(o,n,t,r,[[a,a,a],[a,17/9,a],[a,a,a]])},edgeenhance5x5:function(o,n,t,r){var a=-0.04;convolve5x5(o,n,t,r,[[a,a,a,a,a],[a,a,a,a,a],[a,a,1.96,a,a],[a,a,a,a,a],[a,a,a,a,a]])},laplace3x3:function(o,n,t,r){convolve3x3(o,n,t,r,[[-1,-1,-1],[-1,8,-1],[-1,-1,-1]],!1,!0,!0)},laplace5x5:function(o,n,t,r){convolve5x5(o,n,t,r,[[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1],[-1,-1,24,-1,-1],[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1]],!1,!0,!0)},rgbAdjust:function(o,n,t,r,a){a=defaultOptions(a,{r:0,g:0,b:0,a:0});var e,i,u,f,l,c=t*r*4,s=255*clamp(a.r,-1,1),p=255*clamp(a.g,-1,1),v=255*clamp(a.b,-1,1),d=255*clamp(a.a,-1,1);for(e=0;c>e;e+=4)i=o[e]+s,u=o[e+1]+p,f=o[e+2]+v,l=o[e+3]+d,0>i&&(i=0),0>u&&(u=0),0>f&&(f=0),0>l&&(l=0),i>255&&(i=255),u>255&&(u=255),f>255&&(f=255),l>255&&(l=255),n[e]=i,n[e+1]=u,n[e+2]=f,n[e+3]=l},colorfilter:function(o,n,t,r,a){a=defaultOptions(a,{luminosity:!1,r:1,g:.5,b:0});var e,i,u,f,l,c,s,p,v,d,m,h=t*r*4,x=!!a.luminosity,g=clamp(a.r,0,1),O=clamp(a.g,0,1),M=clamp(a.b,0,1);for(e=0;h>e;e+=4)i=o[e]/255,u=o[e+1]/255,f=o[e+2]/255,p=.3*i+.59*u+.11*f,i=(i+i*g)/2,u=(u+u*O)/2,f=(f+f*M)/2,x&&(l=c=i,u>c&&(c=u),f>c&&(c=f),l>u&&(l=u),l>f&&(l=f),d=c-l,s=i===c?(u-f)/d%6:u===c?(f-i)/d+2:(i-u)/d+4,v=s>>0,m=d*(s-v),i=u=f=p-(.3*i+.59*u+.11*f),0===v?(i+=d,u+=m):1===v?(i+=d-m,u+=d):2===v?(u+=d,f+=m):3===v?(u+=d-m,f+=d):4===v?(i+=m,f+=d):5===v&&(i+=d,f+=d-m)),n[e]=255*i,n[e+1]=255*u,n[e+2]=255*f,n[e+3]=o[e+3]},hslAdjust:function(o,n,t,r,a){a=defaultOptions(a,{h:.5,s:.3,l:.1,a:0});var e,i,u,f,l,c,s,p,v,d,m,h,x,g,O,M=t*r*4,T=clamp(a.h,-1,1),I=clamp(a.s,-1,1),b=clamp(a.l,-1,1),y=255*clamp(a.a,-1,1),_=1+I*(0>I?1:2),z=0>b?1+b:1-b,U=0>b?0:255*b;for(T=6*T%6,e=0;M>e;e+=4)i=o[e],u=o[e+1],f=o[e+2],l=o[e+3]+y,(0!==T||0!==I)&&(c=i,u>c&&(c=u),f>c&&(c=f),s=i,s>u&&(s=u),s>f&&(s=f),p=c-s,m=(s+c)/510,m>0&&p>0&&(.5>=m?(d=p/(c+s)*_,d>1&&(d=1),h=m*(1+d)):(d=p/(510-c-s)*_,d>1&&(d=1),h=m+d-m*d),v=i===c?u===s?5+(c-f)/p+T:1-(c-u)/p+T:u===c?f===s?1+(c-i)/p+T:3-(c-f)/p+T:i===s?3+(c-u)/p+T:5-(c-i)/p+T,0>v&&(v+=6),v>=6&&(v-=6),x=m+m-h,O=v>>0,g=(h-x)*(v-O),0===O?(i=h,u=x+g,f=x):1===O?(i=h-g,u=h,f=x):2===O?(i=x,u=h,f=x+g):3===O?(i=x,u=h-g,f=h):4===O?(i=x+g,u=x,f=h):5===O&&(i=h,u=x,f=h-g),i*=255,u*=255,f*=255)),i=i*z+U,u=u*z+U,f=f*z+U,0>i&&(i=0),0>u&&(u=0),0>f&&(f=0),0>l&&(l=0),i>255&&(i=255),u>255&&(u=255),f>255&&(f=255),l>255&&(l=255),n[e]=i,n[e+1]=u,n[e+2]=f,n[e+3]=l},posterize:function(o,n,t,r,a){a=defaultOptions(a,{levels:5});var e,i=t*r*4,u=clamp(a.levels,2,256),f=256/u,l=256/(u-1);for(e=0;i>e;e+=4)n[e]=l*(o[e]/f>>0),n[e+1]=l*(o[e+1]/f>>0),n[e+2]=l*(o[e+2]/f>>0),n[e+3]=o[e+3]},removenoise:function(o,n,t,r){var a,e,i,u,f,l,c,s,p,v,d,m,h,x,g,O,M,T,I;for(e=0;r>e;e+=1)for(s=e*t*4,p=s-4*t,v=s+4*t,1>e&&(p=s),e>=t-1&&(v=s),a=0;t>a;a+=1)c=4*(e*t+a),d=4*a,m=d-4,h=d+4,1>a&&(m=d),a>=t-1&&(h=d),x=M=o[s+m],l=o[s+h],x>l&&(x=l),l>M&&(M=l),l=o[p+d],x>l&&(x=l),l>M&&(M=l),l=o[v+d],x>l&&(x=l),l>M&&(M=l),g=o[s+m+1],l=o[s+h+1],g>l&&(g=l),l=o[p+d+1],g>l&&(g=l),l=o[v+d+1],g>l&&(g=l),O=o[s+m+2],l=o[s+h+2],O>l&&(O=l),l=o[p+d+2],O>l&&(O=l),l=o[v+d+2],O>l&&(O=l),i=o[c],u=o[c+1],f=o[c+2],x>i&&(i=x),i>M&&(i=M),g>u&&(u=g),u>T&&(u=T),O>f&&(f=O),f>I&&(f=I),n[c]=i,n[c+1]=u,n[c+2]=f,n[c+3]=o[c+3]},mosaic:function(o,n,t,r,a){a=defaultOptions(a,{blockSize:8});var e,i,u,f,l,c,s,p,v,d,m,h,x,g,O=clamp(a.blockSize,1,Math.max(t,r)),M=Math.ceil(r/O),T=Math.ceil(t/O);for(e=0,v=0,s=0;M>s;s+=1){for(i=clamp(e+O,0,r),u=0,p=0;T>p;p+=1){for(f=clamp(u+O,0,t),l=e*t+u<<2,d=o[l],m=o[l+1],h=o[l+2],x=e;i>x;x+=1)for(g=u;f>g;g+=1)c=x*t+g<<2,n[c]=d,n[c+1]=m,n[c+2]=h,n[c+3]=o[c+3];u=f,v+=1}e=i}},equalize:function(o,n,t,r,a){var e,i,u,f,l=t*r,c=Math.round,s=new Array(256);for(i=0;256>i;i+=1)s[i]=0;for(i=0;l>i;i+=1)e=4*i,u=clamp(c(.3*o[e]+.59*o[e+1]+.11*o[e+2]),0,255),n[e+3]=u,s[u]+=1;var p=new Array(256);for(p[0]=s[0],i=1;256>i;i+=1)p[i]=p[i-1]+s[i];for(i=0;256>i;i+=1)p[i]=p[i]/l*255;for(i=0;l>i;i+=1)e=4*i,u=n[e+3],f=p[u]/(u||1),n[e]=clamp(c(o[e]*f),0,255),n[e+1]=clamp(c(o[e+1]*f),0,255),n[e+2]=clamp(c(o[e+2]*f),0,255),n[e+3]=o[e+3]},mask:function(o,n,t,r,a){var e,i=t*r*4,u=a.data;for(e=0;i>e;e+=4)n[e]=o[e],n[e+1]=o[e+1],n[e+2]=o[e+2],n[e+3]=o[e+3]*u[e]/255*u[e+3]/255},bump:function(o,n,t,r,a){a=defaultOptions(a,{dx:0,dy:0,radius:0,zoom:0});var e=a.radius,i=clamp(a.zoom,0,1);return polar(o,n,a.dx,a.dy,t,r,function(o,n){return[o*smoothstep(0,i,o/e),n]})},dent:function(o,n,t,r,a){a=defaultOptions(a,{dx:0,dy:0,radius:0,zoom:0});var e=a.radius,i=clamp(a.zoom,0,1);return polar(o,n,a.dx,a.dy,t,r,function(o,n){return[2*o-o*smoothstep(0,i,o/e),n]})},pinch:function(o,n,t,r,a){a=defaultOptions(a,{dx:0,dy:0,zoom:0});var e=util.distance(0,0,t,r),i=clamp(.75*a.zoom,-.75,.75);return polar(o,n,a.dx,a.dy,t,r,function(o,n){return[o*Math.pow(e/o,i)*(1-i),n]})},splash:function(o,n,t,r,a){a=defaultOptions(a,{dx:0,dy:0,radius:0});var e=a.radius;return polar(o,n,a.dx,a.dy,t,r,function(o,n){return[o>e?e:o,n]})},twirl:function(o,n,t,r,a){a=defaultOptions(a,{dx:0,dy:0,radius:0,angle:0});var e=util.radians(a.angle),i=a.radius;return polar(o,n,a.dx,a.dy,t,r,function(o,n){return[o,n+(1-smoothstep(-i,i,o))*e]})}};module.exports=process;


},{"./util":20,"stackblur":5}],20:[function(require,module,exports){
"use strict";function degrees(n){return 180*n/Math.PI}function radians(n){return n/180*Math.PI}function distance(n,t,r,a){return Math.sqrt(Math.pow(r-n,2)+Math.pow(a-t,2))}function clamp(n,t,r){return Math.min(r,Math.max(t,n))}function transform(n){function t(n,t){t=t.slice();var r=t[0],a=t[1],e=(t[2],t[3]),i=t[4],o=(t[5],t[6]),u=t[7];t[8];return t[0]=n[0]*r+n[1]*e,t[1]=n[0]*a+n[1]*i,t[3]=n[3]*r+n[4]*e,t[4]=n[3]*a+n[4]*i,t[6]=n[6]*r+n[7]*e+o,t[7]=n[6]*a+n[7]*i+u,transform(t)}return n=void 0===n?[1,0,0,0,1,0,0,0,1]:n.slice(),{matrix:function(){return n.slice()},clone:function(){return transform(n)},prepend:function(r){return r.matrix&&(r=r.matrix()),t(n,r)},append:function(r){return r.matrix&&(r=r.matrix()),t(r,n)},translate:function(r,a){return t([1,0,0,0,1,0,r,a,1],n)},scale:function(r,a){return void 0===a&&(a=r),t([r,0,0,0,a,0,0,0,1],n)},skew:function(r,a){void 0===a&&(a=r);var e=Math.PI*r/180,i=Math.PI*a/180;return t([1,Math.tan(i),0,-Math.tan(e),1,0,0,0,1],n)},rotate:function(r){var a=Math.cos(radians(r)),e=Math.sin(radians(r));return t([a,e,0,-e,a,0,0,0,1],n)},transformPoint:function(t){var r=t.x,a=t.y;return{x:r*n[0]+a*n[3]+n[6],y:r*n[1]+a*n[4]+n[7]}}}}module.exports={degrees:degrees,radians:radians,distance:distance,clamp:clamp,transform:transform};


},{}],21:[function(require,module,exports){
"use strict";var deepEqual=require("./deepequal"),util=require("./util"),g={};g.combine=function(){var n,r,t=[];for(n=0;n<arguments.length;n++)r=arguments[n],r&&(t=t.concat(r));return t},g.contains=function(n,r){for(var t=0;t<n.length;t+=1)if(deepEqual.deepEqual(n[t],r))return!0;return!1},g.equals=function(n,r){return deepEqual.deepEqual(n,r)},g.count=function(n){return n&&n.length?n.length:0},g.cull=function(n,r){if(!n)return[];if(!r)return n;var t,e,u=[];for(t=0;t<n.length;t++)e=r[t%r.length],e&&u.push(n[t]);return u},g.distinct=function(n){if(!n)return[];var r,t,e,u=[],i=[];for(r=0,t=n.length;t>r;r+=1)e=n[r],g.contains(i,e)||(i.push(e),u.push(n[r]));return u},g.first=function(n){return n&&0!==n.length?n[0]:null},g.get=function(n,r){return n&&0!==n.length?n[r]:null},g.interleave=function(){if(0===arguments.length)return[];for(var n=[],r=0;;){for(var t=0;t<arguments.length;t++){var e=arguments[t];if(!(e.length>r))return n;n.push(e[r])}r+=1}},g.last=function(n){return n&&0!==n.length?n[n.length-1]:null},g.pick=function(n,r,t){if(!n||0===n.length||0>=r)return[];t||0===t||(t=Math.random());for(var e=util.randomGenerator(t||0),u=[],i=0;r>i;i+=1)u.push(n[Math.floor(e(0,n.length))]);return u},g.randomSample=function(n,r,t){if(!n||0===n.length||0>=r)return[];t||0===t||(t=Math.random());var e=g.shuffle(n,t);return r?g.slice(e,0,r):e},g.repeat=function(n,r,t){if(!n)return[];if(0>=r)return[];var e,u,i,l=[];if(t)for(e=0;e<n.length;e+=1)for(i=n[e],u=0;r>u;u+=1)l.push(i);else for(e=0;r>e;e+=1)l.push.apply(l,n);return l},g.rest=function(n){return n?n.slice(1):[]},g.reverse=function(n){return n.slice().reverse()},g.second=function(n){return!n||n.length<2?null:n[1]},g.shift=function(n,r){if(!n)return[];r%=n.length;var t=n.slice(0,r),e=n.slice(r);return e.push.apply(e,t),e},g.shuffle=function(n,r){var t,e,u,i;for(r||0===r||(r=Math.random()),i=util.randomGenerator(r||0),t=n.length-1;t>0;t--)e=Math.floor(i(0,t+1)),u=n[t],n[t]=n[e],n[e]=u;return n},g.slice=function(n,r,t,e){if(!n)return[];var u,i;return e?(u=n.slice(0,r),i=n.slice(r+t),u.push.apply(u,i),u):n.slice(r,r+t)},g.sort=function(n,r){if(r){if("string"==typeof r)return n.slice().sort(function(n,t){return n[r]>t[r]?1:n[r]===t[r]?0:-1});if("function"==typeof r)return n.slice().sort(r)}return n&&void 0!==n[0]&&null!==n[0]&&"number"==typeof n[0]?n.slice().sort(function(n,r){return n-r}):n.slice().sort()},g["switch"]=function(n){var r=arguments.length-1;return n%=r,0>n&&(n+=r),arguments[n+1]},g.takeEvery=function(n,r,t){var e,u=[];for(t=t||0,e=0;e<n.length;e+=1)e%r===t&&u.push(n[e]);return u},g.zipMap=function(n,r){var t,e,u,i={},l=Math.min(n.length,r.length);for(t=0;l>t;t+=1)e=n[t],u=r[t],i[e]=u;return i},module.exports=g;


},{"./deepequal":11,"./util":24}],22:[function(require,module,exports){
"use strict";var _=require("lodash"),util=require("./util"),vg=require("./vg/vg"),g={},TWO_PI=2*Math.PI;g.abs=Math.abs,g.accumulate=function(r){if(arguments.length>1?r=arguments:1!==arguments.length||Array.isArray(r)||(r=[r]),!r||0===r.length)return[0];var n,t=[],e=0;for(n=0;n<r.length;n++)t.push(e),e+=r[n];return t},g.add=function(r,n){return 2===arguments.length?r+n:_.reduce(arguments,function(r,n){return r+n},0)},g.and=function(r,n){var t=arguments.length;if(2===t)return r&&n;if(1===t)return!!r;if(0===t)throw new Error("Wrong number of arguments");return _.reduce(arguments,function(r,n){return r&&n},!0)},g.average=function(r){if(arguments.length>1?r=arguments:1!==arguments.length||Array.isArray(r)||(r=[r]),!r||0===r.length)return 0;var n,t=0;for(n=0;n<r.length;n+=1)t+=r[n];return t/r.length},g["boolean"]=function(r){return!!r},g.ceil=Math.ceil,g.compare=function(r,n,t){if("<"===t)return n>r;if(">"===t)return r>n;if("<="===t)return n>=r;if(">="===t)return r>=n;if("=="===t)return r===n;if("!="===t)return r!==n;throw new Error("Unknown comparison operation "+t)},g.cos=Math.cos,g.degrees=function(r){return 180*r/Math.PI},g.divide=function(r,n){function t(r){if(0===r)throw new Error("Divide by zero")}var e=arguments.length;if(2===e)return t(n),r/n;if(1===e)return t(r),1/r;if(0===e)throw new Error("Wrong number of arguments");return _.reduce([].slice.call(arguments,1),function(r,n){return t(n),r/n},arguments[0])},g.e=function(){return Math.E},g.even=function(r){return r%2===0},g.floor=Math.floor,g.integer=function(r){return 0|r},g.log=function(r){return r>0?Math.log(r):-Math.log(-r)},g.makeNumbers=function(r,n){if(!r)return[];n||(n="");var t,e,u=[],o=r.split(n);for(t=0;t<o.length;t+=1)e=parseFloat(o[t]),(0===e||e)&&u.push(e);return u},g.max=function(){var r=arguments;if(1===arguments.length&&Array.isArray(arguments[0])&&(r=arguments[0]),0===r.length)throw new Error("Wrong number of arguments");return Math.max.apply(null,r)},g.min=function(){var r=arguments;if(1===arguments.length&&Array.isArray(arguments[0])&&(r=arguments[0]),0===r.length)throw new Error("Wrong number of arguments");return Math.min.apply(null,r)},g.mod=function(r,n){return r%n},g.multiply=function(r,n){var t=arguments.length;return 2===t?r*n:1===t?r:_.reduce(arguments,function(r,n){return r*n},1)},g.negate=function(r){return-r},g.not=function(r){return!r},g.number=function(r){return r},g.odd=function(r){return r%2!==0},g.or=function(r,n){var t=arguments.length;if(2===t)return r||n;if(1===t)return!!r;if(0===t)throw new Error("Wrong number of arguments");return _.reduce(arguments,function(r,n){return r||n},!1)},g.perlinNoise=function(r,n,t){return vg.math.noise(r,n,t)},g.pi=function(){return Math.PI},g.pow=Math.pow,g.radians=function(r){return r*Math.PI/180},g.randomNumbers=function(r,n,t,e){var u=arguments.length;if((4>u||!e&&0!==e)&&(e=Math.random()),3===u||4===u?(n=n||0,t=t||(0===t?0:1)):2===u?(t=n||(0===n?0:1),n=0):1===u&&(n=0,t=1),n>t){var o=t;t=n,n=o}for(var a,g=t-n,i=[],f=util.randomGenerator(e||0),s=0;r>s;s+=1)a=n+f(0,1)*g,i.push(a);return i},g.range=function(r,n,t,e){if(r===n)return[];if(0!==t&&(t=t||(n>r?1:-1)),t>0&&r>n)return[];if(0>t&&n>r)return[];if(0===t)return[];var u,o=[];if(n>r)if(e)for(u=r;n>=u;u+=t)o.push(u);else for(u=r;n>u;u+=t)o.push(u);else if(e)for(u=r;u>=n;u+=t)o.push(u);else for(u=r;u>n;u+=t)o.push(u);return o},g.round=function(r,n){return n=0|n,n?Math.round(r/n)*n:Math.round(r)},g.sample=function(r,n,t,e){var u,o,a=[];for(a.length=r,u=e?(t-n)/r:(t-n)/(r-1),o=0;r>o;o+=1)a[o]=n+o*u;return a},g.sineWave=function(r,n,t,e,u){void 0===n&&(n=-1),void 0===t&&(t=1),void 0===e&&(e=1),void 0===u&&(u=0);var o=(t-n)/2;return n+o+Math.sin((u+r)*TWO_PI/e)*o},g.squareWave=function(r,n,t,e,u){void 0===n&&(n=-1),void 0===t&&(t=1),void 0===e&&(e=1),void 0===u&&(u=0);var o=e/2,a=(r+u)%e;return o>a?t:n},g.triangleWave=function(r,n,t,e,u){void 0===n&&(n=-1),void 0===t&&(t=1),void 0===e&&(e=1),void 0===u&&(u=0);var o=(t-n)/2,a=TWO_PI/e,g=0,i=r+u+e/4;return i%e!==0&&(g=i*a%TWO_PI),0>g&&(g+=TWO_PI),2*o*(1+-Math.abs(g/TWO_PI*2-1))+n},g.sawtoothWave=function(r,n,t,e,u){void 0===n&&(n=-1),void 0===t&&(t=1),void 0===e&&(e=1),void 0===u&&(u=0);var o=(t-n)/2,a=TWO_PI/e,g=0,i=r+u;return i%e!==0&&(g=i*a%TWO_PI),0>g&&(g+=TWO_PI),2*(g/TWO_PI)*o+n},g.sign=function(r){return r>0?1:0===r?0:-1},g.sin=Math.sin,g.sqrt=Math.sqrt,g.subtract=function(r,n){var t=arguments.length;if(2===t)return r-n;if(1===t)return-r;if(0===t)throw new Error("Wrong number of arguments");return _.reduce([].slice.call(arguments,1),function(r,n){return r-n},arguments[0])},g.tan=Math.tan,g.total=function(r){if(arguments.length>1?r=arguments:1!==arguments.length||Array.isArray(r)?0===arguments.length&&(r=[]):r=[r],0===r.length)return 0;var n,t=0;for(n=0;n<r.length;n+=1)t+=r[n];return t},g.xor=function(r,n){var t=arguments.length;if(2===t)return!!(r^n);throw new Error("Wrong number of arguments")},module.exports=g;


},{"./util":24,"./vg/vg":45,"lodash":4}],23:[function(require,module,exports){
"use strict";var g={};g.characterAt=function(t,n){return t&&0!==t.length?(t=String(t),n%=t.length,t.charAt(n)):null},g.concatenate=function(){for(var t="",n=0;n<arguments.length;n++){var r=arguments[n];r=void 0!==r?String(r):"",t+=r}return t},g.endsWith=function(t,n){return t&&n?(t=String(t),-1!==t.indexOf(n,t.length-n.length)):!1},g.reverse=function(t){return t.slice().reverse()},g.startsWith=function(t,n){return t&&n?(t=String(t),0===t.indexOf(n)):!1},g.string=String,g.stringContains=function(t,n){return t&&n?(t=String(t),-1!==t.indexOf(n)):!1},g.stringEquals=function(t,n,r){return t=String(t),n=String(n),t&&n?r?t.toLowerCase()===n.toLowerCase():t===n:!1},g.stringLength=function(t){return t?(t=String(t),t.length):0},g.stringReplace=function(t,n,r){return t=String(t),t.replace(new RegExp(n,"g"),r)},g.stringSplit=function(t,n){return t?(n&&0!==n.length||(n=""),t=String(t),t.split(n)):[]},g.stringTrim=function(t){return t?(t=String(t),t.trim()):null},g.substring=function(t,n,r,e){return t?(t=String(t),n%=t.length,void 0!==r&&(e?r=r%t.length+1:r%=t.length+1),t.substring(n,r)):null},g.toCharacterCodes=function(t){if(!t)return[];var n=[];n.length=t.length;for(var r=0;r<t.length;r+=1)n[r]=t.charCodeAt(r);return n},g.toCharacters=function(t){return t?(t=String(t),t.split("")):[]},g.toLowerCase=function(t){return t=String(t),t.toLowerCase()},g.toTitleCase=function(t){var n,r="";t=String(t);for(var e=0;e<t.length;e+=1)n=t[e],r+=0===r.length||" "===r[r.length-1]?n.toUpperCase():n;return r},g.toUpperCase=function(t){return t=String(t),t.toUpperCase()},g.wordCount=function(t){if(!t)return 0;t=String(t);var n=t.split(new RegExp("\\w+"));return n.length-1},g.toWords=function(t){var n=t.split(/\W+/);return""===n[n.length-1]&&n.pop(),n},module.exports=g;


},{}],24:[function(require,module,exports){
"use strict";var randomGenerator=function(r){if(0>r){for(var n=randomGenerator(Math.abs(r)),e=0;23>e;e+=1)n();return randomGenerator(n(0,1e4))}return function(n,e){n=n||0,e=e||1,r=(9301*r+49297)%233280;var a=r/233280;return n+a*(e-n)}};exports.randomGenerator=randomGenerator;


},{}],25:[function(require,module,exports){
"use strict";var Color=require("../objects/color"),vg={};vg.isDrawable=function(o){return Array.isArray(o)&&(o=o[0]),o?"function"==typeof o.draw?!0:void 0!==o.x&&void 0!==o.y?!0:void 0!==o.r&&void 0!==o.g&&void 0!==o.b?!0:!1:!1},vg.drawPoints=function(o,r){var t,i;for(o.fillStyle="blue",o.beginPath(),i=0;i<r.length;i+=1)t=r[i],o.moveTo(t.x,t.y),o.arc(t.x,t.y,2,0,2*Math.PI,!1);o.fill()},vg.drawColoredPoints=function(o,r){for(var t=0,i=r.length;i>t;t+=1){var e=r[t];o.fillStyle=Color.toCSS(e),o.fillRect(e.x-2,e.y-2,4,4)}},vg.drawRectangles=function(o,r){var t,i;for(o.save(),t=0;t<r.length;t+=1)i=r[t],o.strokeStyle="black",o.strokeWidth=1,o.rect(i.x,i.y,i.width,i.height),o.stroke();o.restore()},vg.drawColors=function(o,r){var t,i;for(o.save(),t=0;t<r.length;t+=1)i=r[t],o.fillStyle=Color.toCSS(i),o.fillRect(0,0,30,30),o.translate(30,0);o.restore()},vg.draw=function(o,r){var t=r,i=!1;if(Array.isArray(r)&&(t=r[0],i=!0),t)if("function"==typeof t.draw)if(i)for(var e=0,v=r.length;v>e;e+=1)vg.draw(o,r[e]);else r.draw(o);else void 0!==t.x&&void 0!==t.y?void 0!==t.r&&void 0!==t.g&&void 0!==t.b?vg.drawColoredPoints(o,i?r:[r]):void 0!==t.width&&void 0!==t.height?vg.drawRectangles(o,i?r:[r]):vg.drawPoints(o,i?r:[r]):void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&vg.drawColors(o,i?r:[r])},vg.toSVG=function(o,r){r=r||{};var t=r.header===!0,i=void 0!==r.x?r.x:0,e=void 0!==r.y?r.y:0,v=void 0!==r.width?r.width:500,n=void 0!==r.height?r.height:500,l="";if(o)if("function"==typeof o.toSVG)l=o.toSVG();else if(Array.isArray(o)){l="<g>\n";for(var d=0,a=o.length;a>d;d+=1)l+=vg.toSVG(o[d])+"\n";l+="</g>\n"}return t&&(l='<?xml version="1.0" encoding="utf-8"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="'+i+'" y="'+e+'" width="'+v+'px" height="'+n+'px" viewBox="'+i+" "+e+" "+v+" "+n+'">\n'+l+"</svg>\n"),l},module.exports=vg;


},{"../objects/color":28}],26:[function(require,module,exports){
"use strict";function _cloneCommand(e){var n={type:e.type};return n.type!==bezier.CLOSE&&(n.x=e.x,n.y=e.y),n.type===bezier.QUADTO?(n.x1=e.x1,n.y1=e.y1):n.type===bezier.CURVETO&&(n.x1=e.x1,n.y1=e.y1,n.x2=e.x2,n.y2=e.y2),n}var _=require("lodash"),ClipperLib=require("js-clipper"),bezier=require("../util/bezier"),geo=require("../util/geo"),math=require("../util/math"),random=require("../util/random"),Color=require("../objects/color"),Group=require("../objects/group"),Path=require("../objects/path"),Point=require("../objects/point"),Rect=require("../objects/rect"),Transform=require("../objects/transform"),Transformable=require("../objects/transformable"),vg={};vg.HORIZONTAL="horizontal",vg.VERTICAL="vertical",vg.EAST="e",vg.WEST="w",vg.NORTH="n",vg.SOUTH="s",vg.bounds=function(e){var n,r,t;if(e){if("function"==typeof e.bounds)return e.bounds();if(void 0!==e.x&&void 0!==e.y)return void 0!==e.width&&void 0!==e.height?new Rect(e.x,e.y,e.width,e.height):new Rect(e.x,e.y,0,0);if(void 0!==e.r&&void 0!==e.g&&void 0!==e.b)return new vg.Rect(0,0,30,30);if(Array.isArray(e)){if(n=null,t=e.length,t>0&&void 0!==e[0].r&&void 0!==e[0].g&&void 0!==e[0].b)return new Rect(0,0,30*e.length,30);for(r=0;t>r;r+=1)n=n?n.unite(vg.bounds(e[r])):vg.bounds(e[r]);return n||new Rect}return new Rect}return new Rect},vg.makeCenteredRect=function(e,n,r,t){var o=e-r/2,i=n-t/2;return new Rect(o,i,r,t)},vg.makePoint=function(e,n){return new Point(e,n)},vg.makeRect=function(e,n,r,t){return new Rect(e,n,r,t)},vg.merge=function(){return new Group(_.reject(_.flatten(arguments,!0),_.isEmpty))},vg.combinePaths=function(e){return Path.combine(e)},vg.shapePoints=vg.toPoints=function(e){if(!e)return[];if(e.commands)return _.map(_.filter(e.commands,function(e){return void 0!==e.x?!0:!1}),function(e){return new Point(e.x,e.y)});var n,r=[];for(n=0;n<e.shapes.length;n+=1)r=r.concat(vg.shapePoints(e.shapes[n]));return r},vg.colorize=function(e,n,r,t){return e?e.colorize(n,r,t):void 0},vg.translate=function(e,n){return e.translate?e.translate(n):Transformable.translate.apply(e,[n])},vg.scale=function(e,n,r){return e.scale?e.scale(n,r):Transformable.scale.apply(e,[n,r])},vg.rotate=function(e,n,r){return e.rotate?e.rotate(n,r):Transformable.rotate.apply(e,[n,r])},vg.skew=function(e,n,r){return e.skew?e.skew(n,r):Transformable.skew.apply(e,[n,r])},vg.copy=function(e,n,r,t,o,i){var a,s,u,h,c=[],p=0,f=0,l=0,v=1,y=1;for(a=0;n>a;a+=1){for(s=new Transform,u=0;u<r.length;u+=1)h=r[u],"t"===h?s=s.translate(p,f):"r"===h?s=s.rotate(l):"s"===h&&(s=s.scale(v,y));Array.isArray(e)&&e.length>0&&void 0!==e[0].x&&void 0!==e[0].y?c=c.concat(s.transformShape(e)):c.push(s.transformShape(e)),p+=t.x,f+=t.y,l+=o,v+=i.x,y+=i.y}return c},vg.fit=function(e,n,r,t,o){if(e){o=void 0!==o?o:!1;var i,a,s,u=vg.bounds(e),h=u.x,c=u.y,p=u.width,f=u.height;return p=p>1e-12?p:0,f=f>1e-12?f:0,i=new Transform,i=i.translate(n.x,n.y),o?(a=p>0?r/p:1,s=f>0?t/f:1):(a=p>0?r/p:Number.MAX_VALUE,s=f>0?t/f:Number.MAX_VALUE,a=s=Math.min(a,s)),i=i.scale(a,s),i=i.translate(-p/2-h,-f/2-c),i.transformShape(e)}},vg.fitTo=function(e,n,r){if(e&&n){var t=vg.bounds(n),o=t.x,i=t.y,a=t.width,s=t.height;return vg.fit(e,{x:o+a/2,y:i+s/2},a,s,r)}},vg.mirror=function(e,n,r,t){if(e){r=r||new Point,0!==n&&(n=n||90);var o=function(e,t){var o=geo.distance(e,t,r.x,r.y),i=geo.angle(e,t,r.x,r.y),a=geo.coordinates(r.x,r.y,180+n,o*Math.cos(math.radians(i-n)));return o=geo.distance(e,t,a.x,a.y),i=geo.angle(e,t,a.x,a.y),a=geo.coordinates(e,t,i,2*o),new Point(a.x,a.y)},i=function(e){for(var n,r,t,i=new Path([],e.fill,e.stroke,e.strokeWidth),a=0;a<e.commands.length;a+=1){var s=e.commands[a];if(s.type===bezier.MOVETO)n=o(s.x,s.y),i.moveTo(n.x,n.y);else if(s.type===bezier.LINETO)n=o(s.x,s.y),i.lineTo(n.x,n.y);else if(s.type===bezier.CURVETO)n=o(s.x,s.y),r=o(s.x1,s.y1),t=o(s.x2,s.y2),i.curveTo(r.x,r.y,t.x,t.y,n.x,n.y);else{if(s.type!==bezier.CLOSE)throw new Error("Unknown command "+s);i.close()}}return i},a=function(e){return _.map(e,function(e){return o(e.x,e.y)})},s=function(e){var n=_.map(e.shapes,function(e){return u(e)});return new Group(n)},u=function(e){if(Array.isArray(e)&&e.length>0&&void 0!==e[0].x&&void 0!==e[0].y)return a(e);var n=e.shapes?s:i;return n(e)},h=u(e);return t?Array.isArray(e)&&e.length>0&&void 0!==e[0].x&&void 0!==e[0].y?e.concat(h):new Group([e,h]):h}},vg.pathLength=function(e,n){var r=20;return n&&n.precision&&(r=n.precision),e.length(r)},vg.resampleByLength=function(e,n){return e?e.resampleByLength(n):void 0},vg.resampleByAmount=function(e,n,r){return e?e.resampleByAmount(n,r):void 0},vg.wigglePoints=function(e,n,r){r=void 0!==r?r:Math.random();var t=random.generator(r);void 0===n?n={x:10,y:10}:"number"==typeof n&&(n={x:n,y:n});var o=function(e){var r,i,a;if(e.commands){var s=new Path([],e.fill,e.stroke,e.strokeWidth);for(r=0;r<e.commands.length;r+=1){i=(t(0,1)-.5)*n.x*2,a=(t(0,1)-.5)*n.y*2;var u=e.commands[r];u.type===bezier.MOVETO?s.moveTo(u.x+i,u.y+a):u.type===bezier.LINETO?s.lineTo(u.x+i,u.y+a):u.type===bezier.CURVETO?s.curveTo(u.x1,u.y1,u.x2,u.y2,u.x+i,u.y+a):u.type===bezier.CLOSE&&s.close()}return s}if(e.shapes)return new Group(_.map(e.shapes,o));if(Array.isArray(e)&&e.length>0&&void 0!==e[0].x&&void 0!==e[0].y){var h=[];for(r=0;r<e.length;r+=1)i=(t(0,1)-.5)*n.x*2,a=(t(0,1)-.5)*n.y*2,h.push(new Point(e[r].x+i,e[r].y+a));return h}return _.map(e,o)};return o(e)},vg.wiggleContours=function(e,n,r){r=void 0!==r?r:Math.random();var t=random.generator(r);void 0===n?n={x:10,y:10}:"number"==typeof n&&(n={x:n,y:n});var o=function(e){if(e.commands){var r,i,a,s,u=e.contours(),h=[];for(r=0;r<u.length;r+=1)i=(t(0,1)-.5)*n.x*2,a=(t(0,1)-.5)*n.y*2,s=(new Transform).translate(i,a),h=h.concat(s.transformShape(new Path(u[r])).commands);return new Path(h,e.fill,e.stroke,e.strokeWidth)}return e.shapes?new Group(_.map(e.shapes,o)):_.map(e,o)};return o(e)},vg.wigglePaths=function(e,n,r){r=void 0!==r?r:Math.random();var t=random.generator(r);void 0===n?n={x:10,y:10}:"number"==typeof n&&(n={x:n,y:n});var o=function(e){if(e.commands)return e;if(e.shapes)return new Group(o(e.shapes));if(Array.isArray(e)){for(var r,i,a,s,u=[],h=0;h<e.length;h+=1)r=e[h],r.commands?(i=(t(0,1)-.5)*n.x*2,a=(t(0,1)-.5)*n.y*2,s=(new Transform).translate(i,a),u.push(s.transformShape(r))):r.shapes&&u.push(o(r));return u}};return o(e)},vg.scatterPoints=function(e,n,r){if(e){r=void 0!==r?r:Math.random();var t,o,i,a,s,u=random.generator(r),h=e.bounds(),c=h.x,p=h.y,f=h.width,l=h.height,v=e.contours(),y=[],g=[];for(t=0;t<v.length;t++){var d=new Path(v[t]),m=d.commands.length,x=5;y.push(d.points(m*x,{closed:!0}))}for(t=0;n>t;t+=1)for(i=100;i>0;){var b=0;for(a=c+u(0,1)*f,s=p+u(0,1)*l,o=0;o<y.length;o++)geo.pointInPolygon(y[o],a,s)&&(b+=1);if(b%2){g.push(new Point(a,s));break}i-=1}return g}},vg.connectPoints=function(e,n){if(e){for(var r=new Path,t=0;t<e.length;t+=1){var o=e[t];0===t?r.moveTo(o.x,o.y):r.lineTo(o.x,o.y)}return n&&r.close(),r.fill=null,r.stroke=Color.BLACK,r}},vg.align=function(e,n,r,t){if(e){var o,i,a,s=n.x,u=n.y,h=vg.bounds(e);return o="left"===r?s-h.x:"right"===r?s-h.x-h.width:"center"===r?s-h.x-h.width/2:0,i="top"===t?u-h.y:"bottom"===t?u-h.y-h.height:"middle"===t?u-h.y-h.height/2:0,a=(new Transform).translate(o,i),a.transformShape(e)}},vg.snap=function(e,n,r,t){if(e){r=void 0!==r?r:1,t=t||Point.ZERO;var o=function(e){if(e.commands){for(var i=new Path([],e.fill,e.stroke,e.strokeWidth),a=0;a<e.commands.length;a+=1){var s=e.commands[a];if(s.type===bezier.MOVETO||s.type===bezier.LINETO||s.type===bezier.CURVETO){var u=math.snap(s.x+t.x,n,r)-t.x,h=math.snap(s.y+t.y,n,r)-t.y;if(s.type===bezier.MOVETO)i.moveTo(u,h);else if(s.type===bezier.LINETO)i.lineTo(u,h);else if(s.type===bezier.CURVETO){var c=math.snap(s.x1+t.x,n,r)-t.x,p=math.snap(s.y1+t.y,n,r)-t.y,f=math.snap(s.x2+t.x,n,r)-t.x,l=math.snap(s.y2+t.y,n,r)-t.y;i.curveTo(c,p,f,l,u,h)}}else{if(s.type!==bezier.CLOSE)throw new Error("Invalid path command "+s);i.close()}}return i}return e.shapes?new Group(_.map(e.shapes,o)):Array.isArray(e)&&e.length>0&&void 0!==e[0].x&&void 0!==e[0].y?_.map(e,function(e){var o=math.snap(e.x+t.x,n,r)-t.x,i=math.snap(e.y+t.y,n,r)-t.y;return new Point(o,i)}):_.map(e,o)};return o(e)}},vg.deletePoints=function(e,n,r){var t=function(e){var o,i,a,s=[],u=[];if(e.commands){var h=!0;for(o=0;o<e.commands.length;o+=1)i=_cloneCommand(e.commands[o]),(void 0===i.x||r&&n.contains(i.x,i.y)||!r&&!n.contains(i.x,i.y))&&(h&&i.type!==bezier.MOVETO&&(i.type=bezier.MOVETO),s.push(i),i.type===bezier.MOVETO?h=!1:i.type===bezier.CLOSE&&(h=!0));return new Path(s,e.fill,e.stroke,e.strokeWidth)}if(e.shapes)return new Group(_.map(e.shapes,t));if(Array.isArray(e)&&e.length>0&&void 0!==e[0].x&&void 0!==e[0].y){for(o=0;o<e.length;o+=1)a=e[o],(r&&n.contains(a.x,a.y)||!r&&!n.contains(a.x,a.y))&&u.push(_cloneCommand(a));return u}return _.map(e,t)};return t(e)},vg.deletePaths=function(e,n,r){var t=function(e){if(e.commands)return null;if(e.shapes)return new Group(t(e.shapes));if(Array.isArray(e)){for(var o,i,a,s,u,h=[],c=e,p=0;p<c.length;p+=1)if(i=c[p],i.commands){for(a=!1,o=0;o<i.commands.length;o+=1)if(s=i.commands[o],void 0!==s.x&&n.contains(s.x,s.y)){a=!0;break}r&&!a||a&&!r||h.push(i)}else i.shapes&&(u=t(i),0!==u.length&&h.push(u));return h}};return t(e)},vg["delete"]=function(e,n,r,t){if(null===e||null===n)return null;if("points"===r)return vg.deletePoints(e,n,t);if("paths"===r)return vg.deletePaths(e,n,t);throw new Error("Invalid scope.")},vg.pointOnPath=function(e,n){if(e){e.shapes&&(e=new Path(vg.combinePaths(e))),n%=1,0>n&&(n=1+n);var r=e.point(n);return new Point(r.x,r.y)}},vg._x=function(e){return void 0!==e.x?e.x:e.bounds().x},vg._y=function(e){return void 0!==e.y?e.y:e.bounds().y},vg._angleToPoint=function(e){return function(n){if(void 0!==n.x&&void 0!==n.y)return geo.angle(n.x,n.y,e.x,e.y);var r=n.bounds().centerPoint();return geo.angle(r.x,r.y,e.x,e.y)}},vg._distanceToPoint=function(e){return function(n){if(void 0!==n.x&&void 0!==n.y)return geo.distance(n.x,n.y,e.x,e.y);var r=n.bounds().centerPoint();return geo.distance(r.x,r.y,e.x,e.y)}},vg.shapeSort=function(e,n,r){if(e){r=r||Point.ZERO;var t={x:vg._x,y:vg._y,angle:vg._angleToPoint(r),distance:vg._distanceToPoint(r)};if(n=t[n],void 0===n)return e;var o=e.slice(0);return o.sort(function(e,r){var t=n(e),o=n(r);return o>t?-1:t>o?1:0}),o}},vg.group=function(){return new Group(_.flatten(arguments))},vg.ungroup=function(e){if(e){if(e.shapes){var n,r,t=[];for(n=0;n<e.shapes.length;n+=1)r=e.shapes[n],r.commands?t.push(r):r.shapes&&(t=t.concat(vg.ungroup(r)));return t}return e.commands?[e]:[]}return[]},vg.centerPoint=function(e){if(!e)return Point.ZERO;var n=vg.bounds(e);return new Point(n.x+n.width/2,n.y+n.height/2)},vg.link=function(e,n,r){if(e&&n){var t=new Path,o=e.bounds(),i=n.bounds();if(r===vg.HORIZONTAL){var a=(i.x-(o.x+o.width))/2;t.moveTo(o.x+o.width,o.y),t.curveTo(o.x+o.width+a,o.y,i.x-a,i.y,i.x,i.y),t.lineTo(i.x,i.y+i.height),t.curveTo(i.x-a,i.y+i.height,o.x+o.width+a,o.y+o.height,o.x+o.width,o.y+o.height),t.close()}else{var s=(i.y-(o.y+o.height))/2;t.moveTo(o.x,o.y+o.height),t.curveTo(o.x,o.y+o.height+s,i.x,i.y-s,i.x,i.y),t.lineTo(i.x+i.width,i.y),t.curveTo(i.x+i.width,i.y-s,o.x+o.width,o.y+o.height+s,o.x+o.width,o.y+o.height),t.close()}return t}},vg.stack=function(e,n,r){if(!e)return[];if(e.length<=1)return e;var t,o,i,a,s=e[0].bounds(),u=[];return r=r||0,n===vg.EAST?(t=-(s.width/2),_.each(e,function(e){a=e.bounds(),i=(new Transform).translate(t-a.x,0),u.push(i.transformShape(e)),t+=a.width+r})):n===vg.WEST?(t=s.width/2,_.each(e,function(e){a=e.bounds(),i=(new Transform).translate(t+a.x,0),u.push(i.transformShape(e)),t-=a.width+r})):n===vg.NORTH?(o=s.height/2,_.each(e,function(e){a=e.bounds(),i=(new Transform).translate(0,o+a.y),u.push(i.transformShape(e)),o-=a.height+r})):n===vg.SOUTH&&(o=-(s.height/2),_.each(e,function(e){a=e.bounds(),i=(new Transform).translate(0,o-a.y),u.push(i.transformShape(e)),o+=a.height+r})),u},vg.compound=function(e,n,r){function t(e){var n,r,t,o,i,a=[];for(n=0;n<e.length;n+=1){for(r=[],t=e[n],o=0;o<t.length;o+=1)i=t[o],i.type!==bezier.CLOSE&&r.push({X:i.x,Y:i.y});a.push(r)}return a}var o={union:ClipperLib.ClipType.ctUnion,difference:ClipperLib.ClipType.ctDifference,intersection:ClipperLib.ClipType.ctIntersection,xor:ClipperLib.ClipType.ctXor};e.commands||(e=Path.combine(e)),n.commands||(n=Path.combine(n));var i=e.resampleByLength(1).contours(),a=n.resampleByLength(1).contours(),s=t(i),u=t(a),h=100;ClipperLib.JS.ScaleUpPaths(s,h),ClipperLib.JS.ScaleUpPaths(u,h);var c=new ClipperLib.Clipper;c.AddPaths(s,ClipperLib.PolyType.ptSubject,e.isClosed()),c.AddPaths(u,ClipperLib.PolyType.ptClip,n.isClosed());var p=new ClipperLib.Paths;c.Execute(o[r],p,ClipperLib.PolyFillType.pftNonZero,ClipperLib.PolyFillType.pftNonZero),p=ClipperLib.JS.Clean(p,.1*h),ClipperLib.JS.ScaleDownPaths(p,h);var f,l,v,y=new Path;for(f=0;f<p.length;f+=1){for(v=p[f],l=0;l<v.length;l+=1)0===l?y.moveTo(v[l].X,v[l].Y):y.lineTo(v[l].X,v[l].Y);(v[0].X!==v[v.length-1].X||v[0].Y!==v[v.length-1].Y)&&y.closePath()}return y},module.exports=vg;


},{"../objects/color":28,"../objects/group":29,"../objects/path":31,"../objects/point":32,"../objects/rect":33,"../objects/transform":35,"../objects/transformable":36,"../util/bezier":38,"../util/geo":40,"../util/math":42,"../util/random":43,"js-clipper":3,"lodash":4}],27:[function(require,module,exports){
"use strict";var _=require("lodash"),geo=require("../util/geo"),Color=require("../objects/color"),Path=require("../objects/path"),Point=require("../objects/point"),gText=require("../objects/text"),vg={};vg.roundedRect=function(e,t,n,r,o,a){var i=new Path;return i.addRoundedRect(e,t,n,r,o,a),i},vg.quad=function(e,t,n,r){var o=arguments,a=new Path;return 8===o.length?Path.prototype.addQuad.apply(a,o):(e=Point.read(e),t=Point.read(t),n=Point.read(n),r=Point.read(r),a.addQuad(e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y)),a},vg.rect=function(e,t,n,r){var o=arguments;if(3===o.length?e=Point.read(e):4===o.length?"number"==typeof o[0]&&"number"==typeof o[1]?(e=Point.read(o[0],o[1]),t=o[2],n=o[3],r=null):(e=Point.read(e),r=Point.read(r)):(5===o.length||6===o.length)&&(e=Point.read(o[0],o[1]),t=o[2],n=o[3],r=5===o.length&&"number"==typeof o[4]?Point.read(o[4],o[4]):Point.read(o[4],o[5])),!r||0===r.x&&0===r.y){var a=new Path;return a.addRect(e.x-t/2,e.y-n/2,t,n),a}return vg.roundedRect(e.x-t/2,e.y-n/2,t,n,r.x,r.y)},vg.ellipse=function(e,t,n){var r=arguments;4===r.length?(e=Point.read(r[0],r[1]),t=r[2],n=r[3]):e=Point.read(e);var o=new Path;return o.addEllipse(e.x-t/2,e.y-n/2,t,n),o},vg.line=function(e,t){var n=arguments;4===n.length?(e=Point.read(n[0],n[1]),t=Point.read(n[2],n[3])):(e=Point.read(e),t=Point.read(t));var r=new Path;return r.addLine(e.x,e.y,t.x,t.y),r.fill=null,r.stroke="black",r},vg.lineAngle=function(e,t,n){var r=arguments;4===r.length?(e=Point.read(r[0],r[1]),n=r[2],t=r[3]):e=Point.read(e);var o=geo.coordinates(e.x,e.y,t,n);return vg.line(e,o)},vg.arc=function(e,t,n,r,o,a){var i=arguments;7===i.length?(e=Point.read(i[0],i[1]),t=i[2],n=i[3],r=i[4],o=i[5],a=i[6]):e=Point.read(e);var u=new Path;return u.addArc(e.x,e.y,t,n,r,o,a),u},vg.curve=function(e,t,n,r){var o=arguments;6===o.length?(e=Point.read(o[0],o[1]),t=Point.read(o[2],o[3]),n=o[4],r=o[5]):(e=Point.read(e),t=Point.read(t));var a=e.x+n*(t.x-e.x),i=e.y+n*(t.y-e.y),u=geo.angle(e.x,e.y,t.x,t.y)+90,l=geo.coordinates(a,i,u,r),g=l.x,d=l.y,v=e.x+2/3*(g-e.x),y=e.y+2/3*(d-e.y),c=t.x+2/3*(g-t.x),x=t.y+2/3*(d-t.y),P=new Path;return P.moveTo(e.x,e.y),P.curveTo(v,y,c,x,t.x,t.y),P.fill=null,P.stroke=Color.BLACK,P},vg.polygon=function(e,t,n,r){var o=arguments;5===o.length||4===o.length&&"number"==typeof o[0]&&"number"==typeof o[1]?(e=Point.read(o[0],o[1]),t=o[2],n=o[3],r=5===o.length?o[4]:!0):(e=Point.read(e),3===o.length&&(r=!0)),n=Math.max(n,3);var a,i,u,l,g=e.x,d=e.y,v=t,y=360/n,c=0;r===!0&&(a=geo.coordinates(g,d,0,v),i=geo.coordinates(g,d,y,v),c=-geo.angle(i.x,i.y,a.x,a.y));var x=new Path;for(u=0;n>u;u+=1)l=geo.coordinates(g,d,y*u+c,v),0===u?x.moveTo(l.x,l.y):x.lineTo(l.x,l.y);return x.close(),x},vg.star=function(e,t,n,r){var o=arguments;5===o.length||4===o.length&&"number"==typeof o[0]&&"number"==typeof o[1]?(e=Point.read(o[0],o[1]),t=o[2],n=o[3],r=o[4]):e=Point.read(e),r||(r=n);var a,i,u,l,g,d=new Path;for(d.moveTo(e.x,e.y+n/2),a=1;2*t>a;a+=1)i=a*Math.PI/t,u=a%2===1?r/2:n/2,l=e.x+u*Math.sin(i),g=e.y+u*Math.cos(i),d.lineTo(l,g);return d.close(),d},vg.freehand=function(e){var t,n,r,o=function(e){return""!==e},a=_.filter(e.split("M"),o);a=_.map(a,function(e){return e.replace(/,/g," ")});var i=new Path;for(n=0;n<a.length;n+=1)for(r=_.filter(a[n].split(" "),o),t=0;t<r.length;t+=2)if(void 0!==r[t+1]){var u=parseFloat(r[t]),l=parseFloat(r[t+1]);0===t?i.moveTo(u,l):i.lineTo(u,l)}return i.fill=null,i.stroke=Color.BLACK,i},vg.grid=function(e,t,n,r,o){var a,i,u,l,g,d,v,y,c,x=[];for(x.length=e*t,o=void 0!==o?o:Point.ZERO,e>1?(a=n*(e-1),i=o.x-a/2):i=o.x,t>1?(u=r*(t-1),l=o.y-u/2):l=o.y,c=0,g=0;t>g;g+=1)for(d=0;e>d;d+=1)v=i+d*n,y=l+g*r,x[c]=new Point(v,y),c+=1;return x},vg.text=function(){var e=Object.create(gText.prototype);return e.constructor=gText.prototype,gText.apply(e,arguments),e},vg.demoRect=function(){return new vg.rect({x:0,y:0},100,100,{x:0,y:0})},vg.demoEllipse=function(){return new vg.ellipse({x:0,y:0},100,100)},module.exports=vg;


},{"../objects/color":28,"../objects/path":31,"../objects/point":32,"../objects/text":34,"../util/geo":40,"lodash":4}],28:[function(require,module,exports){
"use strict";var math=require("../util/math"),color=require("../util/color"),js=require("../util/js"),HSB="HSB",HSL="HSL",HEX="HEX",Color=function(r,o,t,e,s){var n,i,l,a,h,d;void 0===r?(n=i=l=0,a=1):Array.isArray(r)?(d=o||{},n=void 0!==r[0]?r[0]:0,i=void 0!==r[1]?r[1]:0,l=void 0!==r[2]?r[2]:0,a=void 0!==r[3]?r[3]:d.range||1):void 0!==r.r?(d=o||{},n=r.r,i=r.g,l=r.b,a=void 0!==r.a?r.a:d.range||1):"string"==typeof r?(h=color.hex2rgb(r),n=h[0],i=h[1],l=h[2],a=1):"number"==typeof r&&(1===arguments.length?(n=i=l=r,a=1):2===arguments.length?(n=i=l=r,"number"==typeof o?a=o:(d=o,a=d.range||1)):3===arguments.length?"number"==typeof t?(n=r,i=o,l=t,a=1):(n=i=l=r,a=o,d=t):4===arguments.length?(n=r,i=o,l=t,"number"==typeof e?a=e:(d=e,a=d.range||1)):(n=r,i=o,l=t,a=e,d=s)),d=d||{},void 0!==d.range&&(n/=d.range,i/=d.range,l/=d.range,a/=d.range,d.mode===HSB&&(r/=d.range,o/=d.range,t/=d.range)),d.mode===HSB?(r=math.clamp(r,0,1),o=math.clamp(o,0,1),t=math.clamp(t,0,1),h=color.hsb2rgb(r,o,t),n=h[0],i=h[1],l=h[2]):d.mode===HSL?(r=math.clamp(r,0,1),o=math.clamp(o,0,1),t=math.clamp(t,0,1),h=color.hsl2rgb(r,o,t),n=h[0],i=h[1],l=h[2]):d.mode===HEX&&(h=color.hex2rgb(r),n=h[0],i=h[1],l=h[2],a=1),this.r=math.clamp(n,0,1),this.g=math.clamp(i,0,1),this.b=math.clamp(l,0,1),this.a=math.clamp(a,0,1)};Color.BLACK=new Color(0),Color.WHITE=new Color(1),js.defineAlias(Color,"r","red"),js.defineAlias(Color,"g","green"),js.defineAlias(Color,"b","blue"),js.defineAlias(Color,"a","alpha"),js.defineGetter(Color,"h",function(){return color.rgb2hsl(this.r,this.g,this.b)[0]}),js.defineGetter(Color,"s",function(){return color.rgb2hsl(this.r,this.g,this.b)[1]}),js.defineGetter(Color,"l",function(){return color.rgb2hsl(this.r,this.g,this.b)[2]}),js.defineAlias(Color,"h","hue"),js.defineAlias(Color,"s","saturation"),js.defineAlias(Color,"l","lightness"),js.defineGetter(Color,"rgb",function(){return[this.r,this.g,this.b]}),js.defineGetter(Color,"rgba",function(){return[this.r,this.g,this.b,this.a]}),js.defineGetter(Color,"hsb",function(){return color.rgb2hsb(this.r,this.g,this.b)}),js.defineGetter(Color,"hsba",function(){return color.rgb2hsb(this.r,this.g,this.b).concat([this.a])}),js.defineGetter(Color,"hsl",function(){return color.rgb2hsl(this.r,this.g,this.b)}),js.defineGetter(Color,"hsla",function(){return color.rgb2hsl(this.r,this.g,this.b).concat([this.a])}),Color.prototype.toCSS=function(){return Color.toCSS(this)},Color.prototype.toHex=function(){return this.a>=1?color.rgb2hex(this.r,this.g,this.b):color.rgba2hex(this.r,this.g,this.b,this.a)},Color.prototype.desaturate=function(r){if(this.r===this.g&&this.g===this.b)return this;var o,t,e;void 0!==r&&r.method&&"ITU-R BT.601"!==r.method?"ITU-R BT.709"===r.method&&(o=.2125,t=.7154,e=.0721):(o=.3,t=.59,e=.11);var s=this.r*o+this.g*t+this.b*e;return new Color(s,s,s,this.a)},Color.prototype.invert=function(){return new Color(1-this.r,1-this.g,1-this.b,this.a)},Color.clone=function(r){return null===r||void 0===r?null:"string"==typeof r?r:new Color(r.r,r.g,r.b,r.a)},Color.toCSS=function(r){if(null===r)return"none";if(void 0===r)return"black";if("string"==typeof r)return r;if(r instanceof Color){var o=Math.round(255*r.r),t=Math.round(255*r.g),e=Math.round(255*r.b);return"rgba("+o+", "+t+", "+e+", "+r.a+")"}if(void 0!==r.r&&void 0!==r.g&&void 0!==r.b)return void 0===r.a?"rgb("+r.r+", "+r.g+", "+r.b+")":"rgba("+r.r+", "+r.g+", "+r.b+", "+r.a+")";throw new Error("Don't know how to convert "+r+" to CSS.")},Color.toHex=function(r){return Color.parse(r).toHex()},Color.make=function(){var r=Object.create(Color.prototype);return r.constructor=Color.prototype,Color.apply(r,arguments),r},Color.parse=function(r){function o(r,o){return r&&o?(r=String(r),0===r.indexOf(o)):!1}var t;if(void 0===r||null===r)return new Color(0,0,0,0);if(r instanceof Color)return r;if(color.namedColors[r])return Color.make.apply(null,color.namedColors[r]);if("#"===r[0])return new Color(r,0,0,0,{mode:HEX});if(o(r,"rgba"))return t=r.match(/^rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+|\d+.\d+)\s*\)$/i),t?new Color(parseInt(t[1])/255,parseInt(t[2])/255,parseInt(t[3])/255,parseFloat(t[4])):(t=r.match(/^rgba\s*\(\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)\s*\)$/i))?new Color(parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])/100,parseFloat(t[4])):new Color(0,0,0,0);if(o(r,"rgb"))return t=r.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),t?new Color(parseInt(t[1])/255,parseInt(t[2])/255,parseInt(t[3])/255):(t=r.match(/^rgb\s*\(\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*\)$/i))?new Color(parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])/100):new Color(0,0,0,0);if(o(r,"hsla"))return t=r.match(/^hsla\s*\(\s*(\d+|\d+.\d+)\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)\s*\)$/i),t?new Color(parseFloat(t[1])/360,parseFloat(t[2])/100,parseFloat(t[3])/100,parseFloat(t[4])):new Color(0,0,0,0);if(o(r,"hsl"))return t=r.match(/^hsl\s*\(\s*(\d+|\d+.\d+)\s*,\s*(\d+|\d+.\d+)%\s*,\s*(\d+|\d+.\d+)%\s*\)$/i),t?new Color(parseFloat(t[1])/360,parseFloat(t[2])/100,parseFloat(t[3])/100):new Color(0,0,0,0);if("none"===r||"null"===r||o(r,"url("))return new Color(0,0,0,0);throw new Error("Color "+r+"can not be parsed")},Color.gray=function(r,o,t){return t=Math.max(t,1),new Color(r/t,r/t,r/t,o/t)},Color.rgb=function(r,o,t,e,s){return s=Math.max(s,1),new Color(r/s,o/s,t/s,e/s)},Color.hsb=function(r,o,t,e,s){return s=Math.max(s,1),new Color(r/s,o/s,t/s,e/s,{mode:HSB})},Color.hsl=function(r,o,t,e,s){return s=Math.max(s,1),new Color(r/s,o/s,t/s,e/s,{mode:HSL})},module.exports=Color;


},{"../util/color":39,"../util/js":41,"../util/math":42}],29:[function(require,module,exports){
"use strict";var _=require("lodash"),Path=require("../objects/path"),Rect=require("../objects/rect"),Color=require("../objects/color"),Group=function(t){t?t.shapes||t.commands?this.shapes=[t]:t&&(this.shapes=t):this.shapes=[]};Group.prototype.add=function(t){this.shapes.push(t)},Group.prototype.clone=function(){var t,e=[],r=this.shapes.length;for(e.length=r,t=0;r>t;t+=1)e[t]=this.shapes[t].clone();return new Group(e)},Group.prototype.colorize=function(t){var e=arguments;("object"!=typeof t||t instanceof Color)&&(t={},void 0!==e[0]&&(t.fill=e[0]),void 0!==e[1]&&(t.stroke=e[1]),void 0!==e[2]&&(t.strokeWidth=e[2]));var r=_.map(this.shapes,function(e){return e.colorize(t)});return new Group(r)},Group.prototype.desaturate=function(t){var e=_.map(this.shapes,function(e){return e.desaturate(t)});return new Group(e)},Group.prototype.invert=function(){var t=_.map(this.shapes,function(t){return t.invert()});return new Group(t)},Group.prototype.bounds=function(){if(0===this.shapes.length)return new Rect(0,0,0,0);var t,e,r,o=this.shapes;for(t=0;t<o.length;t+=1)r=o[t],void 0===e&&(e=r.bounds()),(r.shapes&&0!==r.shapes.length||r.commands&&0!==r.commands.length)&&(e=e.unite(r.bounds()));return void 0!==e?e:new Rect(0,0,0,0)},Group.prototype.contains=function(t,e,r){void 0===r&&(r=100);var o,n=this.shapes;for(o=0;o<n.length;o+=1)if(n[o].contains(t,e,r))return!0;return!1},Group.prototype.length=function(t){void 0===t&&(t=10);for(var e=0,r=this.shapes,o=0;o<r.length;o+=1)e+=r[o].length(t);return e},Group.prototype.resampleByAmount=function(t,e){var r,o;return e?(o=_.map(this.shapes,function(r){return r.resampleByAmount(t,e)}),new Group(o)):(r=new Path.combine(this),r.resampleByAmount(t,e))},Group.prototype.resampleByLength=function(t){var e=_.map(this.shapes,function(e){return e.resampleByLength(t)});return new Group(e)},Group.prototype.toSVG=function(){var t;return t=_.map(this.shapes,function(t){return t.toSVG()}),"<g>"+t.join("")+"</g>"},Group.prototype.draw=function(t){var e,r=this.shapes,o=r.length;for(e=0;o>e;e+=1)r[e].draw(t)},module.exports=Group;


},{"../objects/color":28,"../objects/path":31,"../objects/rect":33,"lodash":4}],30:[function(require,module,exports){
"use strict";var Vec3=require("../objects/vec3"),Matrix4=function(m){void 0!==m?this.m=m:(m=new Float32Array(16),m[0]=1,m[1]=0,m[2]=0,m[3]=0,m[4]=0,m[5]=1,m[6]=0,m[7]=0,m[8]=0,m[9]=0,m[10]=1,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,this.m=m)};Matrix4.IDENTITY=new Matrix4,Matrix4.perspective=function(m,t,i,s){var h=new Float32Array(Matrix4.IDENTITY.m),r=1/Math.tan(.5*m);return h[0]=r/t,h[1]=h[2]=h[3]=0,h[5]=r,h[4]=h[6]=h[7]=0,h[8]=h[9]=0,h[10]=-s/(i-s),h[11]=1,h[12]=h[13]=h[15]=0,h[14]=i*s/(i-s),new Matrix4(h)},Matrix4.lookAt=function(m,t,i){var s,h,r,a,e,n,o;return s=new Float32Array(16),h=t.subtract(m).normalize(),r=Vec3.cross(i,h).normalize(),a=Vec3.cross(h,r).normalize(),e=-Vec3.dot(r,m),n=-Vec3.dot(a,m),o=-Vec3.dot(h,m),s[0]=r.x,s[1]=a.x,s[2]=h.x,s[3]=0,s[4]=r.y,s[5]=a.y,s[6]=h.y,s[7]=0,s[8]=r.z,s[9]=a.z,s[10]=h.z,s[11]=0,s[12]=e,s[13]=n,s[14]=o,s[15]=1,new Matrix4(s)},Matrix4.prototype.invert=function(){var m,t,i,s,h,r,a,e,n,o,c,x,u,M,l,y,w,p,v,A,f,z,F,V,d,I,T,b,D,E,N,Y,j,k,q,g,B,C,G,H;return m=this.m[0],t=this.m[1],i=this.m[2],s=this.m[3],h=this.m[4],r=this.m[5],a=this.m[6],e=this.m[7],n=this.m[8],o=this.m[9],c=this.m[10],x=this.m[11],u=this.m[12],M=this.m[13],l=this.m[14],y=this.m[15],w=c*y-x*l,p=o*y-x*M,v=o*l-c*M,A=n*y-x*u,f=n*l-c*u,z=n*M-o*u,F=r*w-a*p+e*v,V=-(h*w-a*A+e*f),d=h*p-r*A+e*z,I=-(h*v-r*f+a*z),T=1/(m*F+t*V+i*d+s*I),b=a*y-e*l,D=r*y-e*M,E=r*l-a*M,N=h*y-e*u,Y=h*l-a*u,j=h*M-r*u,k=a*x-e*c,q=r*x-e*o,g=r*c-a*o,B=h*x-e*n,C=h*c-a*n,G=h*o-r*n,H=new Float32Array(16),H[0]=F*T,H[4]=V*T,H[8]=d*T,H[12]=I*T,H[1]=-(t*w-i*p+s*v)*T,H[5]=(m*w-i*A+s*f)*T,H[9]=-(m*p-t*A+s*z)*T,H[13]=(m*v-t*f+i*z)*T,H[2]=(t*b-i*D+s*E)*T,H[6]=-(m*b-i*N+s*Y)*T,H[10]=(m*D-t*N+s*j)*T,H[14]=-(m*E-t*Y+i*j)*T,H[3]=-(t*k-i*q+s*g)*T,H[7]=(m*k-i*B+s*C)*T,H[11]=-(m*q-t*B+s*G)*T,H[15]=(m*g-t*C+i*G)*T,new Matrix4(H)},Matrix4.prototype.multiply=function(m){var t=new Float32Array(16);return t[0]=this.m[0]*m.m[0]+this.m[1]*m.m[4]+this.m[2]*m.m[8]+this.m[3]*m.m[12],t[1]=this.m[0]*m.m[1]+this.m[1]*m.m[5]+this.m[2]*m.m[9]+this.m[3]*m.m[13],t[2]=this.m[0]*m.m[2]+this.m[1]*m.m[6]+this.m[2]*m.m[10]+this.m[3]*m.m[14],t[3]=this.m[0]*m.m[3]+this.m[1]*m.m[7]+this.m[2]*m.m[11]+this.m[3]*m.m[15],t[4]=this.m[4]*m.m[0]+this.m[5]*m.m[4]+this.m[6]*m.m[8]+this.m[7]*m.m[12],t[5]=this.m[4]*m.m[1]+this.m[5]*m.m[5]+this.m[6]*m.m[9]+this.m[7]*m.m[13],t[6]=this.m[4]*m.m[2]+this.m[5]*m.m[6]+this.m[6]*m.m[10]+this.m[7]*m.m[14],t[7]=this.m[4]*m.m[3]+this.m[5]*m.m[7]+this.m[6]*m.m[11]+this.m[7]*m.m[15],t[8]=this.m[8]*m.m[0]+this.m[9]*m.m[4]+this.m[10]*m.m[8]+this.m[11]*m.m[12],t[9]=this.m[8]*m.m[1]+this.m[9]*m.m[5]+this.m[10]*m.m[9]+this.m[11]*m.m[13],t[10]=this.m[8]*m.m[2]+this.m[9]*m.m[6]+this.m[10]*m.m[10]+this.m[11]*m.m[14],t[11]=this.m[8]*m.m[3]+this.m[9]*m.m[7]+this.m[10]*m.m[11]+this.m[11]*m.m[15],t[12]=this.m[12]*m.m[0]+this.m[13]*m.m[4]+this.m[14]*m.m[8]+this.m[15]*m.m[12],t[13]=this.m[12]*m.m[1]+this.m[13]*m.m[5]+this.m[14]*m.m[9]+this.m[15]*m.m[13],t[14]=this.m[12]*m.m[2]+this.m[13]*m.m[6]+this.m[14]*m.m[10]+this.m[15]*m.m[14],t[15]=this.m[12]*m.m[3]+this.m[13]*m.m[7]+this.m[14]*m.m[11]+this.m[15]*m.m[15],new Matrix4(t)},Matrix4.prototype.translate=function(m,t,i){var s=new Float32Array(this.m);return s[12]+=m,s[13]+=t,s[14]+=i,new Matrix4(s)},module.exports=Matrix4;


},{"../objects/vec3":37}],31:[function(require,module,exports){
"use strict";function _cloneCommand(t){var o={type:t.type};return o.type!==CLOSE&&(o.x=t.x,o.y=t.y),o.type===QUADTO?(o.x1=t.x1,o.y1=t.y1):o.type===CURVETO&&(o.x1=t.x1,o.y1=t.y1,o.x2=t.x2,o.y2=t.y2),o}var _=require("lodash"),bezier=require("../util/bezier"),geo=require("../util/geo"),math=require("../util/math"),Color=require("../objects/color"),Rect=require("../objects/rect"),MOVETO=bezier.MOVETO,LINETO=bezier.LINETO,QUADTO=bezier.QUADTO,CURVETO=bezier.CURVETO,CLOSE=bezier.CLOSE,CLOSE_COMMAND=Object.freeze({type:CLOSE}),KAPPA=.5522847498307936,Path=function(t,o,e,i){this.commands=void 0!==t?t:[],this.fill=void 0!==o?o:"black",this.stroke=void 0!==e?e:null,this.strokeWidth=void 0!==i?i:1};Path.prototype.clone=function(){var t,o=new Path,e=this.commands.length;for(o.commands.length=this.commands.length,t=0;e>t;t+=1)o.commands[t]=_cloneCommand(this.commands[t]);return o.fill=Color.clone(this.fill),o.stroke=Color.clone(this.stroke),o.strokeWidth=this.strokeWidth,o},Path.prototype.extend=function(t){var o=t.commands||t;Array.prototype.push.apply(this.commands,o)},Path.prototype.moveTo=function(t,o){this.commands.push({type:MOVETO,x:t,y:o})},Path.prototype.lineTo=function(t,o){this.commands.push({type:LINETO,x:t,y:o})},Path.prototype.curveTo=function(t,o,e,i,s,r){this.commands.push({type:CURVETO,x1:t,y1:o,x2:e,y2:i,x:s,y:r})},Path.prototype.quadTo=function(t,o,e,i){var s=this.commands[this.commands.length-1].x,r=this.commands[this.commands.length-1].y,n=s+2/3*(t-s),h=r+2/3*(o-r),a=n+1/3*(e-s),l=h+1/3*(i-r);this.curveTo(n,h,a,l,e,i)},Path.prototype.closePath=Path.prototype.close=function(){this.commands.push(CLOSE_COMMAND)},Path.prototype.isClosed=function(){return 0===this.commands.length?!1:this.commands[this.commands.length-1].type===CLOSE},Path.prototype.addRect=function(t,o,e,i){this.moveTo(t,o),this.lineTo(t+e,o),this.lineTo(t+e,o+i),this.lineTo(t,o+i),this.close()},Path.prototype.addRoundedRect=function(t,o,e,i,s,r){var n=1-.552,h=s,a=r,l=t,c=t+e,p=o,u=o+i;h=Math.min(h,.5*e),a=Math.min(a,.5*i),this.moveTo(l+h,p),.5*e>h&&this.lineTo(c-s,p),this.curveTo(c-h*n,p,c,p+a*n,c,p+a),.5*i>a&&this.lineTo(c,u-a),this.curveTo(c,u-a*n,c-h*n,u,c-h,u),.5*e>h&&this.lineTo(l+h,u),this.curveTo(l+h*n,u,l,u-a*n,l,u-a),.5*i>a&&this.lineTo(l,p+a),this.curveTo(l,p+a*n,l+h*n,p,l+h,p),this.close()},Path.prototype.addEllipse=function(t,o,e,i){var s=.5*KAPPA*e,r=.5*KAPPA*i,n=t+.5*e,h=o+.5*i,a=t+e,l=o+i;this.moveTo(t,h),this.curveTo(t,h-r,n-s,o,n,o),this.curveTo(n+s,o,a,h-r,a,h),this.curveTo(a,h+r,n+s,l,n,l),this.curveTo(n-s,l,t,h+r,t,h),this.close()},Path.prototype.addLine=function(t,o,e,i){this.moveTo(t,o),this.lineTo(e,i)},Path.prototype.addQuad=function(t,o,e,i,s,r,n,h){this.moveTo(t,o),this.lineTo(e,i),this.lineTo(s,r),this.lineTo(n,h),this.close()},Path.prototype.addArc=function(t,o,e,i,s,r,n){n=n||"pie";var h,a,l,c,p,u,m,d,y,f,v,T,P;for(h=e/2,a=i/2,l=math.radians(s),c=r,c>=360||-360>=c?(p=4,u=Math.PI/2,m=.5522847498307933,0>c&&(u=-u,m=-m)):(p=Math.ceil(Math.abs(c)/90),u=math.radians(c/p),m=4/3*Math.sin(u/2)/(1+Math.cos(u/2)),0===m&&(p=0)),"open"===n?d=0:"chord"===n?d=1:"pie"===n&&(d=2),(0>h||0>a)&&(p=d=-1),y=0;p+d>=y;)f=l,0===y?this.moveTo(t+Math.cos(f)*h,o+Math.sin(f)*a):y>p?y===p+d?this.close():this.lineTo(t,o):(f+=u*(y-1),v=Math.cos(f),T=Math.sin(f),P=[],P.push(t+(v-m*T)*h),P.push(o+(T+m*v)*a),f+=u,v=Math.cos(f),T=Math.sin(f),P.push(t+(v+m*T)*h),P.push(o+(T-m*v)*a),P.push(t+v*h),P.push(o+T*a),Path.prototype.curveTo.apply(this,P)),y+=1},Path.prototype.colorize=function(t){var o=arguments;("object"!=typeof t||t instanceof Color)&&(t={},void 0!==o[0]&&(t.fill=o[0]),void 0!==o[1]&&(t.stroke=o[1]),void 0!==o[2]&&(t.strokeWidth=o[2]));var e=this.clone();return t.fill&&(e.fill=Color.clone(t.fill)),t.stroke&&(e.stroke=Color.clone(t.stroke)),(t.strokeWidth||0===t.strokeWidth)&&(e.strokeWidth=t.strokeWidth),e},Path.prototype.desaturate=function(t){var o=this.clone(),e=o.fill,i=o.stroke;return e instanceof Color||(e=Color.parse(e)),i instanceof Color||(i=Color.parse(i)),o.fill=e.desaturate(t),o.stroke=i.desaturate(t),o},Path.prototype.invert=function(){var t=this.clone(),o=t.fill,e=t.stroke;return o instanceof Color||(o=Color.parse(o)),e instanceof Color||(e=Color.parse(e)),t.fill=o.invert(),t.stroke=e.invert(),t},Path.prototype.contours=function(){var t=[],o=[];return _.each(this.commands,function(e){e.type===MOVETO?(0!==o.length&&t.push(o),o=[e]):o.push(e)}),0!==o.length&&t.push(o),t},Path.prototype.bounds=function(){if(this._bounds)return this._bounds;if(0===this.commands.length)return new Rect(0,0,0,0);var t,o,e,i,s,r=Number.MAX_VALUE,n=Number.MAX_VALUE,h=-Number.MAX_VALUE,a=-Number.MAX_VALUE;return _.each(this.commands,function(l){if(l.type===MOVETO||l.type===LINETO)t=l.x,o=l.y,r>t&&(r=t),n>o&&(n=o),t>h&&(h=t),o>a&&(a=o),e=l;else if(l.type===CURVETO){var c=bezier.extrema(e.x,e.y,l.x1,l.y1,l.x2,l.y2,l.x,l.y);i=c.x+c.width,s=c.y+c.height,c.x<r&&(r=c.x),i>h&&(h=i),c.y<n&&(n=c.y),s>a&&(a=s),e=l}}),new Rect(r,n,h-r,a-n)},Path.prototype.point=function(t,o){return void 0===o&&(o=bezier.segmentLengths(this.commands,!0,10)),bezier.point(this,t,o)},Path.prototype.points=function(t,o){var e=o&&void 0!==o.start?o.start:0,i=o&&void 0!==o.end?o.end:1;if(0===this.commands.length)return[];t=Math.round(t);var s;s=o&&o.closed?t>1?(i-e)/t:i-e:t>1?(i-e)/(t-1):i-e;for(var r=[],n=bezier.segmentLengths(this.commands,!0,10),h=0;t>h;h+=1)r.push(this.point(e+s*h,n));return r},Path.prototype.length=function(t){return void 0===t&&(t=20),bezier.length(this,t)},Path.prototype.contains=function(t,o,e){var i=this.points(void 0!==e?e:100);return geo.pointInPolygon(i,t,o)},Path.prototype.resampleByAmount=function(t,o){for(var e=o?this.contours():[this.commands],i=new Path([],this.fill,this.stroke,this.strokeWidth),s=0;s<e.length;s+=1){var r=new Path(e[s]),n={};r.isClosed()&&(n.closed=!0);for(var h=r.points(t,n),a=0;a<h.length;a+=1)0===a?i.moveTo(h[a].x,h[a].y):i.lineTo(h[a].x,h[a].y);r.isClosed()&&i.close()}return i},Path.prototype.resampleByLength=function(t,o){o=o||{};var e=o.force||!1,i=this.contours(),s=[];e||(t=Math.max(t,1));for(var r=0;r<i.length;r+=1){var n=new Path(i[r]),h=n.length(),a=Math.ceil(h/t);s=s.concat(n.resampleByAmount(a).commands)}return new Path(s,this.fill,this.stroke,this.strokeWidth)},Path.prototype.toPathData=function(){var t,o,e,i,s,r,n,h,a;for(o="",t=0;t<this.commands.length;t+=1)e=this.commands[t],void 0!==e.x&&(i=math.clamp(e.x,-9999,9999),s=math.clamp(e.y,-9999,9999)),void 0!==e.x1&&(r=math.clamp(e.x1,-9999,9999),n=math.clamp(e.y1,-9999,9999)),void 0!==e.x2&&(h=math.clamp(e.x2,-9999,9999),a=math.clamp(e.y2,-9999,9999)),e.type===MOVETO?isNaN(i)||isNaN(s)||(o+="M"+i+" "+s):e.type===LINETO?isNaN(i)||isNaN(s)||(o+="L"+i+" "+s):e.type===QUADTO?isNaN(i)||isNaN(s)||isNaN(r)||isNaN(n)||(o+="Q"+r+" "+n+" "+i+" "+s):e.type===CURVETO?isNaN(i)||isNaN(s)||isNaN(r)||isNaN(n)||isNaN(h)||isNaN(a)||(o+="C"+r+" "+n+" "+h+" "+a+" "+i+" "+s):e.type===CLOSE&&(o+="Z");return o},Path.prototype.toSVG=function(){var t='<path d="';t+=this.toPathData(),t+='"';var o,e,i="";this.fill&&(o=Color.parse(this.fill),o.a<1&&(e=o.a),o=Color.toHex(o).substring(0,7)),"black"!==o&&"#000000"!==o&&(i+=null===o||void 0===o?"fill:none;":"fill:"+o+";"),void 0!==e&&(i+="fill-opacity:"+e+";");var s,r;return this.stroke&&(s=Color.parse(this.stroke),s.a<1&&(r=s.a),s=Color.toHex(s).substring(0,7)),s&&(i+="stroke:"+s+";",i+="stroke-width:"+this.strokeWidth+";"),void 0!==r&&(i+="stroke-opacity:"+r+";"),i&&(t+=' style="'+i+'"'),t+="/>"},Path.prototype.draw=function(t){var o,e,i;for(t.beginPath(),o=this.commands.length,e=0;o>e;e+=1)i=this.commands[e],i.type===MOVETO?t.moveTo(i.x,i.y):i.type===LINETO?t.lineTo(i.x,i.y):i.type===QUADTO?t.quadraticCurveTo(i.x1,i.y1,i.x,i.y):i.type===CURVETO?t.bezierCurveTo(i.x1,i.y1,i.x2,i.y2,i.x,i.y):i.type===CLOSE&&t.closePath();null!==this.fill&&void 0!==this.fill&&(t.fillStyle=Color.toCSS(this.fill),t.fill()),null!==this.stroke&&void 0!==this.stroke&&null!==this.strokeWidth&&this.strokeWidth>0&&(t.strokeStyle=Color.toCSS(this.stroke),t.lineWidth=this.strokeWidth,t.stroke())},Path.combine=function(){for(var t=_.flatten(arguments),o=[],e=0;e<t.length;e+=1){var i=t[e];i.commands?o=o.concat(i.commands):i.shapes&&(o=o.concat(Path.combine(i.shapes).commands))}return new Path(o)},module.exports=Path;


},{"../objects/color":28,"../objects/rect":33,"../util/bezier":38,"../util/geo":40,"../util/math":42,"lodash":4}],32:[function(require,module,exports){
"use strict";var Point=function(t,n){this.x=void 0!==t?t:0,this.y=void 0!==n?n:0};Object.defineProperty(Point.prototype,"xy",{get:function(){return[this.x,this.y]}}),Point.ZERO=new Point(0,0),Point.read=function(t,n){if(2===arguments.length)return new Point(t,n);var i=t;return i instanceof Point?i:"number"==typeof i?new Point(i,i):Array.isArray(i)?0===i.length?Point.ZERO:(t=i[0],n=i.length>1?i[1]:t,new Point(t,n)):void 0!==i.x&&void 0!==i.y?new Point(i.x,i.y):Point.ZERO},Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.add=function(t){return new Point(this.x+t.x,this.y+t.y)},Point.prototype.subtract=Point.prototype.sub=function(t){return new Point(this.x-t.x,this.y-t.y)},Point.prototype.divide=function(t){return new Point(this.x/t,this.y/t)},Point.prototype.multiply=function(t){return new Point(this.x*t,this.y*t)},Point.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},Point.prototype.magnitudeSquared=function(){return this.x*this.x+this.y*this.y},Point.prototype.heading=function(){return Math.atan2(this.y,this.x)},Point.prototype.distanceTo=function(t){var n=this.x-t.x,i=this.y-t.y;return Math.sqrt(n*n+i*i)},Point.prototype.normalize=function(){var t=this.magnitude();return 0!==t?this.divide(t):Point.ZERO},Point.prototype.limit=function(t){return this.magnitudeSquared()>t*t?this.normalize().multiply(t):this},Point.prototype.translate=function(t,n){return new Point(this.x+t,this.y+n)},Point.prototype.scale=function(t,n){return n=void 0!==n?n:t,new Point(this.x*t,this.y*n)},Point.prototype.toString=function(){return"["+this.x+", "+this.y+"]"},module.exports=Point;


},{}],33:[function(require,module,exports){
"use strict";var Point=require("../objects/point"),Rect=function(t,i,h,e){this.x=void 0!==t?t:0,this.y=void 0!==i?i:0,this.width=void 0!==h?h:0,this.height=void 0!==e?e:0};Object.defineProperty(Rect.prototype,"xywh",{get:function(){return[this.x,this.y,this.width,this.height]}}),Rect.prototype.normalize=function(){var t=this.x,i=this.y,h=this.width,e=this.height;return 0>h&&(t+=h,h=-h),0>e&&(i+=e,e=-e),new Rect(t,i,h,e)},Rect.prototype.containsPoint=function(t,i){return 1===arguments.length&&(i=t.y,t=t.x),t>=this.x&&t<=this.x+this.width&&i>=this.y&&i<=this.y+this.height},Rect.prototype.containsRect=function(t){return t.x>=this.x&&t.x+t.width<=this.x+this.width&&t.y>=this.y&&t.y+t.height<=this.y+this.height},Rect.prototype.grow=function(t,i){var h=this.x-t,e=this.y-i,s=this.width+2*t,n=this.height+2*i;return new Rect(h,e,s,n)},Rect.prototype.unite=function(t){var i=Math.min(this.x,t.x),h=Math.min(this.y,t.y),e=Math.max(this.x+this.width,t.x+t.width)-i,s=Math.max(this.y+this.height,t.y+t.height)-h;return new Rect(i,h,e,s)},Rect.prototype.addPoint=function(t,i){var h,e,s=this.x,n=this.y,o=this.width,r=this.height;return t<this.x?(h=this.x-t,s=t,o+=h):t>this.x+this.width&&(h=t-(this.x+this.width),o+=h),i<this.y?(e=this.y-i,n=i,r+=e):i>this.y+this.height&&(e=i-(this.y+this.height),r+=e),new Rect(s,n,o,r)},Rect.prototype.centerPoint=function(){return new Point(this.x+this.width/2,this.y+this.height/2)},module.exports=Rect;


},{"../objects/point":32}],34:[function(require,module,exports){
"use strict";var Color=require("../objects/color"),Rect=require("../objects/rect"),Transform=require("../objects/transform"),_dummyContext=null,gText=function(t){var e,i=Array.prototype.slice.call(arguments,1),n=arguments[1],o=arguments[2],s=arguments[arguments.length-1];this.text=String(t),"number"==typeof n?(this.x=n,this.y=o,i=i.slice(2)):Array.isArray(n)?(this.x=n[0],this.y=n[1],i=i.slice(1)):"object"==typeof n?(this.x=void 0!==n.x?n.x:0,this.y=void 0!==n.y?n.y:0,i=i.slice(1)):(this.x=0,this.y=0),"object"==typeof s?(e=s,n!==s&&(i=i.slice(0,i.length-1))):e={},i.length?this.fontFamily=i.shift():this.fontFamily=e.fontFamily||e.fontName||e.font||"sans-serif",i.length?this.fontSize=i.shift():this.fontSize=e.fontSize||24,i.length?this.textAlign=i.shift():this.textAlign=e.align||e.textAlign||"left",i.length?this.fill=i.shift():this.fill=e.fill||"black",this.transform=new Transform};gText.prototype.clone=function(){var t=new gText;return t.text=this.text,t.x=this.x,t.y=this.y,t.fontFamily=this.fontFamily,t.fontSize=this.fontSize,t.textAlign=this.textAlign,t.fill=Color.clone(this.fill),t.transform=this.transform,t},gText._getDummyContext=function(){return _dummyContext||(_dummyContext="undefined"!=typeof document?document.createElement("canvas").getContext("2d"):{font:"10px sans-serif",measureText:function(t){var e=parseFloat(this.font);return{width:t.length*e*.6}}}),_dummyContext},gText.prototype._getFont=function(){return this.fontSize+"px "+this.fontFamily},gText.prototype.colorize=function(t){var e=this.clone();return e.fill=Color.clone(t),e},gText.prototype.draw=function(t){t.save(),t.font=this._getFont(),t.textAlign=this.textAlign;var e=this.transform.m;t.transform(e[0],e[1],e[3],e[4],e[6],e[7]),t.fillStyle=Color.toCSS(this.fill),t.fillText(this.text,this.x,this.y),t.restore()},gText.prototype.bounds=function(){var t,e=gText._getDummyContext(),i=this.x;return e.font=this._getFont(),t=e.measureText(this.text),"center"===this.textAlign?i=this.x-t.width/2:"right"===this.textAlign&&(i=this.x-t.width),new Rect(i,this.y-this.fontSize,t.width,1.2*this.fontSize)},gText.prototype.toSVG=function(){var t="<text";t+=' x="'+this.x+'"',t+=' y="'+this.y+'"',t+=' font-family="'+this.fontFamily+'"',t+=' font-size="'+this.fontSize+'"';var e;return"left"===this.textAlign?e="start":"center"===this.textAlign?e="middle":"right"===this.textAlign&&(e="end"),t+=' text-anchor="'+e+'"',"black"!==this.fill&&(t+=' fill="'+Color.toCSS(this.fill)+'"'),t+=">",t+=this.text,t+="</text>"},module.exports=gText;


},{"../objects/color":28,"../objects/rect":33,"../objects/transform":35}],35:[function(require,module,exports){
"use strict";var _=require("lodash"),bezier=require("../util/bezier"),math=require("../util/math"),Group=require("../objects/group"),Path=require("../objects/path"),Point=require("../objects/point"),MOVETO=bezier.MOVETO,LINETO=bezier.LINETO,QUADTO=bezier.QUADTO,CURVETO=bezier.CURVETO,CLOSE=bezier.CLOSE,Transform=function(r){void 0!==r?this.m=r:this.m=[1,0,0,0,1,0,0,0,1]};Transform.IDENTITY=new Transform,Transform.identity=function(){return new Transform},Transform._mmult=function(r,t){return void 0!==r.m&&(r=r.m),void 0!==t.m&&(t=t.m),new Transform([r[0]*t[0]+r[1]*t[3],r[0]*t[1]+r[1]*t[4],0,r[3]*t[0]+r[4]*t[3],r[3]*t[1]+r[4]*t[4],0,r[6]*t[0]+r[7]*t[3]+t[6],r[6]*t[1]+r[7]*t[4]+t[7],1])},Transform.prototype.isIdentity=function(){var r=this.m;return 1===r[0]&&0===r[1]&&0===r[2]&&0===r[3]&&1===r[4]&&0===r[5]&&0===r[6]&&0===r[7]&&1===r[8]},Transform.prototype.prepend=function(r){return Transform._mmult(this.m,r.m)},Transform.prototype.append=function(r){return Transform._mmult(r.m,this.m)},Transform.prototype.inverse=function(){var r=this.m,t=r[0]*r[4]-r[1]*r[3];return new Transform([r[4]/t,-r[1]/t,0,-r[3]/t,r[0]/t,0,(r[3]*r[7]-r[4]*r[6])/t,-(r[0]*r[7]-r[1]*r[6])/t,1])},Transform.prototype.scale=function(r,t){return void 0===t&&(t=r),Transform._mmult([r,0,0,0,t,0,0,0,1],this.m)},Transform.prototype.translate=function(r,t){return Transform._mmult([1,0,0,0,1,0,r,t,1],this.m)},Transform.prototype.rotate=function(r){var t=Math.cos(math.radians(r)),n=Math.sin(math.radians(r));return Transform._mmult([t,n,0,-n,t,0,0,0,1],this.m)},Transform.prototype.skew=function(r,t){var n=Math.PI*r/180,o=Math.PI*t/180;return Transform._mmult([1,Math.tan(o),0,-Math.tan(n),1,0,0,0,1],this.m)},Transform.prototype.transformPoint=function(r){var t=r.x,n=r.y,o=this.m;return new Point(t*o[0]+n*o[3]+o[6],t*o[1]+n*o[4]+o[7])},Transform.prototype.transformPoints=function(r){var t=this;return _.map(r,function(r){return t.transformPoint(r)})},Transform.prototype.transformPath=function(r){var t,n,o,e=this,s=_.map(r.commands,function(r){if(r.type===MOVETO)return t=e.transformPoint({x:r.x,y:r.y}),{type:MOVETO,x:t.x,y:t.y};if(r.type===LINETO)return t=e.transformPoint({x:r.x,y:r.y}),{type:LINETO,x:t.x,y:t.y};if(r.type===QUADTO)return t=e.transformPoint({x:r.x,y:r.y}),n=e.transformPoint({x:r.x1,y:r.y1}),{type:QUADTO,x1:n.x,y1:n.y,x:t.x,y:t.y};if(r.type===CURVETO)return t=e.transformPoint({x:r.x,y:r.y}),n=e.transformPoint({x:r.x1,y:r.y1}),o=e.transformPoint({x:r.x2,y:r.y2}),{type:CURVETO,x1:n.x,y1:n.y,x2:o.x,y2:o.y,x:t.x,y:t.y};if(r.type===CLOSE)return r;throw new Error("Unknown command type "+r)});return new Path(s,r.fill,r.stroke,r.strokeWidth)},Transform.prototype.transformText=function(r){var t=r.clone();return t.transform=this.append(t.transform),t},Transform.prototype.transformGroup=function(r){var t=this,n=_.map(r.shapes,function(r){return t.transformShape(r)});return new Group(n)},Transform.prototype.transformShape=function(r){var t;if(r.shapes)t=this.transformGroup;else if(r.commands)t=this.transformPath;else if(r.text)t=this.transformText;else if(void 0!==r.x&&void 0!==r.y)t=this.transformPoint;else{if(void 0!==r._transform)return r._transform(this.m);if(!(Array.isArray(r)&&r.length>0))throw new Error("Don't know how to transform "+r);if(void 0===r[0].x||void 0===r[0].y){for(var n=[],o=0;o<r.length;o+=1)n.push(this.transformShape(r[o]));return n}t=this.transformPoints}return t.call(this,r)},module.exports=Transform;


},{"../objects/group":29,"../objects/path":31,"../objects/point":32,"../util/bezier":38,"../util/math":42,"lodash":4}],36:[function(require,module,exports){
"use strict";var Point=require("../objects/point"),Transform=require("../objects/transform"),Transformable={translate:function(r){r||(r=Point.ZERO);var t=(new Transform).translate(r.x,r.y);return t.transformShape(this)},scale:function(r,t){t||(t=Point.ZERO);var a,n;"number"==typeof r?(a=r,n=r):(a=r.x,n=r.y);var e=new Transform;return e=e.translate(t.x,t.y),e=e.scale(a,n),e=e.translate(-t.x,-t.y),e.transformShape(this)},rotate:function(r,t){t||(t=Point.ZERO);var a=new Transform;return a=a.translate(t.x,t.y),a=a.rotate(r),a=a.translate(-t.x,-t.y),a.transformShape(this)},skew:function(r,t){t||(t=Point.ZERO);var a=new Transform;return a=a.translate(t.x,t.y),a=a.skew(r.x,r.y),a=a.translate(-t.x,-t.y),a.transformShape(this)}};module.exports=Transformable;


},{"../objects/point":32,"../objects/transform":35}],37:[function(require,module,exports){
"use strict";var Vec3=function(t,i,e){this.x=void 0===t?0:t,this.y=void 0===i?0:i,this.z=void 0===e?0:e};Vec3.ZERO=new Vec3(0,0,0),Vec3.up=function(){return new Vec3(0,1,0)},Vec3.dot=function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},Vec3.cross=function(t,i){return new Vec3(t.y*i.z-t.z*i.y,t.z*i.x-t.x*i.z,t.x*i.y-t.y*i.x)},Vec3.prototype.toString=function(){return"["+this.x+", "+this.y+", "+this.z+"]"},Vec3.prototype.toArray=function(){var t=[];return t.push(this.x),t.push(this.y),t.push(this.z),t},Vec3.prototype.getLength=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Vec3.prototype.normalize=function(){var t,i;return t=this.getLength(),0===t?this:(i=1/t,new Vec3(this.x*i,this.y*i,this.z*i))},Vec3.prototype.add=function(t){return new Vec3(this.x+t.x,this.y+t.y,this.z+t.z)},Vec3.prototype.subtract=function(t){return new Vec3(this.x-t.x,this.y-t.y,this.z-t.z)},Vec3.prototype.transform=function(t){var i,e,s,h,n;return n=t,i=this.x*n.m[0]+this.y*n.m[4]+this.z*n.m[8]+n.m[12],e=this.x*n.m[1]+this.y*n.m[5]+this.z*n.m[9]+n.m[13],s=this.x*n.m[2]+this.y*n.m[6]+this.z*n.m[10]+n.m[14],h=this.x*n.m[3]+this.y*n.m[7]+this.z*n.m[11]+n.m[15],new Vec3(i/h,e/h,s/h)},module.exports=Vec3;


},{}],38:[function(require,module,exports){
"use strict";var _=require("lodash"),math=require("../util/math"),Point=require("../objects/point"),Rect=require("../objects/rect"),bezier={},MOVETO=bezier.MOVETO="M",LINETO=bezier.LINETO="L";bezier.QUADTO="Q";var CURVETO=bezier.CURVETO="C",CLOSE=bezier.CLOSE="Z";bezier.linePoint=function(e,t,r,n,i){var a=t+e*(n-t),o=r+e*(i-r);return{type:LINETO,x:a,y:o}},bezier.lineLength=function(e,t,r,n){var i=Math.pow(Math.abs(e-r),2),a=Math.pow(Math.abs(t-n),2);return Math.sqrt(i+a)},bezier.curvePoint=function(e,t,r,n,i,a,o,u,h){var s=1-e,b=t*s+n*e,c=r*s+i*e,y=n*s+a*e,m=i*s+o*e,x=a*s+u*e,z=o*s+h*e,O=b*s+y*e,v=c*s+m*e,p=y*s+x*e,M=m*s+z*e,E=O*s+p*e,L=v*s+M*e;return{type:CURVETO,x1:O,y1:v,x2:p,y2:M,x:E,y:L}},bezier.curveLength=function(e,t,r,n,i,a,o,u,h){void 0===h&&(h=20);var s,b,c,y=0,m=e,x=t;for(s=0;h>s;s+=1)b=(s+1)/h,c=bezier.curvePoint(b,e,t,r,n,i,a,o,u),y+=Math.sqrt(Math.pow(Math.abs(m-c.x),2)+Math.pow(Math.abs(x-c.y),2)),m=c.x,x=c.y;return y},bezier.segmentLengths=function(e,t,r){t=void 0!==t?t:!1,void 0===r&&(r=20);var n,i,a,o,u,h,s,b,c;for(c=[],n=0;n<e.length;n+=1)i=e[n],a=i.type,0===n?(o=i.x,u=i.y):a===MOVETO?(o=i.x,u=i.y,c.push(0)):a===CLOSE?c.push(bezier.lineLength(h,s,o,u)):a===LINETO?c.push(bezier.lineLength(h,s,i.x,i.y)):a===CURVETO&&c.push(bezier.curveLength(h,s,i.x1,i.y1,i.x2,i.y2,i.x,i.y,r)),a!==CLOSE&&(h=i.x,s=i.y);return t===!0?(b=math.sum(c),b>0?_.map(c,function(e){return e/b}):_.map(c,function(){return 0})):c},bezier.length=function(e,t){return t=t||20,math.sum(bezier.segmentLengths(e.commands,!1,t))},bezier._locate=function(e,t,r){var n,i,a;for(void 0===r&&(r=bezier.segmentLengths(e.commands,!0)),n=0;n<e.commands.length&&(i=e.commands[n],(0===n||i.type===MOVETO)&&(a=new Point(i.x,i.y)),!(t<=r[n]||n===r.length-1));n+=1)t-=r[n];return 0!==r[n]&&(t/=r[n]),n===r.length-1&&0===r[n]&&(n-=1),[n,t,a]},bezier.point=function(e,t,r){var n,i,a,o,u,h;return n=bezier._locate(e,t,r),i=n[0],t=n[1],a=n[2],o=e.commands[i].x,u=e.commands[i].y,h=e.commands[i+1],h.type===LINETO||h.type===CLOSE?h=h.type===CLOSE?bezier.linePoint(t,o,u,a.x,a.y):bezier.linePoint(t,o,u,h.x,h.y):h.type===CURVETO&&(h=bezier.curvePoint(t,o,u,h.x1,h.y1,h.x2,h.y2,h.x,h.y)),h},bezier.extrema=function(e,t,r,n,i,a,o,u){function h(e,t){return Math.abs(e-t)<=1e-12*Math.min(Math.abs(e),Math.abs(t))}function s(e){var t,r,n,i,a;return t=1-e,n=t*t,i=e*e,a=i*e,r=n*t,n*=3*e,i*=3*t,[r,n,i,a]}function b(h){var b,c,y,m,x;return x=s(h),b=x[0],c=x[1],y=x[2],m=x[3],{x:b*e+c*r+y*i+m*o,y:b*t+c*n+y*a+m*u}}function c(e){if(e>=0&&1>=e){var t=b(e);t.x<y?y=t.x:t.x>m&&(m=t.x),t.y<x?x=t.y:t.y>z&&(z=t.y)}}var y,m,x,z,O,v,p,M,E,L,f,g,l,T;return o>e?(y=e,m=o):(y=o,m=e),u>t?(x=t,z=u):(x=u,z=t),O=3*(-e+3*r-3*i+o),v=6*(e-2*r+i),p=3*(-e+r),h(O+1,1)?h(v+1,1)||c(-p/v):(l=v*v-4*O*p,l>=0&&(f=Math.sqrt(l),g=1/(2*O),c((-v+f)*g),c((-v-f)*g))),M=3*(-t+3*n-3*a+u),E=6*(t-2*n+a),L=3*(-t+n),h(M+1,1)?h(E+1,1)||c(-L/E):(T=E*E-4*M*L,T>0&&(f=Math.sqrt(T),g=1/(2*M),c((-E+f)*g),c((-E-f)*g))),new Rect(y,x,m-y,z-x)},module.exports=bezier;


},{"../objects/point":32,"../objects/rect":33,"../util/math":42,"lodash":4}],39:[function(require,module,exports){
"use strict";function toHex(e){var r;return 0===e?"00":(r=e.toString(16).toUpperCase(),r.length<2&&(r="0"+r),r)}var color={};color.namedColors={lightpink:[1,.71,.76],pink:[1,.75,.8],crimson:[.86,.08,.24],lavenderblush:[1,.94,.96],palevioletred:[.86,.44,.58],hotpink:[1,.41,.71],deeppink:[1,.08,.58],mediumvioletred:[.78,.08,.52],orchid:[.85,.44,.84],thistle:[.85,.75,.85],plum:[.87,.63,.87],violet:[.93,.51,.93],fuchsia:[1,0,1],darkmagenta:[.55,0,.55],purple:[.5,0,.5],mediumorchid:[.73,.33,.83],darkviolet:[.58,0,.83],darkorchid:[.6,.2,.8],indigo:[.29,0,.51],blueviolet:[.54,.17,.89],mediumpurple:[.58,.44,.86],mediumslateblue:[.48,.41,.93],slateblue:[.42,.35,.8],darkslateblue:[.28,.24,.55],ghostwhite:[.97,.97,1],lavender:[.9,.9,.98],blue:[0,0,1],mediumblue:[0,0,.8],darkblue:[0,0,.55],navy:[0,0,.5],midnightblue:[.1,.1,.44],royalblue:[.25,.41,.88],cornflowerblue:[.39,.58,.93],lightsteelblue:[.69,.77,.87],lightslategray:[.47,.53,.6],slategray:[.44,.5,.56],dodgerblue:[.12,.56,1],aliceblue:[.94,.97,1],steelblue:[.27,.51,.71],lightskyblue:[.53,.81,.98],skyblue:[.53,.81,.92],deepskyblue:[0,.75,1],lightblue:[.68,.85,.9],powderblue:[.69,.88,.9],cadetblue:[.37,.62,.63],darkturquoise:[0,.81,.82],azure:[.94,1,1],lightcyan:[.88,1,1],paleturquoise:[.69,.93,.93],aqua:[0,1,1],darkcyan:[0,.55,.55],teal:[0,.5,.5],darkslategray:[.18,.31,.31],mediumturquoise:[.28,.82,.8],lightseagreen:[.13,.7,.67],turquoise:[.25,.88,.82],aquamarine:[.5,1,.83],mediumaquamarine:[.4,.8,.67],mediumspringgreen:[0,.98,.6],mintcream:[.96,1,.98],springgreen:[0,1,.5],mediumseagreen:[.24,.7,.44],seagreen:[.18,.55,.34],honeydew:[.94,1,.94],darkseagreen:[.56,.74,.56],palegreen:[.6,.98,.6],lightgreen:[.56,.93,.56],limegreen:[.2,.8,.2],lime:[0,1,0],forestgreen:[.13,.55,.13],green:[0,.5,0],darkgreen:[0,.39,0],lawngreen:[.49,.99,0],chartreuse:[.5,1,0],greenyellow:[.68,1,.18],darkolivegreen:[.33,.42,.18],yellowgreen:[.6,.8,.2],olivedrab:[.42,.56,.14],ivory:[1,1,.94],beige:[.96,.96,.86],lightyellow:[1,1,.88],lightgoldenrodyellow:[.98,.98,.82],yellow:[1,1,0],olive:[.5,.5,0],darkkhaki:[.74,.72,.42],palegoldenrod:[.93,.91,.67],lemonchiffon:[1,.98,.8],khaki:[.94,.9,.55],gold:[1,.84,0],cornsilk:[1,.97,.86],goldenrod:[.85,.65,.13],darkgoldenrod:[.72,.53,.04],floralwhite:[1,.98,.94],oldlace:[.99,.96,.9],wheat:[.96,.87,.07],orange:[1,.65,0],moccasin:[1,.89,.71],papayawhip:[1,.94,.84],blanchedalmond:[1,.92,.8],navajowhite:[1,.87,.68],antiquewhite:[.98,.92,.84],tan:[.82,.71,.55],burlywood:[.87,.72,.53],darkorange:[1,.55,0],bisque:[1,.89,.77],linen:[.98,.94,.9],peru:[.8,.52,.25],peachpuff:[1,.85,.73],sandybrown:[.96,.64,.38],chocolate:[.82,.41,.12],saddlebrown:[.55,.27,.07],seashell:[1,.96,.93],sienna:[.63,.32,.18],lightsalmon:[1,.63,.48],coral:[1,.5,.31],orangered:[1,.27,0],darksalmon:[.91,.59,.48],tomato:[1,.39,.28],salmon:[.98,.5,.45],mistyrose:[1,.89,.88],lightcoral:[.94,.5,.5],snow:[1,.98,.98],rosybrown:[.74,.56,.56],indianred:[.8,.36,.36],red:[1,0,0],brown:[.65,.16,.16],firebrick:[.7,.13,.13],darkred:[.55,0,0],maroon:[.5,0,0],white:[1,1,1],whitesmoke:[.96,.96,.96],gainsboro:[.86,.86,.86],lightgrey:[.83,.83,.83],silver:[.75,.75,.75],darkgray:[.66,.66,.66],gray:[.5,.5,.5],grey:[.5,.5,.5],dimgray:[.41,.41,.41],dimgrey:[.41,.41,.41],black:[0,0,0],cyan:[0,.68,.94],transparent:[0,0,0,0],bark:[.25,.19,.13]},color.rgb2hex=function(e,r,a){return"#"+toHex(Math.round(255*e))+toHex(Math.round(255*r))+toHex(Math.round(255*a))},color.rgba2hex=function(e,r,a,o){return"#"+toHex(Math.round(255*e))+toHex(Math.round(255*r))+toHex(Math.round(255*a))+toHex(Math.round(255*o))},color.hex2rgb=function(e){var r,a,o,l;return e=e.replace(/^#/,""),e.length<6&&(r=[],r.length=6-e.length,e+=r.join(e.substr(e.length-1))),a=parseInt(e.substr(0,2),16)/255,o=parseInt(e.substr(2,2),16)/255,l=parseInt(e.substr(4,2),16)/255,[a,o,l]},color.rgb2hsb=function(e,r,a){var o=0,l=0,n=Math.max(e,r,a),t=n-Math.min(e,r,a);return 0!==n&&(l=t/n),0!==l&&(o=e===n?0+(r-a)/t:r===n?2+(a-e)/t:4+(e-r)/t),o*=60/360,0>o&&(o+=1),[o,l,n]},color.hsb2rgb=function(e,r,a){if(0===r)return[a,a,a];e=e%1*6;var o=Math.floor(e),l=e-o,n=a*(1-r),t=a*(1-r*l),i=a*(1-r*(1-l));return o>4?[a,n,t]:[[a,i,n],[t,a,n],[n,a,i],[n,t,a],[i,n,a]][parseInt(o,10)]},color.rgb2hsl=function(e,r,a){var o,l,n,t=Math.min(e,r,a),i=Math.max(e,r,a),u=i-t;return i===t?o=0:e===i?o=(r-a)/u:r===i?o=2+(a-e)/u:a===i&&(o=4+(e-r)/u),o=Math.min(60*o,360),0>o&&(o+=360),n=(t+i)/2,l=i===t?0:.5>=n?u/(i+t):u/(2-i-t),[o/360,l,n]},color.hsl2rgb=function(e,r,a){var o,l,n,t,i;if(0===r)return i=a,[i,i,i];l=.5>a?a*(1+r):a+r-a*r,o=2*a-l,t=[0,0,0];for(var u=0;3>u;u++)n=e+1/3*-(u-1),0>n&&(n+=1),n>1&&(n-=1),i=1>6*n?o+6*(l-o)*n:1>2*n?l:2>3*n?o+(l-o)*(2/3-n)*6:o,t[u]=i;return t},module.exports=color;


},{}],40:[function(require,module,exports){
"use strict";var math=require("../util/math"),Point=require("../objects/point"),geo={};geo.angle=function(t,n,e,o){return math.degrees(Math.atan2(o-n,e-t))},geo.distance=function(t,n,e,o){return Math.sqrt(Math.pow(e-t,2)+Math.pow(o-n,2))},geo.coordinates=function(t,n,e,o){var a=t+Math.cos(math.radians(e))*o,r=n+Math.sin(math.radians(e))*o;return new Point(a,r)},geo.pointInPolygon=function(t,n,e){var o,a,r,i,u,h,s=!1,g=t.length;for(o=0;g>o;o+=1)a=g-1>o?o+1:0,r=t[o].x,i=t[o].y,u=t[a].x,h=t[a].y,(e>i&&h>=e||e>h&&i>=e)&&n>r+(e-i)/(h-i)*(u-r)&&(s=!s);return s},module.exports=geo;


},{"../objects/point":32,"../util/math":42}],41:[function(require,module,exports){
"use strict";exports.defineAlias=function(t,e,n){Object.defineProperty(t.prototype,n,{get:function(){return this[e]},set:function(t){this[e]=t}})},exports.defineGetter=function(t,e,n){Object.defineProperty(t.prototype,e,{get:n})};


},{}],42:[function(require,module,exports){
"use strict";function _fade(r){return r*r*r*(r*(6*r-15)+10)}function _grad(r,t,n,a){var e,o,u;return e=15&r,o=8>e?t:n,u=4>e?n:12===e||14===e?t:a,(0===(1&e)?o:-o)+(0===(2&e)?u:-u)}function _scale(r){return(1+r)/2}var math={};math.sum=function(r){var t,n=r.length,a=0;for(t=0;n>t;t+=1)a+=r[t];return a},math.round=function(r,t){return t?Math.round(r*Math.pow(10,t))/Math.pow(10,t):Math.round(r)},math.sign=function(r){return 0>r?-1:r>0?1:0},math.degrees=function(r){return 180*r/Math.PI},math.radians=function(r){return r/180*Math.PI},math.clamp=function(r,t,n){return n>t?t>r?t:r>n?n:r:n>r?n:r>t?t:r},math.snap=function(r,t,n){return n=void 0!==n?n:1,r*(1-n)+n*Math.round(r/t)*t},math.dot=function(r,t){var n,a=Math.min(r.length,t.length),e=0;for(n=0;a>n;n+=1)e+=r[n]*t[n];return e};var _lerp=math.mix=math.lerp=function(r,t,n,a){if(a){if(0>n)return r;if(n>1)return t}return r+(t-r)*n},_permutation=function(){var r,t,n;for(r=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],t=new Uint8Array(512),n=0;256>n;n+=1)t[256+n]=t[n]=r[n];return t}();math.noise=function(r,t,n){var a=_permutation,e=255&Math.floor(r),o=255&Math.floor(t),u=255&Math.floor(n);r-=Math.floor(r),t-=Math.floor(t),n-=Math.floor(n);var f=_fade(r),h=_fade(t),i=_fade(n),_=a[e]+o,d=a[_]+u,l=a[_+1]+u,m=a[e+1]+o,c=a[m]+u,p=a[m+1]+u;return _scale(_lerp(_lerp(_lerp(_grad(a[d],r,t,n),_grad(a[c],r-1,t,n),f),_lerp(_grad(a[l],r,t-1,n),_grad(a[p],r-1,t-1,n),f),h),_lerp(_lerp(_grad(a[d+1],r,t,n-1),_grad(a[c+1],r-1,t,n-1),f),_lerp(_grad(a[l+1],r,t-1,n-1),_grad(a[p+1],r-1,t-1,n-1),f),h),i))},module.exports=math;


},{}],43:[function(require,module,exports){
"use strict";function generator(r){if(0>r){for(var e=generator(Math.abs(r)),t=0;23>t;t+=1)e();return generator(e(0,1e4))}return function(e,t){e=e||0,t=t||1,r=(9301*r+49297)%233280;var n=r/233280;return e+n*(t-e)}}exports.generator=generator;


},{}],44:[function(require,module,exports){
"use strict";var _=require("lodash"),xmldom=require("xmldom"),Color=require("../objects/color"),Group=require("../objects/group"),Path=require("../objects/path"),Point=require("../objects/point"),Transform=require("../objects/transform"),trim=function(t){return t.replace(/^\s+|\s+$/g,"")},compressSpaces=function(t){return t.replace(/[\s\r\t\n]+/gm," ")},toNumberArray=function(t){var e,r=trim(compressSpaces((t||"").replace(/,/g," "))).split(" ");for(e=0;e<r.length;e+=1)r[e]=parseFloat(r[e]);return r},readSvgAttributes=function(t,e){var r,a,o,n,i,s,c,l,u,d,m,p;if(p=e?Object.create(e):{},l=[],u={},u.translate=function(t){var e=toNumberArray(t),r=e[0],a=e[1]||0;return(new Transform).translate(r,a)},u.scale=function(t){var e=toNumberArray(t),r=e[0],a=e[1]||r;return(new Transform).scale(r,a)},u.rotate=function(t){var e,r=toNumberArray(t),a=r[0],o=r[1]||0,n=r[2]||0;return e=new Transform,e=e.translate(o,n),e=e.rotate(a),e=e.translate(-o,-n)},u.matrix=function(t){var e=toNumberArray(t);return new Transform([e[0],e[1],0,e[2],e[3],0,e[4],e[5],1])},_.each(t.attributes,function(t){var e,p,v,h,g;switch(e=t.nodeName){case"transform":for(p=trim(compressSpaces(t.nodeValue)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),m=0;m<p.length;m+=1)v=trim(p[m].split("(")[0]),h=p[m].split("(")[1].replace(")",""),d=u[v](h),l.push(d);break;case"visibility":break;case"stroke-linecap":break;case"stroke-linejoin":break;case"stroke-miterlimit":break;case"stroke-width":i=parseFloat(t.nodeValue);break;case"stroke-opacity":n=parseFloat(t.nodeValue);break;case"fill-opacity":a=parseFloat(t.nodeValue);break;case"fill":r=t.nodeValue;break;case"stroke":o=t.nodeValue;break;case"opacity":s=parseFloat(t.nodeValue);break;case"color":c=t.nodeValue;break;case"style":g={},_.each(t.nodeValue.split(";"),function(t){var e=t.split(":");g[e[0].trim()]=e[1]}),g.fill&&(r=g.fill),g.stroke&&(o=g.stroke),void 0!==g["stroke-width"]&&(i=parseFloat(g["stroke-width"])),void 0!==g["stroke-opacity"]&&(n=parseFloat(g["stroke-opacity"])),void 0!==g["fill-opacity"]&&(a=parseFloat(g["fill-opacity"])),void 0!==g.opacity&&(s=parseFloat(g.opacity)),g.color&&(c=g.color)}}),void 0!==r&&(p.fill=r),void 0!==o&&(p.stroke=o),void 0!==a&&(p.fillOpacity=a),void 0!==n&&(p.strokeOpacity=n),void 0!==i&&(p.strokeWidth=i),void 0!==s&&(p.opacity=s),void 0!==c&&"currentColor"!==c&&(p.color=c),l.length>0){for(d=new Transform,m=0;m<l.length;m+=1)d=d.append(l[m]);d.isIdentity()||(p.transform?p.transform=p.transform.append(d):p.transform=d)}return p},applySvgAttributes=function(t,e){var r=e.fill;t.commands&&t.commands.length>0&&void 0===r&&(r="black");var a=e.fillOpacity,o=e.stroke,n=e.strokeOpacity,i=e.opacity,s=e.strokeWidth,c=e.transform,l=e.color;"currentColor"===r&&(r=void 0===l?"black":l),void 0!==r&&(r=Color.parse(r),void 0!==a&&(r.a*=a),void 0!==i&&(r.a*=i)),"currentColor"===o&&(o=void 0===l?"black":l),void 0!==o&&(o=Color.parse(o),void 0!==n&&(o.a*=n),void 0!==i&&(o.a*=i));var u;u=c?c.transformShape(t).commands:t.commands;var d=void 0===r?t.fill:r,m=void 0===o?t.stroke:o,p=void 0===s?t.strokeWidth:s;return void 0!==p&&void 0!==c&&(p*=c.m[0]),new Path(u,d,m,p)},arcToSegments=function(t,e,r,a,o,n,i,s,c){var l,u,d,m,p,v,h,g,f,b,y,A,C,k,x,S,P,w,M,T,F,E,q,$,O,V,L;for(l=i*(Math.PI/180),u=Math.sin(l),d=Math.cos(l),r=Math.abs(r),a=Math.abs(a),m=d*(s-t)*.5+u*(c-e)*.5,p=d*(c-e)*.5-u*(s-t)*.5,v=m*m/(r*r)+p*p/(a*a),v>1&&(v=Math.sqrt(v),r*=v,a*=v),h=d/r,g=u/r,f=-u/a,b=d/a,y=h*s+g*c,A=f*s+b*c,C=h*t+g*e,k=f*t+b*e,x=(C-y)*(C-y)+(k-A)*(k-A),S=1/x-.25,0>S&&(S=0),P=Math.sqrt(S),n===o&&(P=-P),w=.5*(y+C)-P*(k-A),M=.5*(A+k)+P*(C-y),T=Math.atan2(A-M,y-w),F=Math.atan2(k-M,C-w),E=F-T,0>E&&1===n?E+=2*Math.PI:E>0&&0===n&&(E-=2*Math.PI),q=Math.ceil(Math.abs(E/(.5*Math.PI+.001))),$=[],L=0;q>L;L+=1)O=T+L*E/q,V=T+(L+1)*E/q,$[L]=[w,M,O,V,r,a,u,d];return $},segmentToBezier=function(t,e,r,a,o,n,i,s){var c=s*o,l=-i*n,u=i*o,d=s*n,m=.5*(a-r),p=8/3*Math.sin(.5*m)*Math.sin(.5*m)/Math.sin(m),v=t+Math.cos(r)-p*Math.sin(r),h=e+Math.sin(r)+p*Math.cos(r),g=t+Math.cos(a),f=e+Math.sin(a),b=g+p*Math.sin(a),y=f-p*Math.cos(a);return[c*v+l*h,u*v+d*h,c*b+l*y,u*b+d*y,c*g+l*f,u*g+d*f]},read={svg:function(){return read.g.apply(this,arguments)},g:function(t,e){var r=[],a=readSvgAttributes(t,e);return _.each(t.childNodes,function(t){var e,o,n;e=t.nodeName,e&&(o=e.replace(/svg\:/gi,"").toLowerCase(),void 0!==read[o]&&(n=read[o].call(this,t,a),r.push(n)))}),new Group(r)},_polyline:function(t){var e=t.getAttribute("points"),r=new Path;return e.replace(/([\d\.?]+),([\d\.?]+)/g,function(t,e,a){var o=parseFloat(e),n=parseFloat(a);0===r.commands.length?r.moveTo(o,n):r.lineTo(o,n)}),r},polygon:function(t,e){var r=readSvgAttributes(t,e),a=read._polyline(t);return a.close(),applySvgAttributes(a,r)},polyline:function(t,e){var r=readSvgAttributes(t,e),a=read._polyline(t);return applySvgAttributes(a,r)},rect:function(t,e){var r=readSvgAttributes(t,e),a=parseFloat(t.getAttribute("x")),o=parseFloat(t.getAttribute("y"));a||(a=0),o||(o=0);var n=parseFloat(t.getAttribute("width")),i=parseFloat(t.getAttribute("height"));n||(n=0),i||(i=0),0>n&&(console.error('Error: invalid negative value for <rect> attribute width="'+n+'"'),n=0),0>i&&(console.error('Error: invalid negative value for <rect> attribute height="'+i+'"'),i=0);var s=parseFloat(t.getAttribute("rx")),c=parseFloat(t.getAttribute("ry"));s||(s=0),c||(c=0),0>s&&(console.error('Error: invalid negative value for <rect> attribute rx="'+s+'"'),s=0),0>c&&(console.error('Error: invalid negative value for <rect> attribute ry="'+c+'"'),c=0),s&&c||(s=c=Math.max(s,c)),s>n/2&&(s=n/2),c>i/2&&(c=i/2);var l=new Path;return s&&c?l.addRoundedRect(a,o,n,i,s,c):l.addRect(a,o,n,i),applySvgAttributes(l,r)},ellipse:function(t,e){var r=readSvgAttributes(t,e),a=parseFloat(t.getAttribute("cx")),o=parseFloat(t.getAttribute("cy"));a||(a=0),o||(o=0);var n=parseFloat(t.getAttribute("rx")),i=parseFloat(t.getAttribute("ry"));n||(n=0),i||(i=0),0>n&&(console.error('Error: invalid negative value for <ellipse> attribute rx="'+n+'"'),n=0),0>i&&(console.error('Error: invalid negative value for <ellipse> attribute ry="'+i+'"'),i=0);var s=new Path;return s.addEllipse(a-n,o-i,2*n,2*i),applySvgAttributes(s,r)},circle:function(t,e){var r=readSvgAttributes(t,e),a=parseFloat(t.getAttribute("cx")),o=parseFloat(t.getAttribute("cy"));a||(a=0),o||(o=0);var n=parseFloat(t.getAttribute("r"));n||(n=0),0>n&&(console.error('Error: invalid negative value for <circle> attribute r="'+n+'"'),n=0);var i=new Path;return i.addEllipse(a-n,o-n,2*n,2*n),applySvgAttributes(i,r)},line:function(t,e){var r=readSvgAttributes(t,e),a=parseFloat(t.getAttribute("x1")),o=parseFloat(t.getAttribute("y1")),n=parseFloat(t.getAttribute("x2")),i=parseFloat(t.getAttribute("y2"));a||(a=0),o||(o=0),n||(n=0),i||(i=0);var s=new Path;return s.addLine(a,o,n,i),applySvgAttributes(s,r)},path:function(t,e){var r,a,o,n,i,s,c,l,u,d,m,p,v,h,g,f,b,y,A,C,k,x,S,P=readSvgAttributes(t,e);r=t.getAttribute("d"),r=r.replace(/,/gm," "),r=r.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),r=r.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),r=r.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),r=r.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),r=r.replace(/([0-9])([+\-])/gm,"$1 $2"),r=r.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),r=r.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),r=compressSpaces(r),r=trim(r),a=function(t){this.tokens=t.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new Point(0,0),this.control=new Point(0,0),this.current=new Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!==this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i+=1,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var t=new Point(this.getScalar(),this.getScalar());return this.makeAbsolute(t)},this.getAsControlPoint=function(){var t=this.getPoint();return this.control=t,t},this.getAsCurrentPoint=function(){var t=this.getPoint();return this.current=t,t},this.getReflectedControlPoint=function(){if("c"!==this.previousCommand.toLowerCase()&&"s"!==this.previousCommand.toLowerCase()&&"q"!==this.previousCommand.toLowerCase()&&"t"!==this.previousCommand.toLowerCase())return this.current;var t=new Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return t},this.makeAbsolute=function(t){return this.isRelativeCommand()?new Point(t.x+this.current.x,t.y+this.current.y):t}};var w=new Path;for(o=new a(r),o.reset();!o.isEnd();)switch(o.nextCommand(),o.command){case"M":case"m":for(n=o.getAsCurrentPoint(),w.moveTo(n.x,n.y),o.start=o.current;!o.isCommandOrEnd();)n=o.getAsCurrentPoint(),w.lineTo(n.x,n.y);break;case"L":case"l":for(;!o.isCommandOrEnd();)n=o.getAsCurrentPoint(),w.lineTo(n.x,n.y);break;case"H":case"h":for(;!o.isCommandOrEnd();)i=new Point((o.isRelativeCommand()?o.current.x:0)+o.getScalar(),o.current.y),o.current=i,w.lineTo(o.current.x,o.current.y);break;case"V":case"v":for(;!o.isCommandOrEnd();)i=new Point(o.current.x,(o.isRelativeCommand()?o.current.y:0)+o.getScalar()),o.current=i,w.lineTo(o.current.x,o.current.y);break;case"C":case"c":for(;!o.isCommandOrEnd();)s=o.current,c=o.getPoint(),l=o.getAsControlPoint(),u=o.getAsCurrentPoint(),w.curveTo(c.x,c.y,l.x,l.y,u.x,u.y);break;case"S":case"s":for(;!o.isCommandOrEnd();)s=o.current,c=o.getReflectedControlPoint(),l=o.getAsControlPoint(),u=o.getAsCurrentPoint(),w.curveTo(c.x,c.y,l.x,l.y,u.x,u.y);break;case"Q":case"q":for(;!o.isCommandOrEnd();)s=o.current,l=o.getAsControlPoint(),u=o.getAsCurrentPoint(),d=s.x+2/3*(l.x-s.x),m=s.y+2/3*(l.y-s.y),p=d+1/3*(u.x-s.x),v=m+1/3*(u.y-s.y),w.curveTo(d,m,p,v,u.x,u.y);break;case"T":case"t":for(;!o.isCommandOrEnd();)s=o.current,l=o.getReflectedControlPoint(),o.control=l,u=o.getAsCurrentPoint(),d=s.x+2/3*(l.x-s.x),m=s.y+2/3*(l.y-s.y),p=d+1/3*(u.x-s.x),v=m+1/3*(u.y-s.y),w.curveTo(d,m,p,v,u.x,u.y);break;case"A":case"a":for(;!o.isCommandOrEnd();)for(s=o.current,h=o.getScalar(),g=o.getScalar(),f=o.getScalar(),b=o.getScalar(),y=o.getScalar(),u=o.getAsCurrentPoint(),A=u.x,C=u.y,k=arcToSegments(A,C,h,g,b,y,f,s.x,s.y),x=0;x<k.length;x+=1)S=segmentToBezier.apply(this,k[x]),w.curveTo.apply(w,S);break;case"Z":case"z":w.close(),o.current=o.start}return applySvgAttributes(w,P)}};exports.interpret=function(t){var e,r=t.tagName.toLowerCase();return void 0===read[r]?null:e=read[r].call(this,t)},exports.parseString=function(t){var e=(new xmldom.DOMParser).parseFromString(t);return e?exports.interpret(e.documentElement):void 0};


},{"../objects/color":28,"../objects/group":29,"../objects/path":31,"../objects/point":32,"../objects/transform":35,"lodash":4,"xmldom":6}],45:[function(require,module,exports){
"use strict";function importCommands(e){for(var r in e)vg[r]=e[r]}var _=require("lodash"),vg={};vg.bezier=require("./util/bezier"),vg.color=require("./util/color"),vg.geo=require("./util/geo"),vg.math=require("./util/math"),vg.random=require("./util/random"),vg.svg=require("./util/svg"),vg.Color=require("./objects/color"),vg.Group=require("./objects/group"),vg.Matrix4=require("./objects/matrix4"),vg.Path=require("./objects/path"),vg.Point=vg.Vec2=require("./objects/point"),vg.Rect=require("./objects/rect"),vg.Text=require("./objects/text"),vg.Transform=vg.Matrix3=require("./objects/transform"),vg.Vec3=require("./objects/vec3");var Transformable=require("./objects/transformable");_.extend(vg.Point.prototype,Transformable),_.extend(vg.Path.prototype,Transformable),_.extend(vg.Group.prototype,Transformable),_.extend(vg.Text.prototype,Transformable),importCommands(require("./commands/draw")),importCommands(require("./commands/filters")),importCommands(require("./commands/shapes")),module.exports=vg;


},{"./commands/draw":25,"./commands/filters":26,"./commands/shapes":27,"./objects/color":28,"./objects/group":29,"./objects/matrix4":30,"./objects/path":31,"./objects/point":32,"./objects/rect":33,"./objects/text":34,"./objects/transform":35,"./objects/transformable":36,"./objects/vec3":37,"./util/bezier":38,"./util/color":39,"./util/geo":40,"./util/math":42,"./util/random":43,"./util/svg":44,"lodash":4}]},{},[9])(9)
});